\documentclass{amsart}
\usepackage{amsmath,amsfonts,amssymb,latexsym}
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage[pagebackref, bookmarks=true, bookmarksopen=true, bookmarksdepth=3,bookmarksopenlevel=2, colorlinks=true, linkcolor=blue, citecolor=blue, filecolor=blue, menucolor=blue, urlcolor=blue]{hyperref}
\input xy
\xyoption{all}
\usepackage{tikz}
\usepackage{mathalfa}

\usetikzlibrary{calc}

\usepackage[inline]{showlabels}

\newtheorem{theorem}{Theorem}[section]
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{question}[theorem]{Question}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{example}[theorem]{Example}

\numberwithin{equation}{section}

\newcommand{\bfa}{{\boldsymbol{a}}}
\newcommand{\bfb}{\mathbf{b}}
\newcommand{\bfc}{\mathbf{c}}
\newcommand{\bfe}{\mathbf{e}}
\newcommand{\bfg}{\mathbf{g}}
\newcommand{\bfp}{{\boldsymbol{p}}}
\newcommand{\bfq}{{\boldsymbol{q}}}
\newcommand{\bfr}{{\boldsymbol{r}}}
\newcommand{\bfs}{{\boldsymbol{s}}}
\newcommand{\bft}{{\boldsymbol{t}}}
\newcommand{\bfu}{{\boldsymbol{u}}}
\newcommand{\bfv}{{\boldsymbol{v}}}
\newcommand{\bfx}{{\boldsymbol{x}}}
\newcommand{\bfy}{{\boldsymbol{y}}}
\newcommand{\bfxi}{\boldsymbol{\xi}}
\newcommand{\bfzero}{\mathbf{0}}

\newcommand{\sfx}{{\mathsf{x}}}
\newcommand{\sfbfx}{{\mathsf{\boldsymbol{x}}}}
\newcommand{\sfy}{{\mathsf{y}}}
\newcommand{\sfp}{{\mathsf{p}}}
\newcommand{\sfbfp}{{\mathsf{\boldsymbol{p}}}}

\newcommand{\cA}{\mathcal{A}}
\newcommand{\cB}{\mathcal{B}}
\newcommand{\cD}{\mathcal{D}}
\newcommand{\cF}{\mathcal{F}}
\newcommand{\cG}{\mathcal{G}}
\newcommand{\cH}{\mathcal{H}}
\newcommand{\cL}{\mathcal{L}}
\newcommand{\cO}{\mathcal{O}}
\newcommand{\cP}{\mathcal{P}}
\newcommand{\cT}{\mathcal{T}}
\newcommand{\cU}{\mathcal{U}}
\newcommand{\cX}{\mathcal{X}}

\newcommand{\CC}{\mathbb{C}}
\newcommand{\FF}{\mathbb{F}}
\newcommand{\kk}{\Bbbk}
\newcommand{\PP}{\mathbb{P}}
\newcommand{\QQ}{\mathbb{Q}}
\newcommand{\RR}{\mathbb{R}}
\newcommand{\TT}{\mathbb{T}}
\newcommand{\ZZ}{\mathbb{Z}}

\newcommand{\diag}{\operatorname{diag}}
\newcommand{\Hom}{\operatorname{Hom}}
\newcommand{\Li}{\operatorname{Li}}
\newcommand{\Lie}{\operatorname{Lie}}
\renewcommand{\max}{\operatorname{max}}
\newcommand{\Spec}{\operatorname{Spec}}

\newcommand{\rra}{\rightrightarrows}

\newcommand{\erase[1]}{{}}

\title{Symplectic Groupoids for Cluster Manifolds}
\author{Songhao Li}
\address[Songhao Li]{University of Notre Dame, Department of Mathematics, Notre Dame, IN 46556, USA}
\email{sli19@nd.edu}

\author{Dylan Rupel}
\address[Dylan Rupel]{University of Notre Dame, Department of Mathematics, Notre Dame, IN 46556, USA}
\email{drupel@nd.edu}

\begin{document}
\begin{abstract}
  We construct symplectic groupoids integrating log-canonical Poisson structures on cluster varieties of type $\cA$ and $\cX$.
  The charts of the source-simply-connected groupoids are constructed via Poisson spray technique of Crainic and M\u{a}rcu\c{t}.
  These charts and their analogues for the symplectic double and blow-up groupoids are then glued by groupoid comorphisms according to the Hamiltonian perspective of cluster mutations following Fock and Goncharov.
\end{abstract}
\maketitle
Outline
\begin{enumerate}
	\item Intro to cluster algebra and compatible Poisson structures 
	\item Intro to Poisson manifolds, symplectic groupoid and Poisson spray
	\item Cluster symplectic groupoid
	\item Totally positive cluster manifolds (definition of manifolds with corners [check D Joyce], associahedron of type A and generalized associahedron)
	\item Examples
\end{enumerate}

%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}
This is the first of a series of papers whose aim is to implement the Weinstein program of geometric quantization for Poisson manifolds \cite{MR1104934} in the case of Poisson structures compatible with a cluster structure.
In this first paper, we construct the symplectic groupoids for both the cluster $\cA$-varieties and the cluster $\cX$-varieties. 

The cluster $\cA$-varieties are the geometric realization of cluster algebras defined by Fomin and Zelevinsky \cite{FZ02} as the culmination of their study of total positivity and canonical bases for algebraic groups \cite{BFZ98}.
Many varieties arising in Lie theory, e.g.\ Grassmannians and double Bruhat cells, are examples of $\cA$-varieties \cite{BFZ05,scott,gekhtman-shapiro-vainshtein,Wil13b}.
The cluster $\cA$-varieties are often endowed with a class of compatible Poisson structures in the sense of Gekhtman, Shapiro, and Vainshtein \cite{GSV10}.
In particular, our results immediately give rise to a trio of symplectic/Poisson groupoids integrating a compatible Poisson structure on any cluster $\cA$-variety, including those mentioned above. 

The cluster $\cX$-varieties were introduced by Fock and Goncharov \cite{FG09a} in their study of higher Teichm\"uller space.
An alternative view of double Bruhat cells and Grassmannians reveal cluster $\cX$-variety structures as well.
%Additional examples of cluster $\cX$-varieties include moduli spaces of local systems on Riemann surfaces and 
A cluster $\cX$-variety is always endowed with a canonical Poisson structure.
In particular, as with the cluster $\cA$-varieties, our results produce symplectic/Poisson groupoids integrating any cluster $\cX$-variety.
If an $\cA$-variety carries a compatible Poisson structure, then the natural map from this $\cA$-variety to the corresponding $\cX$-variety is Poisson.
We provide a lift of this map to maps of groupoids over the $\cA$- and $\cX$-varieties.

In the case of cluster algebras, the quantum $\cA$-varieties \cite{berenstein-zelevinsky} and the quantum $\cX$-varieties \cite{FG09c} are both concrete examples of quantization of Poisson manifolds.
In fact, the $q$-quantization of log-canonical variables can be realized simply as the exponential version of the standard Weyl quantization for canonical variables.
Geometric quantization for symplectic manifolds takes one step further by constructing a Hilbert space on which the quantized algebra acts, but this requires that the cohomology class of the symplectic 2-form be integral (see e.g.\ \cite{MR1806388}).
The notion of symplectic groupoids was introduced by Weinstein \cite{MR866024}, Karas\"{e}v \cite{MR1008479} and Zakrzewski \cite{MR1081010, MR1081011}.
Weinstein's motivation was to find a geometric quantization schema for Poisson manifolds \cite{MR1104934}, which has only been successfully implemented for a handful of examples \cite{MR2238946, MR2417440, MR2925830}.
The concrete nature of cluster coordinates provides an ideal testing ground for groupoid quantization.
Indeed, this was implicitly implemented by Fock and Goncharov \cite{FG09c} in the case of $\cX$-varieties.

In this paper, we take the first step towards the groupoid quantization for both cluster $\cA$-varieties and cluster $\cX$-varieties by describing their symplectic groupoids.
The construction of each is detailed below as we discuss the organization of the paper.

In Section~\ref{sec:local}, we construct three groupoids $\cG$, $\cB$ and $\cD$ for a log-canonical Poisson structure $\pi$ on a vector space $L$, these each possess important properties which justify their consideration.
The groupoid $\cG \rra L$ is the source-simply-connected symplectic groupoid.
The construction of $\cG \rra L$ utilizes the construction of local symplectic groupoids by Poisson sprays \cite{MR2900786, CMS17}.
For a log-canonical Poisson structure, there is a natural choice of a Poisson spray which yields $\cG$ under the spray construction.
An important note, is that although this provides the source-simply-connected groupoid, the source and the target maps of $\cG \rra L$ will be transcendental and in particular they do not conform (strictly speaking) to the algebraic nature of cluster theory.

One fix for this is an analogue of the symplectic double introduced by Fock and Goncharov \cite{FG09c}, albeit with slightly different notation to accommodate the case of non-square exchange matrices.
This groupoid which we denote $\cD \rra L$ is a source-connected Poisson groupoid.
Over an octant $L^+$ of $L$ the groupoid $\cD \rra L$ is actually symplectic and we denote its restiction by $\cD^+ \rra L^+$, this is the groupoid considered by Fock and Goncharov in the case of $\cX$-varieties.

The linear degeneracy of the Poisson structure on $\cD$ over the coordinate hyperplanes is corrected via the blow-up construction introduced in works of the first author \cite{MR3312911,MR3214314}.
This gives rise to the groupoid $\cB \rra L$ which is source-connected and symplectic.
Comparing to $\cG \rra L$, the main advantage of $\cB \rra L$ is that the source and the target maps of $\cG \rra L$ are rational.
In this way, it seems likely that the groupoid $\cB$ will be most useful in the theory of cluster algebras.
Observe that both $\cB \rra L$ and $\cD \rra L$ receive maps from the source-simply-connected symplectic groupoid $\cG$.

In Section~\ref{sec:mutations}, we give the explicit formulae for the cluster groupoid mutations $\mu: \cG \to \cG'$, $\mu: \cB \to \cB'$ and $\mu: \cD \to \cD'$.
We begin in Section~\ref{sec:cluster} in the setting of generalized cluster mutations $\mu: L \to L'$ which we decompose into two maps $\varphi^1$ and $\tau$ according to the Hamiltonian perspective of mutations \cite{FG09a, MR3691969}.
The first map $\varphi^1$ is the time-$1$-flow of a Hamiltonian vector field defined using the Euler dilogarithm function; the second map $\tau$ is a transformation of the log-canonical coordinates.
We then lift $\varphi^1$ and $\tau$ to groupoid maps which compose to give the cluster groupoid mutations.
In principle, a Poisson map induces a Lie algebroid comorphism \cite{Higgins1990}, which is then lifted to the groupoid comorphisms \cite{MR2063018, MR3089758}.
Indeed, the Poisson ensemble map $\rho: L_\cA \to L_\cX$ can be lifted only to a groupoid comorphism when the exchange matrix is not square.
However, if a Poisson morphism is a diffeomorphism, then the dual bundle map of the induced Lie algebroid comorphism is a Lie algebroid morphism, which then lifts to an honest groupoid morphism.
Since both the Hamiltonian map $\varphi^1$ and the transformation $\tau$ are diffeomorphisms on an open dense set, we may lift the cluster mutation $\mu = \tau \circ \varphi^1$ to cluster groupoid mutations.
\bigskip

Throughout the paper, we use the following notations.
\begin{itemize}
	\item We write $\RR_+ = (0, \infty)$, $\bar\RR_+ = [0, \infty)$ and $\CC_\times = \CC \setminus \{0\}$.
	\item For the cluster charts, we use the following notations:
	$$
		L = \RR^m \text{ or } \CC^m, \quad L^+ = \RR_+^m \text{ or } \CC_\times^m, \quad \bar L^+ = \bar\RR_+^m.
	$$
	\item We denote vectors by boldface, e.g. $\bfx = (x_1, \ldots, x_m)$.
	\item Hadamard product: for two vector $\bfx$ and $\bfy$, $\bfx \circ \bfy = (x_1y_1, \ldots, x_my_m)$.
	\item For a vector $\bfx$ and a real number $t$, $\bfx^t = (x_1^t, \ldots, x_m^t)$.
%	\item For a vector $\bfx$, we denote the diagonal matrix for which the diagonal entries is $\bfx$ by $I_\bfx$, i.e. 
%	\[
%		I_\bfx = \begin{bmatrix} x_1 & 0 & \cdots & 0 \\ 0 & x_2 & \cdots & 0 \\ \vdots & \vdots & \ddots & \vdots \\ 0 & 0 & \cdots & x_m \end{bmatrix}
%	\]
	\item For a smooth (resp. complex) manifold $M$, we denote the space of smooth (resp. holomorphic) functions by $\cO_M$.
	\item For a vector bundle $E$ over $M$, we denote the space of sections by $\Gamma(M, E)$.
          In particular, we denote the space of vector fields by $\cT_M = \Gamma(M, TM)$, but to follow the conventional notation, we denote the space of differential $1$-forms by $\Omega^1(M) = \Gamma(M, T^*M)$.
	%\item for two vector $\bfx$ and $\bfa$, $\bfx^\bfa = \prod_{i=1}^m x_i^{a_i}$;
	%\item for a matrix $B = (B_{ij})$, $B_{[k]}$ denotes the kth column vector of $B$.
\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Symplectic groupoids of log-canonical Poisson structures}
\label{sec:local}

%In this section, we will use the idea of Poisson spray \cite{MR2900786} to construct the source-simply-connected sympletic groupoid of a log-canonical Poisson structure.
%There is another construction of a source-connected symplectic groupoid, called the symplectic double \cite{FG09c}.
%We give an explicit formula for the groupoid morphism from the source-simply-connected symplectic groupoid to the symplectic double.
%We recall the natural Poisson map between two compatible log-canonical Poisson structures, which serve as the seeds for cluster $\cA$-varieties and $\cX$-varieties.

We begin with the equivalent notions of Poisson brackets and Poisson bi-vectors.
\begin{definition} 
  \label{def: PoissonMfld}
  Let $M$ be either a smooth manifold or a complex manifold.
  A \emph{Poisson structure} on $M$ is one of the two following equivalent structures:
  \begin{enumerate}
    \item a \emph{Poisson bracket}
      $$\{\cdot, \cdot\}: \cO_M \times \cO_M \to \cO_M$$
      which is a Lie bracket satisfying the Leibniz rule
      $$\{fg, h\} = f\{g,h\} + g\{f,h\};$$
    \item a \emph{Poisson bi-vector} $\pi \in \cT^2_M$ such that $[\pi, \pi] = 0$, where $[\cdot, \cdot]$ is the Schouten-Nijenhuis bracket.
  \end{enumerate}
  We say $f \in \cO_M$ is a Casimir if $\{f, g\} = 0$ for every $g\in \cO_M$.
\end{definition}

The two notions are related by the formula: $\{f, g\} = \pi (df \otimes dg)$ for $f, g\in \cO_M$.
The pair $(M, \pi)$, or equivalently $(M, \{\cdot,\cdot\})$, is called a \emph{Poisson manifold}.
The \emph{Hamiltonian vector field} of $f \in \cO_M$ is defined to be $X_f = \iota_{df}\pi$.
A Poisson map from $(M_1, \pi_1)$ to $(M_2, \pi_2)$ is a map $\varphi: M_1\to M_2$ such that $\varphi_*\pi_1 = \pi_2$ or equivalently $\{\varphi^*f, \varphi^*g\} = \varphi^*(\{f, g\})$ for $f, g \in \cO_{M_2}$.
For $f \in \cO_{M_2}$, the pullback of a Hamiltonian vector field $X_f$ is $X_{\varphi^*f}$.
A Poisson map $\varphi: (M_1, \pi_1) \to (M_2, \pi_2)$ is \emph{complete} if the pullback of a complete Hamiltonian vector field is again a complete vector field.

A bi-vector $\pi \in \cT^2_M$ is called \emph{non-degenerate} if the bundle map
\[\pi^\flat: \Omega^1(M) \to \cT_M, \qquad \alpha \mapsto \iota_\alpha \pi\]
is invertible.
The inverse of the bundle map defines a non-degenerate 2-form $\omega \in \Omega^2(M)$.
That is, the bundle map
\[\omega^\sharp: \cT_M \to \Omega^1(M), \qquad v \mapsto \iota_v \omega\]
is the inverse of $\pi^\flat$.
The condition $[\pi,\pi]$ is equivalent to $d\omega = 0$, so a non-degenerate Poisson bi-vector is the same as a symplectic 2-form.
Hence for a symplectic 2-form $\omega$, we denote the corresponding Poisson bi-vector as $\omega^{-1}$.

\begin{definition}
  For a Poisson manifold $(M, \pi)$, a symplectic realization is a symplectic manifold $(S, \omega)$ together with a surjective Poisson map $\rho: (S, \omega) \to (M, \pi)$.
\end{definition}

Of particular importance among all the symplectic realizations is the symplectic groupoid, but first we recall the notion of Lie groupoids and Lie algebroids.
\begin{definition} \label{def:groupoid}
  A \emph{groupoid} $\cG\rightrightarrows M$ consists of two sets $\cG$ and $M$ with the following maps:
  \begin{enumerate}
    \item a surjective \emph{source map} $\alpha: \cG \to M$ and a surjective \emph{target map} $\beta: \cG \to M$;
    \item an injective identity map $\mathtt{1}: M \to \cG, \enskip x \mapsto \mathtt{1}_x$;
    \item an associative multiplication map $m: \cG {_\beta \times_\alpha} \cG \to \cG, \enskip (g, h) \mapsto gh$;
    \item and an involutive inversion map $\iota: \cG \to \cG, \enskip g \mapsto g^{-1}$;
  \end{enumerate}
  which satisfy the following properties:
  \begin{enumerate}
    \item $\alpha(\mathtt{1}_x) = \beta(\mathtt{1}_x) = x$;
    \item $\alpha(gh) = \alpha(g), \enskip \beta(gh) = \beta(h)$;
    \item $\alpha(g^{-1}) = \beta(g), \enskip \beta(g^{-1}) = \alpha(g)$;
    \item $(\mathtt{1}_x)^{-1} = \mathtt{1}_x$.
  \end{enumerate}
  A \emph{Lie groupoid} $\cG \rightrightarrows M$ has the following additional properties:
  \begin{enumerate}
    \item $\cG$ and $M$ are smooth (or complex) manifolds;
    \item the source $\alpha: \cG \to M$ and the target $\beta: \cG \to M$ are surjective submersions;
    \item the multiplication map $m: \cG {_\beta \times_\alpha} \cG \to \cG$ is smooth (or holomorphic);
    \item the inversion map $i: \cG \to \cG$ is smooth (or holomorphic).
  \end{enumerate}
  A Lie groupoid $\cG \rightrightarrows M$ is \emph{source-connected} if the source fiber $\alpha^{-1}(x)$ is connected for every $x \in M$; it is \emph{source-simply-connected} if the source fiber $\alpha^{-1}(x)$ is connected and simply-connected for every $x \in M$.
\end{definition}

With our convention, $\cG$ naturally acts on itself on the left.
Next we recall the notion of a Lie algebroid, which is the infinitesimal object of a Lie groupoid.
\begin{definition} \label{def:algeroid}
  For a smooth (or holomorphic) manifold $M$, a Lie algebroid over $M$ is a triple $(A, [\cdot, \cdot], \rho)$ where
  \begin{enumerate}
    \item $A$ is a vector bundle over a $M$;
    \item $[\cdot, \cdot]$ is a Lie bracket on the space of sections $\Gamma(M, A)$;
    \item $\rho: A \to TM$ is a bundle morphism preserving the Lie bracket;
  \end{enumerate}
  with Lie bracket satisfying the Leibniz rule: for $X, Y \in \Gamma(M, A)$ and $f \in \cO_M$,
  \[[X, fY] = f\cdot[X, Y] + \rho X(f) \cdot Y.\]
\end{definition}

There is a Lie functor from the Lie groupoids to the Lie algebroids.
For a Lie groupoid $\cG \rra M$, we define its Lie algebroid $A = \Lie \cG$ as follows.
As a vector bundle, we have
\begin{equation} \label{eq:Liefunctor}
	A = \ker \left(\alpha_*: T\cG|_{\mathtt{1}_M} \to TM \right).
\end{equation}
The Lie bracket is the bracket of left-invariant vector fields and the anchor map is the restriction of $\beta_*: T\cG \to TM$ to $A$.
In this case, we say the Lie groupoid $\cG$ \emph{integrates} the Lie algebroid $A$.

Given a Lie groupoid $\cG \rra M$, its \emph{$k$-nerve}
\[
	\cG^{(k)} := \{(g_1, g_2, \ldots, g_k) \in \cG^k ~|~ \beta(g_i) = \alpha(g_{i+1})\}
\]
is the set of $k$-composable elements.
In particular, we have
\[\cG^{(2)} = \cG {_\beta \times_\alpha} \cG,\qquad \cG^{(1)} = \cG,\qquad \cG^{(0)} = M.\]
The \emph{nerve} of a Lie groupoid is naturally a simplicial manifold that carries a coboundary operator $\partial: \Omega^\bullet(\cG^{(k-1)}) \to \Omega^\bullet(\cG^{(k)})$.
The first two operators are given as below:
\begin{align} 
  \label{eq:gpdcob}
  & \partial: \Omega^\bullet(M) \to \Omega^\bullet(\cG), \qquad \mu \mapsto \alpha^*(\mu) - \beta^*(\mu); \\
  & \partial: \Omega^\bullet(\cG) \to \Omega^\bullet(\cG^{(2)}), \qquad \mu \mapsto \mathrm{pr}_1^*(\mu) - m^*(\mu) + \mathrm{pr}_2^*(\mu);
\end{align}
where $\mathrm{pr}_1: \cG^{(2)} \to \cG$ and $\mathrm{pr}_2: \cG^{(2)} \to \cG$ are the first and second projections.
A differential form $\mu \in \Omega^\bullet(\cG)$ is called \emph{multiplicative} if $\partial \mu = 0$.
Our main interest will be with Lie groupoids equipped with a multiplicative symplectic structure.
\begin{definition}
  A \emph{symplectic groupoid} is a Lie groupoid $\cG \rra M$ with a multiplicative symplectic structure $\omega \in \Omega^2(\cG)$.
  That is, $\mathrm{pr}_1^*(\omega)+\mathrm{pr}_2^*(\omega) = m^*(\omega)$ or equivalently the graph of the multiplication map $\Gamma_m := \{(g, h, gh) \in \cG \times \cG \times \cG\}$ is Lagrangian with repsect to the symplectic structure $\omega \oplus \omega \oplus -\omega$.
\end{definition}

The source fibers of a symplectic groupoid are symplectic orthogonal to the target fibers.
Some important examples of symplectic groupoids include: the Kostant-Kirillov-Souriau Poisson structures \cite{MR996653}, the Drinfeld doubles of Poisson Lie groups \cite{MR1054741}, the double Bruhat cells \cite{LuM16}, the blow-up groupoids of log symplectic manifolds \cite{MR3214314}, and the symplectic doubles of the cluster $\cX$-varieties \cite{FG09c}.
We note that symplectic groupoids are a special case of Poisson groupoids.
\begin{definition}
  A \emph{Poisson groupoid} is a Lie groupoid $\cG \rra M$ with a multiplicative Poisson structure $\sigma \in \cT^2_\cG$.
  That is, the graph of the multiplication map $\Gamma_m$ is coisotropic with respect to the Poisson structure $\sigma \oplus \sigma \oplus -\sigma$.
\end{definition}

A Poisson groupoid map from $(\cG_1, \sigma_1) \rra M_1$ to $(\cG_2, \sigma_2) \rra M_2$ is a Lie groupoid map $\varphi: \cG_1 \to \cG_2$ which is Poisson.
For a Poisson groupoid $(\cG, \sigma) \rra M$, there is a natural Poisson structure $\pi$ on $M$ such that $\alpha: (\cG, \sigma) \to (M, \pi)$ and $\beta: (\cG, \sigma) \to (M, -\pi)$ are Poisson maps.
For a Poisson manifold $(M, \pi)$, one could ask if there is a symplectic groupoid $(\cG, \omega) \rra (M, \pi)$ such that $\alpha: (\cG, \omega) \to (M, \pi)$ is a Poisson map.
If the answer is yes, we say that the Poisson manifold $(M, \pi)$ is \emph{integrable}.
The Lie algeboid of a symplectic groupoid $\cG \rra M$ is the cotangent bundle $T^*M$ \cite{MR866024} with the anchor map
\[\pi^\flat: T^*M \to TM, \qquad \alpha \mapsto \iota_\alpha \pi,\]
and the Koszul bracket: for $\alpha, \beta \in \Omega^1(M)$,
\[[\alpha, \beta] = \cL_{\pi(\alpha)} \beta - \cL_{\pi(\beta)} \alpha - d\pi(\alpha \otimes \beta).\]
For $(M, \pi)$, we denote its cotangent Lie algebroid by $T^*_\pi M$.

Just like the infinitesimal object of a Poisson Lie group is a Lie bialgebroid, the infinitesimal object of a Poisson groupoid is a Lie bialgebroid \cite{MR1262213}.
As a Poisson groupoid, the symplectic groupoid $(\cG, \omega) \rra (M, \pi)$ integrates the Lie bialgebroid $(T^*_\pi M, TM)$.
The integrability of Poisson manifolds, and more generally the integrability of Lie algebroids, is characterized in \cite{MR1973056, MR2128714}.

%For the two extreme cases where the Poisson structure is either trivial or non-degenerate, we describe the symplectic groupoid below.
%\begin{example}
%	\begin{enumerate}
%	\item Let $M$ be a smooth (or holomorphic) manifold with the trivial Poisson structure, i.e. every function $f\in \cO_M$ is a Casimir. The symplectic groupoid over $M$ is $T^*M$ with the standard symplectic structure, where $\alpha$ and $\beta$ are the bundle projections and the multiplication is the fiberwise addition.
%	\item Let $(M, \omega)$ be a connected symplectic manifold. The pair groupoid $(M \times M, \omega \oplus -\omega)$ is a source-connected symplectic groupoid over $(M, \omega)$ where $\alpha(x,y) = x$, $\beta(x,y) = y$ and $m((x,y), (y,z))=(x,z)$. The fundamental groupoid $\Pi M$ consisting of homotopy paths is the source-simply-connected symplectic groupoid where $\alpha([\gamma]) = \gamma(0)$, $\beta([\gamma]) = \gamma(1)$, the multiplication is the concatenation of paths and with the symplectic structure $\alpha^*\omega - \beta^*\omega$.
%	\end{enumerate}
%\end{example}

%\begin{remark}
  %\label{rem:lifting}
%\end{remark}

We focus on the symplectic groupoids of log-canonical Poisson structures.
\begin{definition} 
  \label{def: logPoisson}
  Let $L$ be either $\RR^m$ or $\CC^m$ and write $\bfx = (x_1, \ldots, x_m)$ for a system of coordinates on $L$.
  A Poisson structure on $L$ is \emph{log-canonical} if
  $$
    \{x_i, x_j\} = \Omega_{ij} x_ix_j, \quad 1 \leq i,j \leq m \qquad \text{or equivalently} \qquad
    \pi = \sum_{j < i} \Omega_{ij} x_ix_j\frac{\partial}{\partial x_i} \wedge \frac{\partial}{\partial x_j},
  $$
  for some skew-symmetric $m\times m$ matrix $\Omega = (\Omega_{ij})$.
\end{definition}

For both the cluster $\cA$-varieties \cite{GSV10} and $\cX$-varieties \cite{FG09c}, the compatible Poisson structures are log-canonical in cluster charts.
Using the results in \cite{MR2900786, CMS17}, we construct the source-simply-connected symplectic groupoid of a log-canonical Poisson structure by chosing an appropriate Poisson spray. 
\begin{definition} 
  \cite{MR2900786}
  For a Poisson manifold $(M, \pi)$, a \emph{Poisson spray} is a vector field $X \in \cT_{T^*M}$ such that
  \begin{enumerate}
    \item for $(p,x) \in T^*M$ we have
      \[\tau_* X|_{(p,x)} = \pi^\flat(p),\]
      where $\tau: T^*M \to M$ is the bundle projection;
    \item $X$ is homogeneous of degree 1, i.e.
      \[(m_\lambda)_*(X) = \lambda X,\]
      where $m_\lambda: T^*M \to T^*M, \enskip (p,x) \mapsto (\lambda p,x)$ is the fiberwise scaling map.
  \end{enumerate}
\end{definition}

\begin{theorem} 
  \cite{MR2900786, CMS17} 
  \label{thm:poissp}
  For a smooth Poisson manifold $(M, \pi)$ with a Poisson spray $X \in \cT_{T^*M}$, there exists a neighborhood $U$ of the zero section of $T^*M$ which is a local symplectic groupoid over $(M, \pi)$ with the following structures:
  \begin{enumerate}
    \item the source map $\alpha: U \to M$ is the bundle projection;
    \item the target map is
      \[\beta: U \to M, \qquad \beta = \tau \circ \varphi_X^1,\]
      where $\varphi_X^1: T^*M \to T^*M$ is the time-$1$-flow of $X$;
    \item the identity map $\mathtt{1}: M \to U$ is the zero section;
    \item the inverse map is
      \[\iota: U \to U, \qquad \iota = -\varphi_X^1;\]
    \item the multiplication $m: U {_\beta \times_\alpha} U \to U$ is defined as the solution of an ODE (see \cite{CMS17} for details);
    \item the symplectic form on $U$ is
      \[\omega = \int_{0}^{1} (\varphi_X^s)^*\omega_0 ds,\]
      where $\omega_0$ is the standard symplectic structure on $T^*M$.
  \end{enumerate}
\end{theorem}

\begin{remark}
  For the standard symplectic structure $\omega_0$ in Theorem~\ref{thm:poissp}, we use the sign convention that $\omega_0 = - d \theta_0$ for $\theta_0$ the tautological 1-form on $T^*M$.
  This choice ensures that the source map $\alpha$ is Poisson.
  In coordinates, we have $\omega_0 = \sum_i d x_i \wedge d p_i$.
\end{remark}

\begin{remark}
  By a local symplectic groupoid $(\cG, \omega) \rra (M, \pi)$, we mean that the multiplication $m: \cG {_\beta \times_\alpha} \cG \to \cG$ may not be defined on all of its domain.
  In general, the local symplectic groupoid structure cannot be extended to the total space $T^*M$.
  Indeed: the Poisson spray $X$ may not be complete; the flow of the Poisson spray $X$ may contain loops; or the 2-form $\omega$, though non-degenerate near the zero section of $T^*M$, may be degenerate in general.
\end{remark}

In the next results, we introduce a Poisson spray whose local symplectic groupoid provides an integration of a log-canonical Poisson structure.
\begin{lemma} \label{lemma:PoisSp}
  For the log-canonical Poisson structure $\{x_i, x_j\} = \Omega_{ij} x_i x_j$ on $L = \RR^m$, the vector field $X \in \cT_{T^*L}$ given in coordinates $(\bfp, \bfx) = (p_1, \ldots, p_m, x_1, \ldots, x_m)$ on $T^*L$ by
  \begin{equation} 
    \label{eq: PoisSp}
    X = \sum_{1 \leq i,j \leq m}\Omega_{ij}x_i p_i x_j\frac{\partial}{\partial x_j} - \sum_{1 \leq i,j \leq m}\Omega_{ij}x_ip_i p_j\frac{\partial}{\partial p_j}
  \end{equation}
  is a Poisson spray.
  Its flow is given by
  \[\varphi_X^t: T^*L \to T^*L, \qquad (\bfp, \bfx) \mapsto (\bfa^{-t} \circ \bfp, \bfa^t \circ \bfx),\]
  where $a_j = e^{\sum_i \Omega_{ij} x_ip_i}$.
  This flow exists for all time $t \in \RR$ and contains no loops.
\end{lemma}

\begin{proof}
  For the co-vector $\alpha = p_1 dx_1 + \ldots + p_m dx_m$ and the point $(\bfp, \bfx)$, we have
  \[\tau_* X|_{(\bfp,\bfx)} = \sum_{i, j}\Omega_{ij} x_i p_i x_j \frac{\partial}{\partial x_j} = \iota_\alpha \pi.\]
  To find the flow of $X$, we note that $x_i p_i$ is a constant under the flow of $X$:
  \[\frac{d}{dt}(x_j p_j) = \dot{x}_j p_j + x_j \dot{p}_j = \sum_{1 \leq i \leq m}\Omega_{ij}x_i p_i x_j p_j - \sum_{1 \leq i \leq m}\Omega_{ij}x_ip_i p_j x_j = 0.\]
  Therefore $\sum_{i}\Omega_{ij}x_i p_i$ is constant, and
  \begin{align*}
    x_j(t) & = e^{t \sum_i \Omega_{ij} x_ip_i} x_j(0) = a_j^t x_j(0), \\
    p_j(t) & = e^{-t \sum_i \Omega_{ij} x_ip_i} p_j(0) = a_j^{-t} p_j(0).
  \end{align*}
\end{proof}

This Poisson spray $X$ induces the symplectic groupoid structure below.
\begin{theorem} 
  \label{thm:PoiSpLogC}
  For the log-canonical Poisson structure $\{x_i, x_j\} = \Omega_{ij} x_i x_j$ on $L$ (which is either $\RR^m$ or $\CC^m$), there is a source-simply-connected symplectic groupoid $(\cG, \omega_\cG) \rra (L, \pi)$ with the following structures:
  \begin{enumerate}
    \item $\cG \cong T^*L$ has the coordinates $(\bfp, \bfx) = (p_1, \ldots, p_m, x_1, \ldots, x_m)$;
    \item the source map is the bundle projection $\alpha: T^*L \to L, \quad (\bfp, \bfx) \mapsto \bfx$;
    \item the target map is $\beta: T^*L \to L, \quad (\bfp, \bfx) \mapsto \bfa \circ \bfx$, where $a_j = e^{\sum_i \Omega_{ij} x_ip_i}$;
    \item the identity map is $\mathtt{1}: L \to T^*L, \quad \bfx \mapsto (0, \bfx)$;
    \item the inverse map is $\iota: T^*L \to T^*L, \quad (\bfp, \bfx) \mapsto (-\bfa^{-1} \circ \bfp,\bfa \circ \bfx)$;
    \item the multiplication map is $m: T^*L {_\beta \times_\alpha} T^*L \to T^*L, \quad \big((\bfp, \bfx), (\bfp', \bfa \circ \bfx)\big) \mapsto (\bfa \circ \bfp' + \bfp, \bfx )$;
    \item the multiplicative symplectic form $\omega$ is
      \begin{equation}
	\omega_\cG = \sum_{i} dx_i \wedge dp_i + \sum_{i, j} \Omega_{ij}p_ix_j dx_i \wedge dp_j + \sum_{j < i} \Omega_{ij}p_ip_j dx_i \wedge dx_j + \sum_{j < i} \Omega_{ij}x_ix_j dp_i \wedge dp_j, 
      \end{equation}
      or equivalently the multiplicative Poisson bivector
      \begin{equation}
        \label{eq:2-formGA}
      	\sigma_\cG = \omega_\cG^{-1} = \sum_{i} \frac{\partial}{\partial p_i} \wedge \frac{\partial}{\partial x_i} - \sum_{i, j} \Omega_{ij}p_i x_j \frac{\partial}{\partial p_i} \wedge \frac{\partial}{\partial x_j} +\sum_{j < i} \Omega_{ij}p_ip_j \frac{\partial}{\partial p_i} \wedge \frac{\partial}{\partial p_j} +\sum_{j < i} \Omega_{ij}x_ix_j \frac{\partial}{\partial x_i} \wedge \frac{\partial}{\partial x_j}.
      \end{equation}
  \end{enumerate}
\end{theorem}
\begin{proof}
  When the underlying field is $\RR$, it is straightforward to check that the Poisson spray \eqref{eq: PoisSp} induces the given groupoid structures. To find the sympletic structure $\omega_\cG$, we have
  \begin{align*}
    \left(\varphi_X^s\right)^*\omega_0 & = \sum_{j} d \left(e^{ s \sum_{i} \Omega_{ij} x_ip_i}x_j \right) \wedge d \left(e^{- s \sum_{i} \Omega_{ij} x_ip_i}p_j \right) \\
    & = \sum_{j} \left(s x_j \sum_{i} \Omega_{ij} x_i dp_i + s x_j \sum_{i} \Omega_{ij} p_i dx_i + d x_j \right) \wedge \left(- s p_j \sum_{i} \Omega_{ij} x_i dp_i - s p_j \sum_{i} \Omega_{ij} p_i dx_i + d p_j \right) \\
    & = \sum_{j} dx_j \wedge dp_j + 2s \left( \sum_{i, j} \Omega_{ij}p_i x_j d x_i \wedge d p_j  + \sum_{j < i} \Omega_{ij}p_ip_j d x_i \wedge d x_j + \sum_{j < i} \Omega_{ij}x_ix_j d p_i \wedge d p_j \right),
  \end{align*}
  so it follows that
  \begin{align*}
    \omega_\cG & = \int_{0}^{1} (\varphi_X^s)^*\omega_0 ds \\
    & = \sum_{i} dx_i \wedge dp_i
      + \left(
	\sum_{i, j} \Omega_{ij}p_ix_j dx_i \wedge dp_j 
	+ \sum_{j < i} \Omega_{ij}p_ip_j dx_i \wedge dx_j
	+ \sum_{j < i} \Omega_{ij}x_ix_j dp_i \wedge dp_j
      \right).
  \end{align*}
  Note that $\omega_\cG$ is non-degenerate since
  \[(\omega_\cG)^m = m! \bigwedge\limits_{1\leq i\leq m} dx_i \wedge dp_i\]
  is a volume form.

  Choosing the standard frames: $\{dx_i, dp_i\}_i$ for $T^*\cG$ and $\left\{\frac{\partial}{\partial x_i}, \frac{\partial}{\partial p_i}\right\}_i$ for $T\cG$, the bundle map $\pi_\cG^\flat: T^*\cG \to T\cG$, $\alpha \mapsto \pi_\cG(\alpha, \cdot)$ is given by
  \begin{align*}
    \pi_\cG^\flat: &~ dx_i \mapsto -\frac{\partial}{\partial p_i} - \sum_{j} \Omega_{ij} x_i p_j \frac{\partial}{\partial p_j}+ \sum_{j} \Omega_{ij} x_i x_j \frac{\partial}{\partial x_j}, \\
    &~ dp_i \mapsto \frac{\partial}{\partial x_i} - \sum_{j} \Omega_{ij} p_i x_j \frac{\partial}{\partial x_j}+ \sum_{j} \Omega_{ij} p_i p_j \frac{\partial}{\partial p_j},
  \end{align*}
  and for the symplectic structure $\omega_\cG$ as in \eqref{eq:2-formGA}, the bundle map $\omega_\cG^\sharp: T\cG \to T^*\cG$, $v \mapsto \omega_\cG(v, \cdot)$ is given by
  \begin{align*}
    \omega_\cG^\sharp: &~ \frac{\partial}{\partial x_i} \mapsto dp_i + \sum_{j} \Omega_{ij} p_i x_j dp_j + \sum_{j} \Omega_{ij} p_i p_j dx_j, \\
    &~ \frac{\partial}{\partial p_i} \mapsto -dx_i + \sum_{j} \Omega_{ij} x_i p_j dx_j + \sum_{j} \Omega_{ij} x_i x_j dp_j.
  \end{align*}
  We leave it to the reader to check that $\pi_\cG^\flat$ and $\omega_\cG^\sharp$ are inverse to each other.

  In the case when the underlying field is $\CC$, the symplectic groupoid structures can be verified directly.
\end{proof}

\begin{corollary} \label{cor:exp}
  For the log-canonical Poisson structure $\{x_i, x_j\} = \Omega_{ij} x_i x_j$ on $L$, the exponential map
  \[\exp: T^*_\pi L \to \cG, \qquad (\bfp, \bfx) \mapsto \left(\bfa^{-1} \circ \bfp, \bfa \circ \bfx \right),\]
  where $a_j = e^{\sum_i \Omega_{ij} x_ip_i}$, is a diffeomorphism.
\end{corollary}

Motiviated by \cite{FG09c}, we make the following definition of the symplectic double, which is a source-connected Poisson groupoid of the log-canonical Poisson structure on $L$.
\begin{theorem} \label{thm:SymDBLoc}
  \cite{FG09c}
  For the log-canonical Poisson structure $\{x_i, x_j\} = \Omega_{ij} x_i x_j$ on $L$ (which is either $\RR^m$ or $\CC^m$), the \emph{symplectic double} $(\cD, \sigma_\cD) \rra (L, \pi)$ is a source-connected Poisson groupoid with the following structures:
  \begin{enumerate}
    \item $\cD \cong L^+ \times L$ (where $L^+$ is either $\RR_+^m$ or $\CC_\times^m$) has the coordinates $(\bfs, \bfx) = (s_1, \ldots, s_m, x_1, \ldots, x_m)$;
    \item the source map is
      \[\alpha: L^+ \times L \to L, \qquad (\bfs, \bfx) \mapsto \bfx;\]
    \item the target map is
      \[\beta: L^+ \times L \to L, \qquad (\bfs, \bfx) \mapsto \left(x_1 \prod_{i=1}^m s_i^{\Omega_{i1}}, \ldots, x_m \prod_{i=1}^m s_i^{\Omega_{im}}\right);\]
    \item the identity map is $\mathtt{1}: L \to L^+ \times L, \quad \bfx \mapsto (1, \ldots, 1, \bfx)$;
    \item the inverse map is
      \[\iota: L^+ \times L \to L^+ \times L, \qquad (\bfs, \bfx) \mapsto \left(\frac{1}{s_1}, \ldots, \frac{1}{s_m}, x_1 \prod_{i=1}^m s_i^{\Omega_{i1}}, \ldots, x_m \prod_{i=1}^m s_i^{\Omega_{im}}\right);\]
    \item the multiplication map is
      \[\begin{aligned}
	  m: & \left(L^+ \times L\right) {_\beta \times_\alpha} \left(L^+ \times L\right) \to L^+ \times L, \\
	     & \left((\bfs, \bfx), \left(\bfs', x_1 \prod_{i=1}^m s_i^{\Omega_{i1}}, \ldots, x_m \prod_{i=1}^m s_i^{\Omega_{im}}\right)\right) \mapsto (\bfs' \circ \bfs, \bfx );
        \end{aligned}\]
    \item the multiplicative Poisson structure is
    \begin{equation}
    \label{eq:2-formGX}
		\sigma_\cD =\sum_{i} s_ix_i\frac{\partial}{\partial s_i} \wedge \frac{\partial}{\partial x_i}+\sum_{j < i} \Omega_{ij}x_ix_j \frac{\partial}{\partial x_i} \wedge \frac{\partial}{\partial x_j}
    \end{equation}
    or equivalently the singular multiplicative 2-form $\omega_\cD$ is
      \begin{equation} 
	\omega_\cD = \sigma_\cD^{-1} = \sum_{i} \frac{dx_i}{x_i} \wedge \frac{ds_i}{s_i} + \sum_{j < i} \Omega_{ij} \frac{ds_i}{s_i} \wedge \frac{ds_j}{s_j}.
      \end{equation}
  \end{enumerate}
\end{theorem}

It may be strange that the Poisson groupoid $\cD \rra L$ is called the symplectic double. The symplectic double in \cite{FG09c} is defined to be the restriction $\cD^+ =\{(\bfs, \bfx) ~|~ \bfx \in L^+ \} \cong L^+ \times L^+$ which is genuinely a symplectic groupoid over $L^+$. The Poisson groupoid $\cD \rra L$ may be viewed as the natural extension of the symplectic groupoid $\cD^+ \rra L^+$.
\begin{remark}
  We relate the target map in Theorem~\ref{thm:SymDBLoc} to the symplectic realization in \cite{MR3691969}.
	
  With the notation in Theorem~\ref{thm:SymDBLoc} and the change of variables $e^{\chi_i} = x_i$ and $e^{\xi_i} = s_i$, the symplectic double $(\cD^+, \omega_\cD)$ becomes the symplectic vector space $(\cU, \omega_\cU)$ with coordinates $(\xi_1, \ldots, \xi_m, \chi_1, \ldots, \chi_m)$, where $\cU$ is either $\RR^{2m}$ or $\CC^{2m}$, and
  \[\omega_\cU = \sum_{i} d\chi_i \wedge d\xi_i + \sum_{j < i} \Omega_{ij} d\xi_i \wedge d\xi_j.\]
  Although $(\cU, \omega_\cU)$ is not a symplectic groupoid integrating $(L, \pi)$ (e.g.\ the identity map cannot be defined), the maps $\alpha$ and $\beta$ are well-defined in these coordinates:
  \begin{align*}
    & \alpha: \cU \to L^+, \qquad (\xi_1, \ldots, \xi_m, \chi_1, \ldots, \chi_m) \mapsto \left(e^{\chi_1}, \ldots, e^{\chi_m}\right); \\
    & \beta: \cU \to L^+, \qquad (\xi_1, \ldots, \xi_m, \chi_1, \ldots, \chi_m) \mapsto \left(e^{\chi_1+\sum_i\Omega_{i1}\xi_i}, \ldots, e^{\chi_m+\sum_i\Omega_{im}\xi_i}\right).
  \end{align*}
  The $\alpha$-fibers are symplectic orthogonal to the $\beta$-fibers; both $\alpha: (\cU, \omega_\cU) \to (L, \pi)$ and $\beta: (\cU, - \omega_\cU) \to (L, \pi)$ are Poisson maps.

  For the standard symplectic structure $\omega_0 = \sum_{i} d\chi_i \wedge d\xi_i$ on $\cU$, since
  \[\omega_\cU - \omega_0 = \left(\sum_{i} d\chi_i \wedge d\xi_i + \sum_{j < i} \Omega_{ij} d\xi_i \wedge d\xi_j \right) - \sum_{i} d\chi_i \wedge d\xi_i  =\sum_{j < i} \Omega_{ij} d\xi_i \wedge d\xi_j\]
  is supported on the $\alpha$-fiber, we have that $\beta_*(-\omega_0^{-1}) = \beta_*(-\omega_\cU^{-1}) = \pi$.
  The symplectic realization $\beta: (\cU, -\omega_0) \to (L^+, \pi)$ plays an essential role in \cite{MR3691969}.
\end{remark}

Next, we describe the Lie algebroid of $\cD \rra L$.
We introduce coordinates on $A_\cD \cong L\times L$ with the bundle projection
\[A_\cD \cong L\times L \to L, \qquad (\bfxi, \bfx) \mapsto \bfx.\]
For an $m\times m$ skew-symmetric matrix $\Omega$, we define a Lie algebroid structure on $A_\cD$ with the anchor map
\[\rho_\cD: A_\cD \cong L\times L \to TL, \qquad (\bfxi, \bfx) \mapsto \sum_{i,j} \Omega_{ij}\xi_i x_j\frac{\partial}{\partial x_j},\]
where the kernel of $\rho_\cD$ has trivial bracket.

\begin{proposition}
  The Lie algebroid of the Poisson groupoid $\cD \rra L$ in Theorem~\ref{thm:SymDBLoc} is isomorphic to $A_\cD$.
\end{proposition}
\begin{proof}
  With the notation in Theorem~\ref{thm:SymDBLoc}, if we write $e^{\xi_i} = s_i$, then $\Lie \cD = \ker \left(\alpha_*: T\cD|_{\mathtt{1}_L} \to TL \right)$ is generated by $\frac{\partial}{\partial \xi_i}$, $i = 1, \ldots, m$.
  Rewriting the target map $\beta$ in $(\bfxi, \bfx)$ coordinates, we get
  \[\beta: (\bfxi, \bfx) \mapsto \left(e^{\sum_i\Omega_{i1}\xi_i}x_1, \ldots, e^{\sum_i\Omega_{im}\xi_i}x_m\right).\]
  Therefore, 
  \begin{equation} 
    \label{eq: D anchor}
    \beta_* \left(\frac{\partial}{\partial \xi_i}\right) = \sum_j \Omega_{ij} x_j \frac{\partial}{\partial x_j}, \quad 
    \beta_* \left(\sum_i \xi_i \frac{\partial}{\partial \xi_i}\right) = \sum_{i,j} \Omega_{ij} \xi_i x_j \frac{\partial}{\partial x_j}.
  \end{equation}
  This shows that the bundle map
  \[A_\cD \to \Lie \cD, \qquad (\bfxi, \bfx) \to \sum_i \xi_i \frac{\partial}{\partial \xi_i}\]
  is a Lie algebroid isomorphism.
\end{proof}

Fixing an $m\times m$ skew-symmetric matrix $\Omega$ and the corresponding log-canonical Poisson space as in Definition~\ref{def: logPoisson}, the cotangent Lie algebroid $T^*_\pi L$ is not isomorphic to the Lie algebroid $A_\cD$.
In fact, $T^*_\pi L$ is isomorphic to an iterated elementary modification of $A_\cD$ and we obtain a source-connected symplectic groupoid of $(L,\pi)$ via the blow-up construction \cite{MR3214314}. 
\begin{definition}
  Let $E$ be a vector bundle over $M$ and let $F$ be a subbundle of $E|_L$ for some hypersurface $L$. The \emph{elementary (lower) modfication} of $E$ along $F$, denoted by $[E\!:\!F]$, is the vector bundle with the sheaf of sections
  \[\Gamma\big(M, [E\!:\!F]\big) = \{s \in \Gamma(M, E) : s|_L \in \Gamma(L, F) \}.\]
\end{definition}

\begin{proposition} 
  \cite{MR3214314}
  Let $A$ be a Lie algebroid over $M$ and let $B$ be a subbundle of $A|_L$ for some hypersurface $L$ such that $B$ is also a Lie algebroid over $L$.
  Then $[A\!:\!B]$ is a Lie algebroid over $M$.
\end{proposition}

Let $\cG \rra M$ be a Lie groupoid and let $\cH \rra L$ be a Lie subgroupoid over a hypersurface $L$. We denote the blow-up of $\cG$ along $\cH$ by $\mathrm{Bl}(\cG, \cH)$ with the blow-down map $\nu: \mathrm{Bl}(\cG, \cH) \to \cG$ and write $[\cG\!:\!\cH] = \mathrm{Bl}(\cG, \cH) \setminus (S_L \cup T_L)$, where $S_L$ is the proper transform of $\alpha^{-1}(L)$ and $T_L$ is the proper transform of $\beta^{-1}(L)$.

\begin{theorem} 
  \cite{MR3214314}
  For a Lie groupoid $\cG \rra M$ and a Lie subgroupoid $\cH \rra L$ for some hypersurface $L$, there is a unique Lie groupoid structure $[\cG\!:\!\cH] \rra M$ such that the blow-down map $\nu: [\cG\!:\!\cH] \to \cG$ is a groupoid morphism.
  Moreover, blow-up of Lie groupoids corresponds to elementary modification of Lie algebroids. That is,
  \[\Lie[\cG\!:\!\cH] = [\Lie\cG\!:\!\Lie\cH].\]
\end{theorem}

Our task is now clear.
We need to find the Lie subalgebroids of $A_\cD$ such that the iterated elementary modifications along these Lie subalgebroids yield the cotangent algebroid $T^*_\pi L$.

For each $k = 1, \ldots, m$, we define the Lie subalgebroid $A_\cD^k$ of $A_\cD$ as follows.
Let $L_k$ be the codimension-1 subpace in $L$ defined by $x_k = 0$.
As a vector bundle, $A_\cD^k$ is the corank-$1$ subbundle of $A_\cD |_{L_k}$ defined by $\xi_k = 0$.
That is, the anchor map of $A_\cD^k$ is given by
\begin{align*}
  \rho_\cD^k: ~& A_\cD^k \cong L_k\times L_k \to TL_k, \\
  & (\xi_1, \ldots, \xi_{k-1}, \xi_{k+1}, \ldots, \xi_m, x_1, \ldots, x_{k-1}, x_{k+1}, \ldots, x_m) \mapsto \sum_{\substack{1\le i,j \le m\\ i,j\ne k}} \Omega_{ij}\xi_i x_j\frac{\partial}{\partial x_j}.
\end{align*}

\begin{proposition}
  Fixing an $m\times m$ skew-symmetric matrix $\Omega$ and the corresponding log-canonical Poisson space as in Definition~\ref{def: logPoisson}, the cotangent algebroid $T^*_\pi L$ is isomorphic the Lie algebroid
  \[[\ldots[[A_\cD\!:\!A_\cD^1]\!:\!A_\cD^2] \ldots \!:\!A_\cD^m].\]
\end{proposition}
\begin{proof}
  The Poisson structure $\pi = \sum_{j < i} \Omega_{ij} x_ix_j\frac{\partial}{\partial x_i} \wedge \frac{\partial}{\partial x_j}$ gives rise to the Poisson anchor map
  \begin{equation}	
    \label{eq:log-can Poiss}
    \pi^\flat: T^*L \to TL, \qquad dx_i \to \sum_j \Omega_{ij}  x_ix_j \frac{\partial}{\partial x_j}.
  \end{equation}
  The result follows by comparing \eqref{eq:log-can Poiss} with the anchor map \eqref{eq: D anchor} for $\Lie \cD\cong A_\cD$.
\end{proof}

To obtain a source-connected symplectic groupoid of the log-canonical Poisson space $(L, \pi)$ which integrates $T^*_\pi L$, we need to iteratively blow up the Poisson groupoid $\cD \rra L$ along the subgroupoids integrating $A_\cD^k$, for $k =1, \ldots, m$.
Indeed, the Lie subalgebroid $A_\cD^k$ integrates to the subgroupoid $\cD_k \rra L_k$ defined by $x_k=0$ and $s_k=1$, so we define the Lie groupoid
\[\cB = [\ldots[[\cD\!:\!\cD_1]\!:\!\cD_2] \ldots \!:\!\cD_m].\]
Using the blow-up coordinates $u_i = \frac{s_i-1}{x_i}$, we have the following symplectic groupoid structure on $\cB \rra L$.
\begin{theorem} 
  \label{th:blowup groupoid}
  For the log-canonical Poisson structure $\{x_i, x_j\} = \Omega_{ij} x_i x_j$ on $L$ (which is either $\RR^m$ or $\CC^m$), we have that $(\cB, \omega_\cB) \rra (L, \pi)$ is a source-connected symplectic groupoid with the following structures:
  \begin{enumerate}
    \item $\cB \subset L \times L$ has the coordinates $(\bfu, \bfx) = (u_1, \ldots, u_m, x_1, \ldots, x_m)$;
    \item $\cB$ is given by $u_i x_i + 1 > 0$ if $L = \RR^m$ and $u_i x_i + 1\ne 0$ if $L = \CC^m$;
    \item the source map is
      \[\alpha: \cB \to L, \qquad (\bfu, \bfx) \mapsto \bfx;\]
    \item the target map is
      \[\beta: \cB \to L, \qquad (\bfu, \bfx) \mapsto \left(x_1 \prod_{i=1}^m (u_ix_i+1)^{\Omega_{i1}}, \ldots, x_m \prod_{i=1}^m (u_ix_i+1)^{\Omega_{im}}\right);\]
	\item the identity map $\mathtt{1}: L \to \cB, \quad \bfx \mapsto (\bfzero, \bfx)$;
    \item the inverse map is $\iota: \cB \to \cB$ sending $(\bfu, \bfx)$ to 
      \[\left(-\frac{u_1\prod_{i=1}^m (u_ix_i+1)^{-\Omega_{i1}}}{u_1x_1+1}, \ldots, -\frac{u_m\prod_{i=1}^m (u_ix_i+1)^{-\Omega_{im}}}{u_mx_m+1}, x_1 \prod_{i=1}^m (u_ix_i+1)^{\Omega_{i1}}, \ldots, x_m \prod_{i=1}^m (u_ix_i+1)^{\Omega_{im}}\right);\]
    \item the multiplication map is
      \[\begin{aligned}
	  m: & \cB {_\beta \times_\alpha} \cB \to \cB, \\
	     & \left((\bfu, \bfx), \left(\bfu', x_1 \prod_{i=1}^m (u_ix_i+1)^{\Omega_{i1}}, \ldots, x_m \prod_{i=1}^m (u_ix_i+1)^{\Omega_{im}}\right)\right) \mapsto (\bfu'', \bfx )
        \end{aligned}\]
        where $u''_i = \left( u'_i (u_ix_i+1) \prod_{j=1}^m (u_jx_j+1)^{\Omega_{ji}} + u_i \right)$;
    \item the multiplicative Poisson structure is
    \begin{equation}
	\sigma_\cB = \sum_{i} (t_i x_i + 1) \frac{\partial}{\partial t_i} \wedge \frac{\partial}{\partial x_i} - \sum_{i, j} \Omega_{ij}t_i x_j \frac{\partial}{\partial t_i} \wedge \frac{\partial}{\partial x_j} +\sum_{j < i} \Omega_{ij}t_it_j \frac{\partial}{\partial t_i} \wedge \frac{\partial}{\partial t_j} + \sum_{j < i} \Omega_{ij}x_ix_j \frac{\partial}{\partial x_i} \wedge \frac{\partial}{\partial x_j},
    \end{equation}
    or equivalently the multiplicative symplectic structure $\omega_\cB$ is
    \begin{align*} 
	\omega_\cB & = \sum_{i} \frac{1}{t_ix_i+1}dx_i \wedge dt_i + \sum_{i, j} \frac{\Omega_{ij}t_ix_j}{(t_ix_i+1)(t_jx_j+1)}  dx_i \wedge dt_j \\
	& \quad + \sum_{j < i}\frac{\Omega_{ij}t_it_j}{(t_ix_i+1)(t_jx_j+1)}  dx_i \wedge dx_j + \sum_{j < i} \frac{\Omega_{ij}x_ix_j}{(t_ix_i+1)(t_jx_j+1)}  dt_i \wedge dt_j.
      \end{align*}
  \end{enumerate}
\end{theorem}

\begin{proof}
  These are the same groupoid structures as in Theorem~\ref{thm:SymDBLoc} with the change of variables $u_i = \frac{s_i-1}{x_i}$.
  The difference is precisely that $\omega_\cB$ is no longer singular. Note that $\omega_\cB$ is also non-degenerate since
  \[(\omega_\cB)^m = m!  \prod_{1\leq i\leq m} \frac{1}{t_ix_i+1} \bigwedge\limits_{1\leq i\leq m} dx_i \wedge dt_i\]
  is a volume form.
\end{proof}

\begin{remark}
  Recall that the infinitesimal object of a Poisson groupoid is a Lie bialgebroid \cite{MR1262213}.
  The Lie bialgebroid of the Poisson groupoid $\cD \rra L$ is isomorphic to $\big(A_\cD, TL(-\log D)\big)$, where $TL(-\log D)$ is the log tangent bundle with respect to the normal crossing divisor $D = L_1 + L_2 + \ldots + L_k$ \cite{MR3214314}.
  That is,
  \[TL(-\log D) = [\ldots[[TL\!:\!TL_1]\!:\!TL_2] \ldots \!:\!TL_m],\]
  or equivalently the sections of $TL(-\log D)$ are the vector fields on $L$ tangent to $L_k$ for $k = 1, \ldots, m$.
  As a vector bundle, $TL(-\log D)$ is generated by $x_k \frac{\partial}{\partial x_k}$, $k = 1, \ldots, m$, and its dual bundle $T^*L(-\log D)$ is generated by $\frac{d x_k}{x_k}$, $k = 1, \ldots, m$.
  The bundle map
  \[A_\cD \to T^*L(-\log D), \qquad (\bfxi, \bfx) \mapsto \sum_k\xi_k\frac{d x_k}{x_k}\]
  identifies $A_\cD$ with $T^*L(-\log D)$.

  The iterated blow-up construction that takes $\cD \rra L$ to $\cB \rra L$ corresponds to the elementary modification that takes the Lie bialgebroid $(A_\cD, TL(-\log D))$ to the Lie bialgebroid $(T^*_\pi L, TL)$, where $T^*_\pi L$ is an elementary lower modification of $A_\cD$ and $TL$ is an elementary upper modification of $TL(-\log D)$.
  See the first author's thesis for details \cite{MR3312911}.
\end{remark}

For an integrable Lie algebroid, every source-connected groupoid receives a surjective groupoid map from the source-simply-connected groupoid.
This means that we have a natural symplectic groupoid morphism $\kappa:\cG\to\cB$.
Together with the blow-down map $\nu:\cB\to\cD$, the following commutative diagram summarizes the maps among the groupoids $\cG$, $\cB$ and $\cD$.
\begin{equation} 
  \label{eq:LGpdCD}
  \xymatrix{
    \cG  \ar[dr]_{\kappa} \ar[rr]^{\lambda} && \cD \\
      & \cB \ar[ur]_{\nu}
  }
\end{equation}
Explicitly in coordinates, these maps are given by
\begin{align}
  & \kappa: \cG \to \cB, \qquad (\bfp, \bfx) \mapsto \left(\frac{e^{x_1p_1}-1}{x_1}, \ldots, \frac{e^{x_mp_m}-1}{x_2}, \bfx\right); \\
  & \nu: \cB \to \cD, \qquad (\bfu, \bfx) \mapsto (u_1x_1+1, \ldots, u_mx_m+1, \bfx); \\
  & \lambda: \cG \to \cD, \qquad (\bfp, \bfx) \mapsto (e^{x_1p_1}, \ldots, e^{x_mp_m}, \bfx).
\end{align}

\begin{remark}
  If $L = \RR^m$, then $\cB \rra L$ is source-simply-connected and all three groupoid maps are groupoid isomorphisms when we restricted the base to $L^+ = \RR_+^m$, but if $L = \CC^m$, then $\cB$ is not source-simply-connected and $\kappa: \cG \to \cB$ is a covering map for each source fiber.
\end{remark}

We summarize the pros and cons of the three groupoids $\cG \rra L$, $\cB \rra L$ and $\cD \rra L$.

The symplectic groupoid $\cG \rra L$ is source-simply-connected when the underlying field is $\CC$, and as we will see in \S\ref{sec:groupoid mutations}, is the only one among the three groupoids for which the Poisson ensemble map $\rho: L_\cA \to L_\cX$ from an holomorphic $\cA$-variety to its corresponding holomorphic $\cX$-variety can be lifted to a symplectic groupoid map $\rho: \cG_\cA \to \cG_\cX$.
The disadvantage of $\cG \rra L$ is that its groupoid structure maps are transcendental.

On the other hand, the multiplicative Poisson structure of $\cD \rra L$ has a simple expression and its groupoid structure maps are algebraic, but it is only symplectic when restricted to $L^+$.
Both $\cG \rra L$ and $\cB \rra L$ are symplectic groupoids over $L$, and as we will see in \S\ref{sec:groupoid mutations}, this enables us to define the groupoid mutations for $\cG$ and $\cB$ over $\bar{L}^+$ when the underlying field is $\RR$.

Comparing to $\cG \rra L$, the symplectic groupoid $\cB \rra L$ has the added plus that its groupoid structure maps are algebraic, but the tradeoff comparing to $\cD \rra L$ is that its multiplicative Poisson structure and its groupoid structures are somewhat more complicated.


%\begin{equation} 
%    \label{eq:LGpdCD}
%    \xymatrix{
%      (\cG, \omega_{\cG})  \ar[r]^{\kappa} \ar@/^-0.5pc/[d]|-{\alpha} \ar@/^0.5pc/[d]|-{\beta} & (\cD, \omega_{\cD}) \ar@/^-0.5pc/[d]|-{\alpha} \ar@/^0.5pc/[d]|-{\beta} \\
%       (L, \pi) \ar[u]|-{\mathtt{1}} \ar[r]^{=} & (L, \pi) \ar[u]|-{\mathtt{1}}
%    }
%\end{equation}
%\begin{proposition}
%  As symplectic groupoids over the log Poisson structure on $\RR_+^m$ or $(\CC^\times)^m$, the map
%  \[
%  	\kappa: \cG \to \cD, \qquad (\bfp, \bfx) \mapsto (e^{x_1p_1}, \ldots, e^{x_mp_m}, \bfx)
%  \]
%  is a symplectic groupoid morphism.
%\end{proposition}
%\begin{proof}
%We show that $\kappa$ is compatible with the target maps, and leave the compatibility with other structure maps to the readers.
%	\begin{align*}
%		(\beta_\cD \circ \kappa) (\bfp, \bfx) & = \beta_\cD (e^{x_1p_1}, \ldots, e^{x_mp_m}, \bfx) \\
%		& = \left(x_1 \prod_{i=1}^m e^{\Omega_{i1}x_ip_i}, \ldots, x_m \prod_{i=1}^m e^{\Omega_{im}x_ip_i}\right) \\
%		& = \left(x_1 e^{\sum_i \Omega_{i1}x_ip_i}, \ldots, x_m  e^{\sum_i \Omega_{im}x_ip_i}\right) \\
%		& = \beta_\cG (\bfp, \bfx).
%	\end{align*}
%To show that $\kappa$ preserves the symplectic structures, we have
%	\begin{align*}
%		\kappa^*\omega_\cD & = \sum_{i} \frac{dx_i}{x_i} \wedge \frac{d(e^{x_ip_i})}{e^{x_ip_i}} + \sum_{j < i} \Omega_{ij} \frac{d(e^{x_ip_i})}{e^{x_ip_i}} \wedge \frac{d(e^{x_jp_j})}{e^{x_jp_j}} \\
%		& = \sum_{i} \frac{dx_i}{x_i} \wedge (x_i dp_i + p_i dx_i) + \sum_{j < i} \Omega_{ij} (x_i dp_i + p_i dx_i) \wedge (x_j dp_j + p_j dx_j) \\
%		& = \sum_{i} dx_i \wedge dp_i
%	  	+ \left(
%	    	\sum_{i, j} \Omega_{ij}p_ix_j dx_i \wedge dp_j 
%	    	+ \sum_{j < i} \Omega_{ij}p_ip_j dx_i \wedge dx_j
%	    	+ \sum_{j < i} \Omega_{ij}x_ix_j dp_i \wedge dp_j
%	  	\right) \\
%		& = \omega_\cG.
%	\end{align*}
%\end{proof}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Hamiltonian Perspective on Mutations}
\label{sec:mutations}

In this section, we introduce mutations of cluster seeds from the Hamiltonian viewpoint.
This perspective was first given in \cite{FG09c} and is the foundation for the main results of \cite{MR3691969}.
We demonstrate how the Hamiltonian perspective provides a canonical choice of mutations for groupoid charts which glue to give a symplectic groupoid integrating various log-canonical Poisson structures on cluster varieties.
The standard combinatorics of $\bfc$-vectors, $\bfg$-vectors, and $F$-polynomials are then lifted to provide descriptions of iterations of the gluing maps for groupoid charts.

While in Section~\ref{sec:local} it was most convenient to use covariant notation for all maps of groupoids, due to the algebraic nature of cluster mutations and also the piecewise nature of the formulae, in this section we use contravariant notation for describing all maps, i.e.\ we describe them via the pullback of coordinate functions.

Let $\tilde B=(B_{ij})$ be an $m\times n$ integer matrix with $m\ge n$.  
Write $B$ for the upper $n\times n$ submatrix of $\tilde B$ and assume $B$ is skew-symmetrizable, i.e.\ there exists a diagonal integer matrix $D=\diag(d_1,\ldots,d_n)$ with each $d_i>0$ so that $DB$ is skew-symmetric. 
Such an $m\times n$ matrix $\tilde B$ with skew-symmetrizable principal submatrix $B$ is called an \emph{exchange matrix}.
We fix a skew-symmetrizing matrix $D$ and refer to a skew-symmetric $m\times m$ matrix $\Omega=(\Omega_{ij})$ as \emph{$D$-compatible} with $\tilde B$ if $\tilde B^T\Omega=[D\ \boldsymbol{0}]$, where $\boldsymbol{0}$ denotes an $n\times(m-n)$ matrix with all zero entries.
In this case, we call $(\tilde B,\Omega)$ a \emph{$D$-compatible pair}.

\subsection{Mutation of Cluster Charts}
\label{sec:cluster}

We begin by recalling the Hamiltonian perspective of mutations for cluster charts.
Let $L^+_\cX=\RR_+^n$ and $L^+_\cA=\RR_+^m$.
Write $\bfy=(y_1,\ldots,y_n)$ for a set of coordinates on $L^+_\cX$ and $\bfx=(x_1,\ldots,x_m)$ for a set of coordinates on $L^+_\cA$.
Given a $D$-compatible pair of matrices $(\tilde B,\Omega)$, denote by $\{\cdot,\cdot\}_\cX$ and $\{\cdot,\cdot\}_\cA$ the log-canonical Poisson brackets on $L_\cX$ and $L_\cA$ given by
\begin{equation}
  \label{eq:brackets}
  \{y_k,y_\ell\}_\cX=d_kB_{k\ell}y_ky_\ell\qquad\text{and}\qquad\{x_i,x_j\}_\cA=\Omega_{ij}x_ix_j.
\end{equation}
An easy calculation shows that there is a Poisson map
\begin{equation}\label{eq:ensemble}
	\rho:L_\cA\to L_\cX,\qquad \rho^*(y_k)=\hat y_k:=\prod_{i=1}^m x_i^{B_{ik}},
\end{equation}
i.e.\ $\{\hat y_k,\hat y_\ell\}_\cA=d_kB_{k\ell}\hat y_k\hat y_\ell$ for $1\le k,\ell\le n$.
Motivated by the terminology of Fock and Goncharov \cite{FG09a}, we will refer to the pair of Poisson manifolds $L_\cX$ and $L_\cA$ together with the Poisson map $\rho$ as a \emph{Poisson ensemble} associated to the $D$-compatible pair $(\tilde B,\Omega)$.

The \emph{Euler dilogarithm} is the function of a single real variable defined by
\[\Li_2(y)=-\int_0^y \frac{\log(1-u)}{u}du,\qquad y<1.\]
It will become apparent from the results below that, from the Poisson perspective, the Euler dilogarithm lies at the heart of cluster algebra theory.
However, we will work in a slightly more general setting.

Fix a collection of positive integers $\bfr=(r_1,\ldots,r_n)\in\ZZ_{>0}^n$ and write $L_\bfr=\prod_{\ell=1}^n \RR_+^{r_\ell-1}$ with coordinates $z_{\ell,j}$ for $1\le\ell\le n$, $1\le j\le r_\ell-1$.
We identify the $\ell$-th component of a point in $L_\bfr$ with the degree $r_\ell$ monic polynomial $Z_\ell(u)\in\RR_+[u]$ with $Z_\ell(0)=1$ given by
\[Z_\ell(u)=1+z_{\ell,1}u+\cdots+z_{\ell,r_\ell-1}u^{r_\ell-1}+u^{r_\ell}.\]
Set 
\[L_{\cX,\bfr}:=L_\cX\times L_\bfr\qquad\text{ and }\qquad L_{\cA,\bfr}:=L_\cA\times L_\bfr.\]
Here we extend the Poisson structures on $L_\cX$ and $L_\cA$ to $L_{\cX,\bfr}$ and $L_{\cA,\bfr}$ so that the coordinate functions $z_{\ell,j}$ on $L_\bfr$ are Casimirs. 
Then the map $\rho:L_\cA\to L_\cX$ extends to a Poisson map $L_{\cA,\bfr}\to L_{\cX,\bfr}$ which we still denote by $\rho$.

Given a choice of sign $\varepsilon\in\{\pm1\}$, define Hamiltonian functions $h^{k,\varepsilon}_{\cX,\bfr}\in\cO_{L_{\cX,\bfr}}$ and $h^{k,\varepsilon}_{\cA,\bfr}\in\cO_{L_{\cA,\bfr}}$ for $1\le k\le n$ by
\begin{equation}
  \label{eq:hamiltonians}
  h_{\cX,\bfr}^{k,\varepsilon}:=-\frac{\varepsilon}{d_k}\int_0^{y_k^\varepsilon} \frac{\log\big(Z_k(u)\big)}{u}du\qquad\text{and}\qquad h_{\cA,\bfr}^{k,\varepsilon}:=-\frac{\varepsilon}{d_k}\int_0^{\hat y_k^\varepsilon} \frac{\log\big(Z_k(u)\big)}{u}du.
\end{equation}
Observe that when $r_k=1$, i.e.\ $Z_k(u)=1+u$, we have $h_{\cX,\bfr}^{k,\varepsilon}:=\frac{\varepsilon}{d_k}\Li_2(-y_k^\varepsilon)$ and $h_{\cA,\bfr}^{k,\varepsilon}:=\frac{\varepsilon}{d_k}\Li_2(-\hat y_k^\varepsilon)$.

Clearly, there is an equality $\rho^*(h_{\cX,\bfr}^{k,\varepsilon})=h_{\cA,\bfr}^{k,\varepsilon}$.
Write $X_{\cX,\bfr}^{k,\varepsilon}\in\cT_{L_{\cX,\bfr}}$ and $X_{\cA,\bfr}^{k,\varepsilon}\in\cT_{L_{\cA,\bfr}}$ for the Hamiltonian vector fields associated to $h_{\cX,\bfr}^{k,\varepsilon}$ and $h_{\cA,\bfr}^{k,\varepsilon}$ respectively, i.e.\ the vector fields naturally associated to the derivations $\{h_{\cX,\bfr}^{k,\varepsilon},\cdot\}_\cX$ and $\{h_{\cA,\bfr}^{k,\varepsilon},\cdot\}_\cA$.
\begin{lemma}
  \label{le:hamiltonian dynamics}
  For $1\le k\le n$ and $\varepsilon\in\{\pm1\}$, the vector fields $X_{\cX,\bfr}^{k,\varepsilon}$ and $X_{\cA,\bfr}^{k,\varepsilon}$ determine the following dynamics on $L_{\cX,\bfr}$ and $L_{\cA,\bfr}$:
  \begin{align}
    \label{eq:X dynamics}
    \dot y_\ell&:=\{h_{\cX,\bfr}^{k,\varepsilon},y_\ell\}_\cX=-B_{k\ell}\log\big(Z_k(y_k^\varepsilon)\big)y_\ell\quad\text{for}\quad 1\le\ell\le n;\\
    \label{eq:A dynamics}
    \dot x_j&:=\{h_{\cA,\bfr}^{k,\varepsilon},x_j\}_\cA=-\delta_{jk}\log\big(Z_k(\hat y_k^\varepsilon)\big)x_k\quad\text{for}\quad 1\le j\le m.
  \end{align}
  Moreover, the points of $L_\bfr$ are fixed by the Hamiltonian flows.
\end{lemma}
\begin{proof}
  Equation~\eqref{eq:X dynamics} was essentially proven in \cite{MR3691969}.
  Since equation~\eqref{eq:A dynamics} seems to technically be new, we will indicate the key steps in the computation here:
  \[\{h_{\cA,\bfr}^{k,\varepsilon},x_j\}_\cA=-\frac{\log\big(Z_k(\hat y_k^\varepsilon)\big)}{d_k\hat y_k}\{\hat y_k,x_j\}=-\delta_{jk}\log\big(Z_k(\hat y_k^\varepsilon)\big)x_j.\]
\end{proof}

It immediately follows that $y_k$ is a conserved quantity under the flow of $L_{\cX,\bfr}$ by the vector field $X_{\cX,\bfr}^{k,\varepsilon}$.
Since the map $\rho$ is Poisson with $\hat y_k=\rho^*(y_k)$, we also see that $\hat y_k$ is a conserved quantity under the flow of $L_{\cA,\bfr}$ by the vector field $X_{\cA,\bfr}^{k,\varepsilon}$.
\begin{corollary}
  \label{cor:time-one flows}
  For $1\le k\le n$ and $\varepsilon\in\{\pm1\}$, the time-$t$ flow $\varphi_{\cX,\bfr}^t:L_{\cX,\bfr}\to L_{\cX,\bfr}$ of the Hamiltonian vector field $X_{\cX,\bfr}^{k,\varepsilon}$, given on coordiates by
  \[(\varphi_{\cX,\bfr}^t)^*(y_\ell)=\big(Z_k(y_k^\varepsilon)\big)^{-tB_{k\ell}}y_\ell,\qquad (\varphi_{\cX,\bfr}^t)^*(z_{\ell,i})=z_{\ell,i},\]
  and the time-$t$ flow $\varphi_{\cA,\bfr}^t:L_{\cA,\bfr}\to L_{\cA,\bfr}$ of the Hamiltonian vector field $X_{\cA,\bfr}^{k,\varepsilon}$, given on coordiates by
  \[(\varphi_{\cA,\bfr}^t)^*(x_j)=\big(Z_k(\hat y_k^\varepsilon)\big)^{-t\delta_{jk}}x_j,\qquad (\varphi_{\cA,\bfr}^t)^*(z_{\ell,i})=z_{\ell,i}\]
  both preserve the respective Poisson structures.
\end{corollary}
\begin{proof}
  The computation of the flows is immediate from the preceding discussion.
  That the flow of these vector fields preserve the Poisson structures follows from their Hamiltonian definition.
\end{proof}

In what follows we use the notation $[b]_+:=\max\{b,0\}$.
For $1\le k\le n$ and a sign $\varepsilon\in\{\pm1\}$, define the \emph{mutation of the pair $(\tilde B,\Omega)$ in direction $k$} by $\mu_{\bfr,k,\varepsilon}(\tilde B,\Omega)=\big(\mu_{\bfr,k,\varepsilon}\tilde B,\Omega'\big)$, where
\begin{itemize}
  \item $\mu_{\bfr,k,\varepsilon}\tilde B=(B'_{ij})$ is given by
    \[B'_{ij}=\begin{cases}-B_{ij} & \text{if $i=k$ or $j=k$;}\\ B_{ij} + [-\varepsilon B_{ik}r_k]_+ B_{kj} + B_{ik} [\varepsilon r_kB_{kj}]_+ & \text{otherwise;}\end{cases}\]
  \item $\Omega'=E_{\bfr,k,\varepsilon}^T\Omega E_{\bfr,k,\varepsilon}$ for $E_{\bfr,k,\varepsilon}$ the $m\times m$ matrix with entries
    \[E_{ij}=\begin{cases}\delta_{ij} & \text{if $j\ne k$;}\\ -1 & \text{if $i=j=k$;}\\ [-\varepsilon B_{ik}r_k]_+ & \text{if $i\ne j=k$.}\end{cases}\]
\end{itemize}
It is an easy exercise to check that $\big(\mu_{\bfr,k,\varepsilon}\tilde B,\Omega'\big)$ is again $D$-compatible and that the mutation of compatible pairs is an involution, more precisely 
\[\mu_{\bfr,k,\varepsilon}\mu_{\bfr,k,\varepsilon'}(\tilde B,\Omega)=(\tilde B,\Omega)\]
for any signs $\varepsilon,\varepsilon'\in\{\pm1\}$.
In particular, the mutation $\mu_{\bfr,k,\varepsilon}$ acting on $D$-compatible pairs is independent of the sign $\varepsilon$ and we simply write $\mu_{\bfr,k}$ for this mutation when the choice of sign can be ignored.

Let $L^+_{\cX'}=\RR_+^n$ and $L^+_{\cA'}=\RR_+^m$ with coordinates $\bfy'=(y'_1,\ldots,y'_n)$ and $\bfx'=(x'_1,\ldots,x'_m)$ respectively.
For $1\le k\le n$, set $(\tilde B',\Omega')=\mu_{\bfr,k}(\tilde B,\Omega)$ and consider the log-canonical Poisson structures $\{\cdot,\cdot\}'_\cX$ and $\{\cdot,\cdot\}'_\cA$ on $L'_\cX$ and $L'_\cA$ given by
\begin{equation}
  \label{eq:brackets2}
  \{y'_k,y'_\ell\}'_\cX=d_kB'_{k\ell}y'_ky'_\ell\qquad\text{and}\qquad\{x'_i,x'_j\}'_\cA=\Omega'_{ij}x'_ix'_j.
\end{equation}
Define $L^+_{\cX',\bfr}$ and $L^+_{\cA',\bfr}$ as above.
\begin{lemma}
  \label{le:tropical cluster transformations}
  For $1\le k\le n$ and $\varepsilon\in\{\pm1\}$, there are Poisson maps $\tau_{\cX,\bfr}^{k,\varepsilon}:L^+_{\cX,\bfr}\to L^+_{\cX',\bfr}$ and $\tau_{\cA,\bfr}^{k,\varepsilon}:L^+_{\cA,\bfr}\to L^+_{\cA',\bfr}$ which are each the identity map on the $L_\bfr$ component and are given on coordinates of $L^+_\cX$ and $L^+_\cA$ by
  \begin{align}
    \label{eq:tropical X transformation}
    (\tau_{\cX,\bfr}^{k,\varepsilon})^*(y'_\ell)
    &=\begin{cases} 
      y_k^{-1} & \text{if $\ell=k$;}\\ 
      y_\ell y_k^{[\varepsilon r_kB_{k\ell}]_+} & \text{if $\ell\ne k$;}
    \end{cases}\\
    \label{eq:tropical A transformation}
    (\tau_{\cA,\bfr}^{k,\varepsilon})^*(x'_j)
    &=\begin{cases} 
      x_k^{-1}\prod\limits_{i=1}^m x_i^{[-\varepsilon B_{ik}r_k]_+} & \text{if $j=k$;}\\
      x_j & \text{if $j\ne k$.}
    \end{cases}
  \end{align}
\end{lemma}
\begin{proof}
  By skew-symmetry of the Poisson brackets, there are essentially only two cases to check and just one of these is non-trivial for each transformation.
  For $\ell,\ell'\ne k$, we have
  \begin{align*}
    \{(\tau_{\cX,\bfr}^{k,\varepsilon})^*(y'_\ell),(\tau_{\cX,\bfr}^{k,\varepsilon})^*(y'_{\ell'})\}_\cX
    &=\left\{y_\ell y_k^{[\varepsilon r_kB_{k\ell}]_+},y_{\ell'} y_k^{[\varepsilon r_kB_{k\ell'}]_+}\right\}_\cX\\
    &=(d_\ell B_{\ell\ell'}+d_k[\varepsilon r_kB_{k\ell}]_+B_{k\ell'}+d_\ell B_{\ell k}[\varepsilon r_kB_{k\ell'}]_+) y_\ell y_k^{[\varepsilon r_kB_{k\ell}]_+} y_{\ell'} y_k^{[\varepsilon r_kB_{k\ell'}]_+}\\
    &=(d_\ell B_{\ell\ell'}+d_\ell[-\varepsilon B_{\ell k}r_k]_+B_{k\ell'}+d_\ell B_{\ell k}[\varepsilon r_kB_{k\ell'}]_+) y_\ell y_k^{[\varepsilon r_kB_{k\ell}]_+} y_{\ell'} y_k^{[\varepsilon r_kB_{k\ell'}]_+}\\
    &=d_\ell B'_{\ell\ell'} (\tau_{\cX,\bfr}^{k,\varepsilon})^*(y'_\ell) (\tau_{\cX,\bfr}^{k,\varepsilon})^*(y'_{\ell'}).
  \end{align*}
  The case where $\ell$ or $\ell'$ are equal to $k$ is immediate and we omit the details.

  For $\tau_{\cA,\bfr}^{k,\varepsilon}$, we only check the brackets of $x'_k$ and $x'_j$ for $j\ne k$:
  \begin{align*}
    \{(\tau_{\cA,\bfr}^{k,\varepsilon})^*(x'_k),(\tau_{\cA,\bfr}^{k,\varepsilon})^*(x'_j)\}_\cA
    &=\left\{x_k^{-1}\prod\limits_{i=1}^m x_i^{[-\varepsilon B_{ik}r_k]_+},x_j\right\}_\cA\\
    &=\left(-\Omega_{kj}+\sum_{i=1}^m [-\varepsilon B_{ik}r_k]_+\Omega_{ij}\right) \left(x_k^{-1} \prod\limits_{i=1}^m x_i^{[-\varepsilon B_{ik}r_k]_+}\right)x_j\\
    &=\Omega'_{kj} (\tau_{\cA,\bfr}^{k,\varepsilon})^*(x'_k) (\tau_{\cA,\bfr}^{k,\varepsilon})^*(x'_j).
  \end{align*}
\end{proof}

Since the mutation of $D$-compatible pairs is an involution, we obtain analogous Poisson maps from $L^+_{\cX',\bfr}$ to $L^+_{\cX,\bfr}$ and from $L^+_{\cA',\bfr}$ to $L^+_{\cA,\bfr}$ which, by a slight abuse of notation, we denote by the same symbols $\tau_{\cX,\bfr}^{k,\varepsilon}$ and $\tau_{\cA,\bfr}^{k,\varepsilon}$ respectively.
It is important to note that the maps $\tau_{\cX,\bfr}^{k,\varepsilon}$ and $\tau_{\cA,\bfr}^{k,\varepsilon}$ are not independent of the sign $\varepsilon$ and, moreover, that they are not involutions, i.e.\ $(\tau_{\cX,\bfr}^{k,\varepsilon})^2$ and $(\tau_{\cA,\bfr}^{k,\varepsilon})^2$ do not give identity maps on $L^+_{\cX,\bfr}$ nor on $L^+_{\cA,\bfr}$.
However, an easy calculation shows that $\tau_{\cX,\bfr}^{k,\varepsilon}\tau_{\cX,\bfr}^{k,-\varepsilon}$ and $\tau_{\cA,\bfr}^{k,\varepsilon}\tau_{\cA,\bfr}^{k,-\varepsilon}$ will be identity maps for either choice of sign $\varepsilon$.

For $1\le k\le n$ and $\varepsilon\in\{\pm1\}$, define the \emph{cluster mutations in direction $k$} by 
\[\mu_{\cX,\bfr}^{k,\varepsilon}:=\tau_{\cX,\bfr}^{k,\varepsilon}\circ\varphi_{\cX,\bfr}^1:L^+_{\cX,\bfr}\to L^+_{\cX',\bfr}\qquad\text{ and }\qquad\mu_{\cA,\bfr}^{k,\varepsilon}:=\tau_{\cA,\bfr}^{k,\varepsilon}\circ\varphi_{\cA,\bfr}^1:L^+_{\cA,\bfr}\to L^+_{\cA',\bfr}.\]
\begin{lemma}
  \label{le:cluster mutation}
  For $1\le k\le n$ and $\varepsilon\in\{\pm1\}$, the cluster mutations provide Poisson morphisms $\mu_{\cX,\bfr}^{k,\varepsilon}:L^+_{\cX,\bfr}\to L^+_{\cX',\bfr}$ and $\mu_{\cA,\bfr}^{k,\varepsilon}:L^+_{\cA,\bfr}\to L^+_{\cA',\bfr}$ which are the identity map on the $L_\bfr$ components and are given on coordinates of $L^+_\cX$ and $L^+_\cA$ by
  \begin{align}
    \label{eq:X mutation}
    (\mu_{\cX,\bfr}^{k,\varepsilon})^*(y'_\ell)&=\begin{cases} y_k^{-1} & \text{if $\ell=k$;}\\ y_\ell y_k^{[\varepsilon r_kB_{k\ell}]_+} Z_k(y_k^\varepsilon)^{-B_{k\ell}} & \text{if $\ell\ne k$;}\end{cases}\\
    \label{eq:A mutation}
    (\mu_{\cA,\bfr}^{k,\varepsilon})^*(x'_j)&=\begin{cases} x_k^{-1}\left(\prod\limits_{i=1}^m x_i^{[-\varepsilon B_{ik}r_k]_+}\right)Z_k(\hat y_k^\varepsilon) & \text{if $j=k$;}\\ x_j & \text{if $j\ne k$.}\end{cases}
  \end{align}
  Moreover, the cluster mutations $\mu_{\cX,\bfr}^{k,\varepsilon}\mu_{\cX,\bfr}^{k,-\varepsilon}$ and $\mu_{\cA,\bfr}^{k,\varepsilon}\mu_{\cA,\bfr}^{k,-\varepsilon}$ are identity maps on $L^+_{\cX,\bfr}$ and on $L^+_{\cA,\bfr}$ respectively for any choice of sign $\varepsilon$.
\end{lemma}
\begin{proof}
  The first claim immediately follows by combining Corollary~\ref{cor:time-one flows} and Lemma~\ref{le:tropical cluster transformations}.
  The final claim is a consequence of the identities $B'_{k\ell}=-B_{k\ell}$ and $B'_{ik}=-B_{ik}$.
\end{proof}

\begin{remark}
  \label{rem:extended cluster charts}
  While we have assumed that $L^+_\cX=\RR_+^n$, $L^+_\cA=\RR_+^m$, and $Z_k(u)\in\RR_+[u]$ to motivate the Hamiltonian natures of $\mu_{\cX,\bfr}^{k,\varepsilon}$ and~$\mu_{\cA,\bfr}^{k,\varepsilon}$, the cluster mutations \eqref{eq:X mutation} and \eqref{eq:A mutation} are also well-defined when $L^+_\cX=(\CC^\times)^n$, $L^+_\cA=(\CC^\times)^m$, and $Z_k(u)\in\CC[u]$ is a monic polynomial with $Z_k(0)=1$.
  Similarly in the real case, the requirement that the coefficients of $Z_k(u)$ be positive real numbers was unnecessary and we allow any monic polynomials $Z_k(u)\in\RR[u]$ with $Z_k(0)=1$ from now on.
  This holds equally well for the \emph{automorphism parts} $\varphi_{\cX,\bfr}^1$, $\varphi_{\cA,\bfr}^1$ and the \emph{tropical parts} $\tau_{\cX,\bfr}^{k,\varepsilon}$, $\tau_{\cA,\bfr}^{k,\varepsilon}$ of the cluster mutations.
  
  Mutations for $\bar L^+_\cX=\RR_{\ge0}^n$ have also been considered \cite{FG16} under the name ``special completion'' for $\cX$-varieties.
  See also \cite{chavez et al} for similar considerations using charts $L_\cX=\CC^n$.
  It is important in these cases that the map $\mu_{\cX,\bfr}^{k,\varepsilon}$ is not defined on the locus where $y_k=0$ or where $Z_k(y_k^\varepsilon)^{-B_{k\ell}}$ is undefined and that the map $\mu_{\cA,\bfr}^{k,\varepsilon}$ is not defined on the locus where $x_k=0$ or where $\left(\prod\limits_{i=1}^m x_i^{[-\varepsilon B_{ik}r_k]_+}\right)Z_k(\hat y_k^\varepsilon)=0$.
\end{remark}

The various Poisson maps are summarized in the following commutative diagram.
\begin{equation} 
  \label{eq:PoisCD}
  \xymatrix{
    L^+_{\cA,\bfr} \ar[d]^{\rho} \ar[r]_{\varphi_{\cA,\bfr}} \ar@/^1pc/[rr]|-{\mu_{\cA,\bfr}} & L^+_{\cA,\bfr} \ar[d]^{\rho} \ar[r]_{\tau_{\cA,\bfr}} & L^+_{\cA',\bfr} \ar[d]^{\rho} \\
    L^+_{\cX,\bfr} \ar[r]^{\varphi_{\cX,\bfr}} \ar@/_1pc/[rr]|-{\mu_{\cX,\bfr}} & L^+_{\cX,\bfr} \ar[r]^{\tau_{\cX,\bfr}} & L^+_{\cX',\bfr}
  }
\end{equation}
\bigskip

To record the iteration of mutations, we introduce the $n$-regular rooted tree $\TT_n$ with root vertex $t_0$ and with the $n$ edges emanating from each vertex labeled by the set $\{1,\ldots,n\}$.
In particular, each vertex $t\in\TT_n$ is uniquely determined by a sequence of indices specifying the edge labels along the unique path from $t_0$ to~$t$.

Fix an initial $m\times n$ exchange matrix $\tilde B_{t_0}=(B_{ij;t_0})$ and assign exchange matrices $\tilde B_t=(B_{ij;t})$ to the vertices $t\in\TT_n$ so that $\tilde B_{t'}=\mu_{\bfr,k}\tilde B_t$ whenever $t$ and $t'$ are joined by an edge labeled by $k$.
The collection $\{\tilde B_t\}_{t\in\TT_n}$ is called the \emph{mutation pattern} generated by $\tilde B_{t_0}$ and any two exchange matrices $\tilde B_t$, $\tilde B_{t'}$ for $t,t'\in\TT_n$ are said to be \emph{mutation equivalent}.
Given a skew-symmetric $m\times m$ matrix $\Omega_{t_0}=(\Omega_{ij;t_0})$ compatible with $\tilde B_{t_0}$, we define matrices $\Omega_t=(\Omega_{ij;t})$ compatible with $\tilde B_t$ by iterating mutations as above.

As observed above, the inverse of a cluster mutation requires a change of signs $\varepsilon$.
In general, it will be important to make particular choices of the signs $\varepsilon$ as we perform sequences of mutations for the cluster charts $L^+_{\cX,\bfr}$ and $L^+_{\cA,\bfr}$.
To accomplish this, we observe that the mutation pattern gives rise to the following combinatorial construction.
\begin{definition}
  \label{def:tropical signs}
  Given an $n\times n$ skew-symmetrizable matrix $B$, let $\tilde B_{t_0}=\tilde B_{prin}$ denote the $2n\times n$ exchange matrix with principal submatrix $B$ and lower $n\times n$ submatrix given by the $n\times n$ identity matrix $I_n$.
  Then, given $\tilde B_t$ mutation equivalent to $\tilde B_{t_0}$, the lower $n\times n$ submatrix $C_t:=(C_{ij;t})$ of $\tilde B_t$ transforms as follows when $t$ and $t'$ are joined by an edge labeled $k$:
  \begin{equation}
    \label{eq:c-matrix mutation 1}
    C_{ij;t'}=
    \begin{cases}
      -C_{ij;t} & \text{if $j=k$;}\\
      C_{ij;t}+[-\varepsilon C_{ik;t} r_k]_+B_{kj;t}+C_{ik;t}[\varepsilon r_kB_{kj;t}]_+ & \text{if $j\ne k$.}
    \end{cases}
  \end{equation}
  The $C$-matrices have the following \emph{sign-coherence} property: 
  \begin{itemize}
    \item each column of $C_t$, known as a \emph{$\bfc$-vector}, has either all non-negative entries or all non-positive entries \cite{FZ07,NZ12,GHKK14,NR16}.
  \end{itemize}
  Thus each exchange matrix $\tilde B_t$ mutation equivalent to $\tilde B_{t_0}$ admits a collection of \emph{tropical signs} $\varepsilon_{\bfr,k;t}\in\{\pm1\}$, where $\varepsilon_{\bfr,k;t}=1$ if the entries in the $k$-th column of $C_t$ are non-negative and $\varepsilon_{\bfr,k;t}=-1$ if the entries in the $k$-th column of $C_t$ are non-positive. 
  Taking the tropical sign in the mutation formula \eqref{eq:c-matrix mutation 1} for $\bfc$-vectors gives the following simplified mutation rule:
  \begin{equation}
    \label{eq:c-matrix mutation 2}
    C_{ij;t'}=
    \begin{cases}
      -C_{ij;t} & \text{if $j=k$;}\\
      C_{ij;t}+C_{ik;t}[\varepsilon_{\bfr,k;t} r_kB_{kj;t}]_+ & \text{if $j\ne k$.}
    \end{cases}
  \end{equation}

  Given an arbitrary exchange matrix $\tilde B$, we may construct a corresponding principalized exchange matrix $\tilde B_{prin}$ from the principal submatrix $B$ of $\tilde B$.
  Then for each vertex $t\in\TT_n$, we associate the same tropical signs $\varepsilon_{\bfr,k;t}$ as above to the columns of $\tilde B_t$.
\end{definition}

We associate a Poisson space $L^+_{\cX;t}$ isomorphic to either $\RR_+^n$ or $(\CC^\times)^n$ and a Poisson space $L^+_{\cA;t}$ isomorphic to either $\RR_+^m$ or $(\CC^\times)^m$ to each vertex $t\in\TT_n$.
That is, there is a system of coordinates $\bfy_t=(y_{1;t},\ldots,y_{n;t})$ on $L^+_{\cX;t}$ and a system of coordinates $\bfx_t=(x_{1;t},\ldots,x_{m;t})$ on $L^+_{\cA;t}$ satisfying
\begin{equation}
  \label{eq:brackets3}
  \{y_{k;t},y_{\ell;t}\}_\cX=d_kB_{k\ell;t}y_{k;t}y_{\ell;t}\qquad\text{and}\qquad\{x_{i;t},x_{j;t}\}_\cA=\Omega_{ij;t}x_{i;t}x_{j;t}.
\end{equation}
As above, we also introduce the Poisson spaces $L^+_{\cX,\bfr;t}$ isomorphic to either $\RR_+^n\times\prod_{\ell=1}^n \RR^{r_\ell-1}$ or to $(\CC^\times)^n\times\prod_{\ell=1}^n \CC^{r_\ell-1}$ and $L^+_{\cA,\bfr;t}$ isomorphic to either $\RR_+^m\times\prod_{\ell=1}^n \RR^{r_\ell-1}$ or to $(\CC^\times)^m\times\prod_{\ell=1}^n \CC^{r_\ell-1}$.

\begin{definition}
  \label{def:cluster varieties}
  Fix an initial $m\times n$ exchange matrix $\tilde B_{t_0}$ and an initial skew-symmetric $m\times m$ matrix~$\Omega_{t_0}$ which is compatible with~$\tilde B_{t_0}$.
  Let $\bfr=(r_1,\ldots,r_n)$ be a sequence of positive integers.
  The \emph{(generalized) cluster varieties} $\cX_\bfr=\cX_\bfr(\tilde B_{t_0})$ and $\cA_\bfr=\cA_\bfr(\tilde B_{t_0})$ are obtained by gluing the cluster charts $L^+_{\cX,\bfr;t}$, $L^+_{\cX,\bfr;t'}$ and $L^+_{\cA,\bfr;t}$, $L^+_{\cA,\bfr;t'}$ respectively, for $t,t'\in\TT_n$ joined by an edge labeled $k$, along the cluster mutations $\mu_{\cX,\bfr}^{k,\varepsilon}$ and $\mu_{\cA,\bfr}^{k,\varepsilon}$, where $\varepsilon=\varepsilon_{\bfr,k;t}$.
  That is, 
  \begin{equation}
    \label{eq:cluster varieties}
    \cX_\bfr=\bigcup_{t\in\TT_n} L^+_{\cX,\bfr;t}\qquad\text{ and }\qquad\cA_\bfr=\bigcup_{t\in\TT_n} L^+_{\cA,\bfr;t}
  \end{equation}
  with cluster charts glued by the mutations as above.
\end{definition}
\begin{remark}
  When $r_\ell=1$ for all $\ell$, the construction above gives rise to the ordinary cluster varieties \cite{FZ01,FG09a}.
\end{remark}

\begin{theorem}
  \cite{GSV10}
  The Poisson structures on the cluster charts $L^+_{\cX,\bfr;t}$ and $L^+_{\cA,\bfr;t}$ determined by the $D$-compatible pairs $(\tilde B_t,\Omega_t)$ glue to give a global Poisson structure on the cluster varieties $\cX_\bfr$ and $\cA_\bfr$.
  Moreover, the Poisson morphisms $\rho_t:L^+_{\cA,\bfr;t}\to L^+_{\cX,\bfr;t}$ glue to give a Poisson morphism $\rho:\cA_\bfr\to\cX_\bfr$.
\end{theorem}

The following result is the famous Laurent phenomenon for (generalized) cluster algebras.
\begin{theorem}
  \cite{FZ02,GSV16}
  Each cluster coordinate $x_{i;t}$ on the cluster chart $L^+_{\cA,\bfr;t}$ determines a global function on $\cA_\bfr$ which is given by a Laurent polynomial in the coordinates of any other cluster chart $L^+_{\cA,\bfr;t'}$.
\end{theorem}

This result can be made considerably more precise as follows, c.f.\ \cite{FZ07,NR16}.
Given a pair of vertices $t,t'\in\TT_n$, the composition of mutations from $L^+_{-,\bfr;t}$ to $L^+_{-,\bfr;t'}$ along the unique path from $t$ to $t'$ in $\TT_n$ (always taken with respect to the tropical sign from Definition~\ref{def:tropical signs}) gives rise to birational maps
\[\mu_{\cX,\bfr}^{t',t}:L^+_{\cX,\bfr;t}\to L^+_{\cX,\bfr;t'}\qquad\text{and}\qquad\mu_{\cA,\bfr}^{t',t}:L^+_{\cA,\bfr;t}\to L^+_{\cA,\bfr;t'}.\]
To understand the iterated mutations $\big(\mu_{\cX,\bfr}^{t,t_0}\big)^*(y_{k;t})$ and $\big(\mu_{\cA,\bfr}^{t,t_0}\big)^*(x_{j;t})$ we introduce the following combinatorial constructions.

The \emph{$\bfg$-vector} of $x_{j;t}$ is the integer vector $\sum\limits_{i=1}^m G_{ij;t}\bfe_i\in\ZZ^m$ defined recursively as follows.
We begin with the identity matrix $G_{ij;t_0}=\delta_{ij}$.
Then for vertices $t,t'\in\TT_n$ which are joined by an edge labeled $k$ we compute using the following recursion (recall that we mutate according to the tropical sign $\varepsilon_{\bfr,k;t}$):
\begin{equation}
  \label{eq:g-matrix mutation}
  G_{ij;t'}=
  \begin{cases}
    -G_{ik;t}+\sum\limits_{\ell=1}^m G_{i\ell;t}[-\varepsilon_{\bfr,k;t} B_{\ell k;t} r_k]_+ & \text{if $j=k$;}\\
    G_{ij;t} & \text{if $j\ne k$.}
  \end{cases}
\end{equation}
Next we introduce the \emph{$F$-polynomials} $F_{j,\bfr;t}\in\CC[u_1,\ldots,u_n]$ of $x_{j;t}$.
These are defined recursively by $F_{j,\bfr;t_0}=1$ for $1\le j\le m$ and via the following recursion when $t$ and $t'$ are joined by an edge labeled $k$ in $\TT_n$:
\begin{equation}
  \label{eq:F-polynomial mutation}
  F_{j,\bfr;t'}=
  \begin{cases}
    F_{k,\bfr;t}^{-1} \left(\prod_{\ell=1}^m F_{\ell,\bfr;t}^{[-\varepsilon_{\bfr,k;t} B_{\ell k;t} r_k]_+}\right) Z_k\left(\prod_{\ell=1}^n u_\ell^{\varepsilon_{\bfr,k;t} C_{\ell k;t}} F_{\ell,\bfr;t}^{\varepsilon_{\bfr,k;t} B_{\ell k;t}}\right) & \text{if $j=k$;}\\
    F_{j,\bfr;t} & \text{if $j\ne k$.}
  \end{cases}
\end{equation}
As promised, the $\bfc$-vectors, $\bfg$-vectors, and $F$-polynomials completely control the iterated mutations via the following \emph{separation of additions} formulae (c.f.\ \cite{FZ07,Nak15,NR16}):
\begin{align}
  \label{eq:separation of additions 1}
  \big(\mu_{\cX,\bfr}^{t,t_0}\big)^*(y_{\ell;t})&=\prod_{k=1}^n y_{k;t_0}^{C_{k\ell;t}} F_{k,\bfr;t}(y_{1;t_0},\ldots,y_{n;t_0})^{B_{k\ell;t}};\\
  \label{eq:separation of additions 2}
  \big(\mu_{\cA,\bfr}^{t,t_0}\big)^*(x_{j;t})&=\left(\prod_{i=1}^m x_{i;t_0}^{G_{ij;t}}\right) F_{j,\bfr;t}(\hat y_{1;t_0},\ldots,\hat y_{n;t_0}).
\end{align}
\begin{remark}
  The separation of additions formula for the cluster variables $\big(\mu_{\cA,\bfr}^{t,t_0}\big)^*(x_{j;t})$ usually has a denominator computed via a ``tropical evaluation'' of the $F$-polynomial $F_{j,\bfr;t}(\hat y_{1;t_0},\ldots,\hat y_{n;t_0})$.
  We have bypassed this by using $\bfg$-vectors from $\ZZ^m$ rather than the standard convention with $\bfg$-vectors in $\ZZ^n$.
  It is not hard to see by considering $x_{n+1;t_0}, \ldots, x_{m;t_0}$ simply as frozen cluster variables that our separation of additions formula reduces to the standard one in the case of geometric coefficients.
\end{remark}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Mutation of Groupoid Charts}
\label{sec:groupoid mutations}

We have presented thus far the Hamiltonian viewpoint of mutation for cluster charts. Our goal now is to lift these results to the level of the symplectic groupoids $\cG_\cX$, $\cB_\cX$, $\cD_\cX$ and $\cG_\cA$, $\cB_\cA$, $\cD_\cA$ integrating the log-canonical Poisson structures on $L^+_\cX\cong\RR_+^n$ and $L^+_\cA\cong\RR_+^m$ respectively as in Section~\ref{sec:local}. In general,
 a Poisson map does not induce a Lie algebroid morphism and hence does not integrate to a bona fide symplectic groupoid map. Instead a Poisson map induces a Lie algebroid comorphism. Following \cite{MR3089758}, we outline the procedure to lift Lie algebroid morphisms and comorphisms to Lie groupoid morphisms and comorphisms.
\begin{definition} \cite{Higgins1990, MR2157566, MR3089758}
 	Let $A_1$ be a Lie algebroid over $M_1$ and $A_2$ be a Lie algebroid over $M_2$ with anchor maps (see Definition~\ref{def:algeroid})
 	\[ \rho_1: A_1 \to TM_1, \qquad \rho_2: A_2 \to TM_2. \]
 	\begin{enumerate}
 		\item A Lie algebroid morphism is a bundle map $(\varphi, \Phi): (M_1, A_1) \to (M_2, A_2)$ such that the pullback of sections $\Phi^*: \Gamma(\wedge^\bullet A_2) \to \Gamma(\wedge^\bullet A_2)$ is a chain map of complexes.
 		\item A Lie algebroid comorphism is a bundle comorphism $(\varphi, \Psi)$ with
 			\[ \varphi: M_1 \to M_2,~ \Psi: \varphi^! A_2 = M_1 {\times_{M_2}} A_2 \to A_1 \]
 			such that $\varphi_* \circ \rho_1 \circ \Psi = \rho_2$. 
 	\end{enumerate}
\end{definition}
In principle, the graph of a comorphism $(\varphi, \Psi)$ from $A_1$ to $A_2$ is a subset of $\varphi^! A_2 = M_1 {\times_{M_2}} A_2 \times A_1$, but we will interpret the graph of $\Psi$ as a subset of $A_2 \times A_1$. Hence for a diffeomorphism $\varphi: M_1 \to M_2$, we have that $(\varphi, \Phi)$ is a Lie algebroid morphism if and only if $(\varphi^{-1}, \Phi^\vee)$ is a Lie algebroid comorphism where $\Phi^\vee$ is the dual bundle map of $\Phi$.
\begin{definition} \cite{MR2157566, MR3089758} \label{def:gpdcomor}
	Let $\cG_1 \rra M_1$ and $\cG_2 \rra M_2$ be Lie groupoids. (see Definition~\ref{def:groupoid})
	\begin{enumerate}
 		\item A Lie groupoid morphism from $\cG_1$ to $\cG_2$ is a map $(\varphi, \Phi): (M_1, \cG_1) \to (M_2, \cG_2)$ that is compatible with groupoid structures. 
 		\item A Lie groupoid comorphism from $\cG_1$ to $\cG_2$ is a base map $\varphi: M_1 \to M_2$ together with a map
 			\[ \Psi: M_1 {_\varphi \times_\alpha} \cG_2 \to \cG_1 \]
 		that is compatible with groupoid structures. (For details, see p.5 of \cite{MR3089758}.) 
 	\end{enumerate}
\end{definition}
Note the difference in convention: the source and target maps in Definition~\ref{def:gpdcomor} are switched comparing to the convention in \cite{MR3089758}. Like the Lie algebroids, we will interpret the graph of a Lie groupoid comorphism $\Psi$ from $\cG_1$ to $\cG_2$ as a subset of $\cG_2 \times \cG_1$.

In general, a Lie algebroid morphism from $A_1$ to $A_2$ integrates to a Lie groupoid morphism from $\cG_1$ to $\cG_2$ if $\cG_1$ is source-simply-connected; a Lie algebroid comorphism from $A_1$ to $A_2$ integrates to a Lie groupoid comorphism from $\cG_1$ to $\cG_2$ if $\cG_2$ is source-simply-connected and the algebroid comorphism is complete. Concretely, the graph of a morphism or a comorphism from $A_1$ to $A_2$ is a Lie subalgebroid of $A_1 \times A_2$, and the exponential map $A_1 \times A_2 \to \cG_1 \times \cG_2$ integrates the graph to a Lie subgroupoid of $\cG_1 \times \cG_2$ which happens to be the graph of a morphism or a comorphism from $\cG_1$ to $\cG_2$.

The Poisson map $\varphi: (M_1, \pi_1) \to (M_2, \pi_2)$ induces the Lie algebroid comorphism $\varphi^*: \varphi^!  T^*_{\pi_2} M_2 \to T^*_{\pi_1} M_1$, which means that the following diagram commutes \cite{Higgins1990}.
\begin{equation} 
	\xymatrix{
		T^*_{\pi_1} M_1 \ar[d]^{\pi_1^\flat} & \varphi^! T^*_{\pi_2}  M_2 \ar[l]_{\varphi^*} \ar[r]& T^*_{\pi_2} M_2  \ar[d]^{\pi_2^\flat} \\
		T M_1 \ar[rr]^{\varphi_*} & & TM_2
	}
\end{equation}
This comorphsim $\varphi^*$ is complete if for a complete Hamiltonian vector field $X_f$ with $f \in \cO_{M_2}$, the pullback Hamiltonian vector field $X_{\varphi^*f}$ is also complete. That is, a Poisson map $\varphi: (M_1, \pi_1) \to (M_2, \pi_2)$ lifts to a symplectic groupoid comorphism from $(\cG_1, \omega_1)$ to $(\cG_2, \omega_2)$ if $\cG_2$ is source-simply-connected and $\varphi$ is complete. In fact, the graph of $\varphi$ which is a coisotropic submanifold of $(M_1 \times M_2, \pi_1 \oplus -\pi_2)$ integrates to a Lagrangian subgroupoid of $(\cG_1 \times \cG_2, \omega_1 \oplus -\omega_2)$ \cite{MR2063018}.

If the Poisson map $\varphi: (M, \pi) \to (M, \pi)$ is a diffeomorphism, then $\varphi$ induces both a Lie algebroid morphism and a Lie algebroid comorphism, which can be lifted to either symplectic groupoid morphism or a symplectic groupoid comorphism. Following \cite{MR2504211}, we outline a method to lift the Hamiltonian Poisson maps to Hamiltonian symplectic groupoid morphisms.
In general, Poisson vector fields are lifted to multiplicative Hamiltonian vector fields. For the Hamiltonian vector field $X_f \in \cT_M$ of $f \in \cO_M$, if $(\cG, \omega) \rra (M, \pi)$ is a symplectic groupoid, then $X_f$ is lifted to the Hamiltonian vector field $X_F \in \cT_\cG$ where $F := \alpha^*f - \beta^*f$.
Indeed, $F \in \cO_\cG$ is multiplicative since $F = \partial f$, where $\partial$ is the groupoid coboundary operator \eqref{eq:gpdcob}, and $\omega$ is multiplicative by definition, so the Hamiltonian vector field $X_F = \iota_{dF}\omega^{-1}$ is multiplicative. It follows that $X_F$ preserves the symplectic groupoid structures of $(\cG,\omega)$; and the time-$t$ flow $\varphi^t_f: (M, \pi) \to (M, \pi)$ of $X_f$ is lifted to the time-$t$ flow $\varphi^t_F: (\cG, \omega) \to (\cG, \omega)$ of $X_F$.

Here is an outline for the rest of the section.
\begin{enumerate}
	\item We lift the Poisson ensemble map $\rho:L_\cA\to L_\cX$ \eqref{eq:ensemble} to symplectic groupoid comorphisms. When the exchange matrix is square, $\rho$ is a diffeomorphism, and the graph of each groupoid comophism also defines a groupoid morphism.
	\item We lift the Poisson maps $\varphi_{\cX,\bfr}^t$ and $\varphi_{\cA,\bfr}^t$ in Corollary~\ref{cor:time-one flows} to symplectic groupoid morphisms using their Hamiltonian nature. We also show that the Lie functor maps the graph of groupoid morphism to the graph of the induced algebroid comorphism.
	\item We lift the Poisson maps $\tau_{\cX,\bfr}^{k,\varepsilon}$ and $\tau_{\cA,\bfr}^{k,\varepsilon}$ in Lemma~\ref{le:tropical cluster transformations} to groupoid comorphisms and show that they can also be interpreted as groupoid morphisms.
\end{enumerate}

We begin working in the setting 
\begin{align*}
  \cG_\cX&\cong\RR^n\times L^+_\cX,& \cB_\cX&\cong\RR^n\times L^+_\cX,& \cD_\cX&\cong\RR_+^n\times L^+_\cX,\\
  \cG_\cA&\cong\RR^m\times L^+_\cA,& \cB_\cA&\cong\RR^m\times L^+_\cA,& \cD_\cA&\cong\RR_+^m\times L^+_\cA.
\end{align*}
We introduce coordinates on these groupoids given as follows:
\begin{itemize}
  \item $\cG_\cX$ has coordinates $(\bfq,\bfy)=(q_1,\ldots,q_n,y_1,\ldots,y_n)$; 
  \item $\cB_\cX$ has coordinates $(\bfv,\bfy)=(v_1,\ldots,v_n,y_1,\ldots,y_n)$;
  \item $\cD_\cX$ has coordinates $(\bft,\bfy)=(t_1,\ldots,t_n,y_1,\ldots,y_n)$; 
  \item $\cG_\cA$ has coordinates $(\bfp,\bfx)=(p_1,\ldots,p_m,x_1,\ldots,x_m)$; 
  \item $\cB_\cA$ has coordinates $(\bfu,\bfx)=(u_1,\ldots,u_m,x_1,\ldots,x_m)$;
  \item $\cD_\cA$ has coordinates $(\bfs,\bfx)=(s_1,\ldots,s_m,x_1,\ldots,x_m)$.
\end{itemize}
The symplectic groupoid structure on $\cG_\cA \rra L^+_\cA$ is the same as in Theorem~\ref{thm:PoiSpLogC}, while the symplectic groupoid structure on $\cD_\cA \rra L^+_\cA$ is the same as in Theorem~\ref{thm:SymDBLoc}, and the symplectic groupoid structure on $\cB_\cA \rra L^+_\cA$ is the same as in Theorem~\ref{th:blowup groupoid}.
The symplectic groupoid structures over $L^+_\cX$ mimic the structures in the theorems above by replacing $x_i$ with $y_k$ and $\Omega_{ij}$ with $d_kB_{k\ell}$ together with the corresponding replacements of coordinates $p_j$ with $q_\ell$, $u_j$ with $v_\ell$, and $s_j$ with $t_\ell$.

As above, for a sequence $\bfr=(r_1,\ldots,r_n)$ of positive integers, we introduce the symplectic groupoids 
\begin{align*}
  \cG_{\cX,\bfr}&=\cG_\cX\times T^*L_\bfr,& \cB_{\cX,\bfr}&=\cB_\cX\times T^*L_\bfr,& \cD_{\cX,\bfr}&=\cD_\cX\times T^*L_\bfr,\\
  \cG_{\cA,\bfr}&=\cG_\cA\times T^*L_\bfr,& \cB_{\cA,\bfr}&=\cB_\cA\times T^*L_\bfr,& \cD_{\cA,\bfr}&=\cD_\cA\times T^*L_\bfr,
\end{align*}
where each cotangent bundle $T^*L_\bfr$ is equipped with its canonical symplectic structure and we write $b_{\ell,j}$ for the cotangent coordinate associated to the coordinate $z_{\ell,j}$ of $L_\bfr$.
Translating this symplectic structure into a Poisson bracket on $T^*L_\bfr$, we have
\begin{equation}
  \label{eq:canonical brackets}
  \{z_{k,i},z_{\ell,j}\}_\bfr=0,\qquad\{z_{k,i},b_{\ell,j}\}_\bfr=\delta_{k\ell}\delta_{ij},\qquad\{b_{k,i},b_{\ell,j}\}_\bfr=0.
\end{equation}
For simplicity of notation, we will write $\alpha$ and $\beta$ for the source and target maps of all groupoids; this slight abuse of notation should not lead to any confusion.

%Write $\kappa_\cX:\cG_\cX\to\cD_\cX$ and $\kappa_\cA:\cG_\cA\to\cD_\cA$ for the groupoid covering maps from the source-simply connected symplectic groupoids to the symplectic doubles, these are given on fiber coordinates by
%\[\kappa_\cX^*(t_\ell)=e^{q_\ell y_\ell}\quad\text{and}\quad\kappa_\cA^*(s_j)=e^{p_j x_j}.\]

\begin{lemma} \label{lemma:ensemblegpd}
  The Poisson ensemble map $\rho:L^+_\cA\to L^+_\cX$ \eqref{eq:ensemble} lifts to the following comorphisms of symplectic groupoids.
	\begin{enumerate}
		\item $(\rho, P)$ from $\cG_\cA$ to $\cG_\cX$ such that
		\begin{equation} \label{eq:ensembleG}
			P^*\left(p_i\right) = \frac{1}{x_i}\sum_{k=1}^n B_{ik} \hat{y}_k q_k
		\end{equation}
		\item $(\rho, P)$ from $\cB_\cA$ to $\cB_\cX$ such that
		\[
			P^*\left(u_i\right) = \frac{\prod_{k=1}^n (v_k\hat{y}_k+1)^{B_{ik}} - 1}{x_i}
		\]
		\item $(\rho, P)$ from $\cD_\cA$ to $\cD_\cX$ such that
		\[
			P^*\left(s_i \right) = \prod_{k=1}^n t_k^{B_{ik}}
		\]
	\end{enumerate}
\end{lemma}
\begin{proof}
	We prove \eqref{eq:ensembleG} and the cases for $\cB$ and $\cD$ follows from \eqref{eq:LGpdCD}. Taking derivative of
	\[
		\rho:L^+_\cA\to L^+_\cX,\qquad y_k = \prod_{i=1}^m x_i^{B_{ik}},
	\]
we obtain the pullback map
	\begin{align*}
		\rho^*:~ & \Omega^1(L^+_\cX) \to \Omega^1(L^+_\cA), \\
		& dy_k = \sum_{i=1}^m \frac{B_{ik}}{x_i} \hat{y}_k dx_i, \qquad k = 1, \ldots, n, \\
		& \sum_{k=1}^n q_k dy_k = \sum_{i=1}^m \frac{1}{x_i} \sum_{k=1}^n B_{ik} \hat{y}_k q_k dx_i,
	\end{align*}
or as a bundle map
	\begin{align*}
		\rho^*:~ & \rho^! T^*_{\pi_\cX} L^+_\cX \to T^*_{\pi_\cA} L^+_\cA,  \\
		& p_i = \frac{1}{x_i} \sum_{k=1}^n B_{ik} \hat{y}_k q_k, \qquad i = 1, \ldots, m.
	\end{align*}
The graph of the Lie algebroid comorphism $\rho^*$ from $T^*_{\pi_\cA} L^+_\cA$ to $T^*_{\pi_\cX} L^+_\cX$ is defined by
	\[
		x_i p_i =  \sum_{k=1}^n B_{ik} y_k q_k, \qquad i = 1, \ldots, m.
	\]
By Lemma~\ref{lemma:PoisSp} and Corollary~\ref{cor:exp}, both $x_i p_i$ and $y_k q_k$ are invariant under the exponential map, so \eqref{eq:ensembleG} follows.
\end{proof}

\begin{remark}
  \label{rmk:source-connected lift}
  When $m=n$, i.e.\ the map $\rho:L_\cA\to L_\cX$ is an isomorphism, the Poisson ensemble map actually lifts to true morphisms of symplectic groupoids $\rho:\cG_\cA\to\cG_\cX$, $\rho:\cB_\cA\to\cB_\cX$, and $\rho:\cD_\cA\to\cD_\cX$ given on fiber coordinates by 
  \begin{align*}
    \rho^*(q_\ell)&=-(d_\ell\hat y_\ell)^{-1}\sum\limits_{j=1}^m\Omega_{j\ell}x_jp_j;\\
    \rho^*(v_\ell)&=\prod\limits_{j=1}^m (u_j x_j + 1)^{-d_\ell^{-1}\Omega_{\ell j}};\\
    \rho^*(t_\ell)&=\prod\limits_{j=1}^m s_j^{-d_\ell^{-1}\Omega_{\ell j}}.\\
  \end{align*}
  Observe that care must me taken when considering the fractional exponents above, however the maps are in fact well defined.
  Indeed, a morphism of groupoids must take the identity image to the identity image.
  With this observation in mind, it is easy to see that the maps $\rho:\cB_\cA\to\cB_\cX$ and $\rho:\cD_\cA\to\cD_\cX$ become well-defined covering maps on the fibers.

	Note that in \cite{FG09c}, the last formula was given with the coordinates $t_\ell^{d_\ell}$ to avoid the fractional exponents.
  %When $L_\cX=\RR_+^n$ and $L_\cA=\RR_+^m$, the Poisson ensemble map $\rho:L_\cA\to L_\cX$ also lifts to a morphism of symplectic groupoids $\bar\rho:\cD_\cA\to\cD_\cX$ given on fiber coordinates by 
  %\footnote{This might actually require $m=n$.}
  %\[\bar\rho^*(t_\ell)=\prod\limits_{j=1}^m s_j^{-d_\ell^{-1}\Omega_{\ell j}}.\]
  %Indeed, when $L_\cX=(\CC^\times)^n$ and $L_\cA=(\CC^\times)^m$, the symplectic double $\cD_\cA$ is not source-simply-connected and the Poisson map $\rho$ does not lift to a well-defined groupoid map $\bar\rho$.
\end{remark}


%To lift the Poisson maps $\mu_{\cX,\bfr}^{k,\varepsilon}:L_{\cX,\bfr}\to L'_{\cX,\bfr}$ and $\mu_{\cA,\bfr}^{k,\varepsilon}:L_{\cA,\bfr}\to L'_{\cA,\bfr}$ to groupoid maps, we use their Hamiltonian nature.
%In general, Poisson vector fields (in particular, Hamiltonian vector fields) are lifted to multiplicative Hamiltonian vector fields \cite{MR2504211}.
%More precisely, if $(\cG, \omega) \rra (M, \pi)$ is a symplectic groupoid and $X_f \in \cT_M$ is the Hamiltonian vector field of $f \in \cO_M$, then $X_f$ is lifted to the Hamiltonian vector field $X_{\tilde{f}} \in \cT_\cG$, where $\tilde{f} := \alpha^*f - \beta^*f$.
%Indeed, $\tilde{f} \in \cO_\cG$ is multiplicative since $\tilde{f} = \partial f$, where $\partial$ is the groupoid coboundary operator \eqref{eq:gpdcob}, and $\omega$ is multiplicative by definition, so the Hamiltonian vector field $X_{\tilde{f}} = \iota_{d\tilde{f}}\omega^{-1}$ is multiplicative.
%Consequently, the flow of $X_{\tilde{f}}$ preserves the symplectic groupoid structure on $(\cG,\omega)$.

%As the first step, we explicitly compute the Poisson structures on the symplectic groupoids $\cG_\cX$, $\cD_\cX$, $\cG_\cA$, and $\cD_\cA$.
%Note that on $T^*L_\bfr$ we have the canonical Poisson structure 
%\begin{equation}
%  \label{eq:canonical brackets}
%  \{z_{k,i},z_{\ell,j}\}_\bfr=0,\qquad\{z_{k,i},b_{\ell,j}\}_\bfr=\delta_{k\ell}\delta_{ij},\qquad\{b_{k,i},b_{\ell,j}\}_\bfr=0.
%\end{equation}
%\begin{lemma}
%  \label{le:groupoid Poisson structures}
%  \begin{align}
%    \pi_{\cG_\cX}:=\omega_{\cG_\cX}^{-1}&=\sum_{k} \frac{\partial}{\partial q_k} \wedge \frac{\partial}{\partial y_k} - \sum_{k, \ell} d_kB_{k\ell}q_k y_\ell \frac{\partial}{\partial q_k} \wedge \frac{\partial}{\partial y_\ell}\\
%    \nonumber &\quad+\sum_{\ell < k} d_kB_{k\ell}q_kq_\ell \frac{\partial}{\partial q_k} \wedge \frac{\partial}{\partial q_\ell}
%+\sum_{\ell < k} d_kB_{k\ell}y_ky_\ell \frac{\partial}{\partial y_k} \wedge \frac{\partial}{\partial y_\ell};\\
%    \pi_{\cD_\cX}:=\omega_{\cD_\cX}^{-1}&=\sum_{k} t_ky_k\frac{\partial}{\partial t_k} \wedge \frac{\partial}{\partial y_k}+\sum_{\ell < k} d_kB_{k\ell}y_ky_\ell \frac{\partial}{\partial y_k} \wedge \frac{\partial}{\partial y_\ell};\\
%    \pi_{\cG_\cA}:=\omega_{\cG_\cA}^{-1}&=\sum_{i} \frac{\partial}{\partial p_i} \wedge \frac{\partial}{\partial x_i} - \sum_{i, j} \Omega_{ij}p_i x_j \frac{\partial}{\partial p_i} \wedge \frac{\partial}{\partial x_j}\\
%    \nonumber &\quad+\sum_{j < i} \Omega_{ij}p_ip_j \frac{\partial}{\partial p_i} \wedge \frac{\partial}{\partial p_j}
%		    +\sum_{j < i} \Omega_{ij}x_ix_j \frac{\partial}{\partial x_i} \wedge \frac{\partial}{\partial x_j};\\
%    \pi_{\cD_\cA}:=\omega_{\cD_\cA}^{-1}&=\sum_{i} s_ix_i\frac{\partial}{\partial s_i} \wedge \frac{\partial}{\partial x_i}+\sum_{j < i} \Omega_{ij}x_ix_j \frac{\partial}{\partial x_i} \wedge \frac{\partial}{\partial x_j}.
%  \end{align}
%\end{lemma}
%\begin{proof}
%  We prove these statements only for the groupoids over $L_\cA$, the corresponding statements over $L_\cX$ follow by a simple change of notation.
%
%  Choosing the standard frames: $\{dx_i, dp_i\}_i$ for $T^*\cG_\cA$ and $\left\{\frac{\partial}{\partial x_i}, \frac{\partial}{\partial p_i}\right\}_i$ for $T\cG_\cA$, the bundle map $\pi_{\cG_\cA}^\flat: T^*\cG_\cA \to T\cG_\cA, \quad \alpha \mapsto \pi_{\cG_\cA}(\alpha, \cdot)$ is given by
%  \begin{align*}
%    \pi_{\cG_\cA}^\flat: &~ dx_i \mapsto -\frac{\partial}{\partial p_i} - \sum_{j} \Omega_{ij} x_i p_j \frac{\partial}{\partial p_j}+ \sum_{j} \Omega_{ij} x_i x_j \frac{\partial}{\partial x_j}, \\
%    &~ dp_i \mapsto \frac{\partial}{\partial x_i} - \sum_{j} \Omega_{ij} p_i x_j \frac{\partial}{\partial x_j}+ \sum_{j} \Omega_{ij} p_i p_j \frac{\partial}{\partial p_j},
%  \end{align*}
%  and for the symplectic structure $\omega_{\cG_\cA}$ as in \eqref{eq:2-formGA}, the bundle map $\omega_{\cG_\cA}^\sharp: T\cG_\cA \to T^*\cG_\cA, \quad v \mapsto \omega_{\cG_\cA}(v, \cdot)$ is given by
%  \begin{align*}
%    \omega_{\cG_\cA}^\sharp: &~ \frac{\partial}{\partial x_i} \mapsto dp_i + \sum_{j} \Omega_{ij} p_i x_j dp_j + \sum_{j} \Omega_{ij} p_i p_j dx_j, \\
%    &~ \frac{\partial}{\partial p_i} \mapsto -dx_i + \sum_{j} \Omega_{ij} x_i p_j dx_j + \sum_{j} \Omega_{ij} x_i x_j dp_j.
%  \end{align*}
%
%
%Similarly, choosing the standard frames: $\{dx_i, ds_i\}_i$ for $T^*\cD_\cA$ and $\left\{\frac{\partial}{\partial x_i}, \frac{\partial}{\partial s_i}\right\}_i$ for $T\cD_\cA$, the bundle map $\pi_{\cD_\cA}^\flat: T^*\cD_\cA \to T\cD_\cA, \quad \alpha \mapsto \pi_{\cD_\cA}(\alpha, \cdot)$ is given by
%  \begin{align*}
%    \pi_{\cD_\cA}^\flat: &~ dx_i \mapsto -x_i s_i \frac{\partial}{\partial s_i} + \sum_{j} \Omega_{ij} x_i x_j \frac{\partial}{\partial x_j}, \\
%    &~ ds_i \mapsto s_i x_i \frac{\partial}{\partial x_i},
%  \end{align*}
%  and for the symplectic structure $\omega_{\cD_\cA}$ as in \eqref{eq:2-formGX}, the bundle map $\omega_{\cD_\cA}^\sharp: T\cD_\cA \to T^*\cD_\cA, \quad v \mapsto \omega_{\cD_\cA}(v, \cdot)$ is given by
%  \begin{align*}
%    \omega_{\cD_\cA}^\sharp: &~ \frac{\partial}{\partial x_i} \mapsto \frac{1}{x_i s_i} ds_i, \\
%    &~ \frac{\partial}{\partial s_i} \mapsto -\frac{1}{x_i s_i} dx_i + \sum_{j} \frac{\Omega_{ij}}{s_i s_j} ds_j.
%  \end{align*}
%
%  We leave it to the reader to check that $\pi_{\cG_\cA}^\flat$ (resp. $\pi_{\cD_\cA}^\flat$) and $\omega_{\cG_\cA}^\sharp$ (resp. $\omega_{\cD_\cA}^\sharp$) are inverse to each other.
%\end{proof}

Next, we lift the Hamiltonian Poisson maps $\varphi_{\cX,\bfr}^t$ and $\varphi_{\cA,\bfr}^t$ in Corollary~\ref{cor:time-one flows}. Using appropriate source and target maps, define functions $H_{\cX,\bfr}^{k,\varepsilon}:=\alpha^* h_{\cX,\bfr}^{k,\varepsilon}-\beta^* h_{\cX,\bfr}^{k,\varepsilon}$ on the groupoids $\cG_\cX$, $\cB_\cX$, $\cD_\cX$ and functions $H_{\cA,\bfr}^{k,\varepsilon}:=\alpha^* h_{\cA,\bfr}^{k,\varepsilon}-\beta^* h_{\cA,\bfr}^{k,\varepsilon}$ on the groupoids $\cG_\cA$, $\cB_\cA$, $\cD_\cA$.
More explicitly, these Hamiltonian functions are given by the following analogues of \eqref{eq:hamiltonians}:
\begin{align}
  \label{eq:X hamiltonian}
  H_{\cX,\bfr}^{k,\varepsilon}&:=\frac{\varepsilon}{d_k}\int_{\alpha^*(y_k^\varepsilon)}^{\beta^*(y_k^\varepsilon)} \frac{\log\big(Z_k(u)\big)}{u}du;\\
  \label{eq:A hamiltonian}
  H_{\cA,\bfr}^{k,\varepsilon}&:=\frac{\varepsilon}{d_k}\int_{\alpha^*(\hat y_k^\varepsilon)}^{\beta^*(\hat y_k^\varepsilon)} \frac{\log\big(Z_k(u)\big)}{u}du.
\end{align}
Note that, although we use the same symbols for the Hamiltonian functions on each groupoid, it will be clear from context which source and target map should be used in their definition.

Write $X_{\cX,\bfr}^{k,\varepsilon}$ and $X_{\cA,\bfr}^{k,\varepsilon}$ for the Hamiltonian vector fields associated to the functions $H_{\cX,\bfr}^{k,\varepsilon}$ and $H_{\cA,\bfr}^{k,\varepsilon}$ on the groupoids $\cG_\cX$, $\cB_\cX$, $\cD_\cX$ and $\cG_\cA$, $\cB_\cA$, $\cD_\cA$ respectively, i.e.\ they are the vector fields naturally associated to the derivations $\{H_{\cX,\bfr}^{k,\varepsilon},\cdot\}$ and $\{H_{\cA,\bfr}^{k,\varepsilon},\cdot\}$ on the appropriate groupoids.
\begin{lemma}
  For $1\le k\le n$ and $\varepsilon\in\{\pm1\}$, the Hamiltonian vector fields $X_{\cX,\bfr}^{k,\varepsilon}$ determine the following dynamics on the symplectic groupoids $\cG_{\cX,\bfr}$, $\cB_{\cX,\bfr}$, $\cD_{\cX,\bfr}$:
  \begin{align}
    \dot q_\ell&=\{H_{\cX,\bfr}^{k,\varepsilon},q_\ell\}_{\cG_\cX}=-\frac{\delta_{k\ell}}{d_ky_k}\log\left(\frac{Z_k\left(y_k^\varepsilon e^{\varepsilon\sum_{\ell'=1}^n d_{\ell'} B_{\ell' k}q_{\ell'} y_{\ell'}}\right)}{Z_k(y_k^\varepsilon)}\right)+B_{k\ell}\log\big(Z_k(y_k^\varepsilon)\big)q_\ell;\\
    \dot v_\ell&=\{H_{\cX,\bfr}^{k,\varepsilon},v_\ell\}_{\cB_\cX}=-\frac{\delta_{k\ell}}{d_ky_k}\log\left(\frac{Z_k\left(y_k^\varepsilon \prod_{\ell'=1}^n (1+v_{\ell'}y_{\ell'})^{\varepsilon d_{\ell'} B_{\ell' k}}\right)}{Z_k(y_k^\varepsilon)}\right)(v_ky_k+1)+B_{k\ell}\log\big(Z_k(y_k^\varepsilon)\big)v_\ell;\\
    \dot t_\ell&=\{H_{\cX,\bfr}^{k,\varepsilon},t_\ell\}_{\cD_\cX}=-\frac{\delta_{k\ell}}{d_k}\log\left(\frac{Z_k\left(y_k^\varepsilon \prod_{\ell'=1}^nt_{\ell'}^{\varepsilon d_{\ell'} B_{\ell' k}}\right)}{Z_k(y_k^\varepsilon)}\right)t_k;
  \end{align}
  and the Hamiltonian vector fields $X_{\cA,\bfr}^{k,\varepsilon}$ determine the following dynamics on the symplectic groupoids $\cG_{\cA,\bfr}$, $\cB_{\cA,\bfr}$, $\cD_{\cA,\bfr}$:
  \begin{align}
    \label{eq:p dot}
    \dot p_j&=\{H_{\cA,\bfr}^{k,\varepsilon},p_j\}_{\cG_\cA}=-\frac{B_{jk}}{d_kx_j}\log\left(\frac{Z_k\left(\hat y_k^\varepsilon e^{-\varepsilon d_kp_kx_k}\right)}{Z_k(\hat y_k^\varepsilon)}\right)+\delta_{jk}\log\big(Z_k(\hat y_k^\varepsilon)\big)p_k;\\
    \label{eq:u dot}
    \dot u_j&=\{H_{\cA,\bfr}^{k,\varepsilon},u_j\}_{\cB_\cA}=-\frac{B_{jk}}{d_kx_j}\log\left(\frac{Z_k\left(\hat y_k^\varepsilon (1+u_kx_k)^{-\varepsilon d_k}\right)}{Z_k(\hat y_k^\varepsilon)}\right)(u_jx_j+1)+\delta_{jk}\log\big(Z_k(\hat y_k^\varepsilon)\big)u_k\\
    \label{eq:s dot}
    \dot s_j&=\{H_{\cA,\bfr}^{k,\varepsilon},s_j\}_{\cD_\cA}=-\frac{B_{jk}}{d_k}\log\left(\frac{Z_k\left(\hat y_k^\varepsilon s_k^{-\varepsilon d_k}\right)}{Z_k(\hat y_k^\varepsilon)}\right)s_j.
  \end{align}
  The coordinates $b_{\ell,j}$ on $T^*L_\bfr$ evolve according to
  \begin{equation}
    \label{eq:b dot}
    \dot b_{\ell,j}=\frac{\varepsilon}{d_k}\int_*^* \frac{u^{j-1}}{Z_k(u)}du,
  \end{equation}
  where the bounds of integration are respectively those from equations \eqref{eq:X hamiltonian} or \eqref{eq:A hamiltonian}.
\end{lemma}
\begin{proof}
  We prove equation \eqref{eq:p dot}, leaving the others as an exercise for the reader.
  By Theorem~\ref{thm:PoiSpLogC}, we have $\{x_i,p_j\}_{\cG_\cA}=-\delta_{ij}-\Omega_{ij}x_ip_j$ and $\{p_i,p_j\}_{\cG_\cA}=\Omega_{ij}p_ip_j$ so that
  \[\{\hat y_k,p_j\}_{\cG_\cA}=\sum_{i=1}^m B_{ik}\frac{\hat y_k}{x_i}\{x_i,p_j\}_{\cG_\cA}=-B_{jk}\frac{\hat y_k}{x_j}-\delta_{jk}d_k\hat y_kp_k\]
  and
  \[\{e^{-d_kp_kx_k},p_j\}_{\cG_\cA}=\delta_{jk}d_kp_ke^{-d_kp_kx_k}.\]
  Now equation~\eqref{eq:p dot} follows by applying the chain rule for the derivation $\{\cdot,p_j\}_{\cG_\cA}$.
\end{proof}

Consider the time-$t$ flows, all denoted $\varphi_{\cX,\bfr}^t$, of the vector fields $X_{\cX,\bfr}^{k,\varepsilon}$ on the groupoids $\cG_{\cX,\bfr}$, $\cB_{\cX,\bfr}$, $\cD_{\cX,\bfr}$ and the time-$t$ flows, all denoted $\varphi_{\cA,\bfr}^t$, of the vector fields $X_{\cA,\bfr}^{k,\varepsilon}$ on the groupoids $\cG_{\cA,\bfr}$, $\cB_{\cA,\bfr}$, $\cD_{\cA,\bfr}$.
\begin{corollary}
  \label{cor:groupoid hamiltonian flows}
  For $1\le k\le n$ and $\varepsilon\in\{\pm1\}$, the Hamiltonian flow $\varphi_{\cX,\bfr}^t: L^+_{\cX,\bfr} \to L^+_{\cX,\bfr}$ in Corollary~\ref{cor:time-one flows} is lifted to the multiplicative Hamiltonian flows $\varphi_{\cX,\bfr}^t: \cG_{\cX,\bfr} \to \cG_{\cX,\bfr}$, $\varphi_{\cX,\bfr}^t: \cB_{\cX,\bfr} \to \cB_{\cX,\bfr}$, $\varphi_{\cX,\bfr}^t: \cD_{\cX,\bfr} \to \cD_{\cX,\bfr}$, given on coordinates by
  \begin{align*}
    (\varphi_{\cX,\bfr}^t)^*(q_\ell y_\ell)&=q_\ell y_\ell-t\frac{\delta_{k\ell}}{d_k}\log\left(\frac{Z_k\left(y_k^\varepsilon e^{\varepsilon\sum_{\ell'=1}^n d_{\ell'} B_{\ell' k}q_{\ell'} y_{\ell'}}\right)}{Z_k(y_k^\varepsilon)}\right),\\
    (\varphi_{\cX,\bfr}^t)^*(v_\ell y_\ell)&=\left(\frac{Z_k\left(y_k^\varepsilon \prod_{\ell'=1}^n (v_{\ell'} y_{\ell'} + 1)^{\varepsilon d_{\ell'} B_{\ell' k}}\right)}{Z_k(y_k^\varepsilon)}\right)^{-t\frac{\delta_{k\ell}}{d_k}}(v_\ell y_\ell+1)-1,\\
    (\varphi_{\cX,\bfr}^t)^*(t_\ell)&=\left(\frac{Z_k\left(y_k^\varepsilon \prod_{\ell'=1}^n t_{\ell'}^{\varepsilon d_{\ell'} B_{\ell' k}}\right)}{Z_k(y_k^\varepsilon)}\right)^{-t\delta_{k\ell}/d_k}t_\ell;
  \end{align*}
  and the Hamiltonian flow $\varphi_{\cA,\bfr}^t: L^+_{\cA,\bfr} \to L^+_{\cA,\bfr}$ in Corollary~\ref{cor:time-one flows} is lifted to the multiplicative Hamiltonian flows $\varphi_{\cA,\bfr}^t: \cG_{\cA,\bfr} \to \cG_{\cA,\bfr}$, $\varphi_{\cA,\bfr}^t: \cB_{\cA,\bfr} \to \cB_{\cA,\bfr}$, $\varphi_{\cA,\bfr}^t: \cD_{\cA,\bfr} \to \cD_{\cA,\bfr}$, given on coordinates by
  \begin{align*}
    (\varphi_{\cA,\bfr}^t)^*(p_jx_j)&=p_jx_j-t\frac{B_{jk}}{d_k}\log\left(\frac{Z_k\left(\hat y_k^\varepsilon e^{-\varepsilon d_kp_kx_k}\right)}{Z_k(\hat y_k^\varepsilon)}\right), \\
    (\varphi_{\cA,\bfr}^t)^*(u_jx_j)&=\left(\frac{Z_k\left(\hat y_k^\varepsilon (u_kx_k+1)^{-\varepsilon d_k}\right)}{Z_k(\hat y_k^\varepsilon)}\right)^{-t\frac{B_{jk}}{d_k}}(u_jx_j+1)-1, \\
    (\varphi_{\cA,\bfr}^t)^*(s_j)&=\left(\frac{Z_k\left(\hat y_k^\varepsilon s_k^{-\varepsilon d_k}\right)}{Z_k(\hat y_k^\varepsilon)}\right)^{-tB_{jk}/d_k}s_j.
  \end{align*}
  Each of the Hamiltonian flows above transform the coordinates $b_{\ell,j}$ on $T^*L_\bfr$ according to
  \begin{equation*}
    (\varphi_{-,\bfr}^t)^*(b_{\ell,j})=b_{\ell,j}+\frac{\varepsilon}{d_k}\int_*^* \frac{u^{j-1}}{Z_k(u)}du,
  \end{equation*}
  where the bounds of integration are respectively those from equations \eqref{eq:X hamiltonian} or \eqref{eq:A hamiltonian}.
\end{corollary}
\begin{proof}
  To see this, it suffices to make the following observations:
  \begin{itemize}
    \item The quantities $y_k$, $e^{\varepsilon\sum_{\ell'=1}^n d_{\ell'} B_{\ell' k}q_{\ell'} y_{\ell'}}$, $\prod_{\ell'=1}^n (v_{\ell'}y_{\ell'}+1)^{\varepsilon d_{\ell'} B_{\ell' k}}$, and $\prod_{\ell'=1}^nt_{\ell'}^{\varepsilon d_{\ell'} B_{\ell' k}}$ are conserved under the flow of the vector fields $X_{\cX,\bfr}^{k,\varepsilon}$.
      It follows that $\frac{d}{dt}(q_\ell y_\ell)$ is a constant, $\frac{d}{dt}(v_\ell y_\ell)$ is a constant multiple of $v_\ell y_\ell+1$, and $\frac{d}{dt}(t_\ell)$ is a constant multiple of $t_\ell$.
    \item The quantities $\hat y_k$, $e^{-\varepsilon d_kp_kx_k}$, $(u_kx_k+1)^{-\varepsilon d_k}$, and $s_k^{-\varepsilon d_k}$ are conserved under the flow of the vector fields $X_{\cA,\bfr}^{k,\varepsilon}\in\cT_{\cG_{\cA,\bfr}}$.
      It follows that $\frac{d}{dt}(p_jx_j)$ is a constant, $\frac{d}{dt}(u_j x_j)$ is a constant multiple of $u_j x_j+1$, and $\frac{d}{dt}(s_j)$ is a constant multiple of $s_j$.
  \end{itemize}
\end{proof}
\begin{remark}
  While the formulae for the flows above were defined when $L^+_{\cX,\bfr}\cong\RR_+^n$ and $L^+_{\cA,\bfr}\cong\RR_+^m$, the formulae for the time-one flows on $\cG_{\cX,\bfr}$ and $\cG_{\cA,\bfr}$ can be applied equally well in the settings $L^+_{\cX,\bfr}\cong(\CC^\times)^n\times\prod_{\ell=1}^n \CC^{r_\ell-1}$ and $L^+_{\cA,\bfr}\cong(\CC^\times)^m\times\prod_{\ell=1}^n \CC^{r_\ell-1}$.
  Indeed, although $\log(-)$ is multivalued as a function on $\CC^\times$, the functions $(\varphi_{\cX,\bfr}^1)^*(q_\ell y_\ell)$ and $(\varphi_{\cA,\bfr}^1)^*(p_jx_j)$ are well-defined on $\cG_{\cX,\bfr}$ and $\cG_{\cA,\bfr}$ respectively.
  To see this, note that $\varphi_{\cX,\bfr}^1$ and $\varphi_{\cA,\bfr}^1$ are groupoid morphisms and hence must carry the identity image to the identity image.
  This in particular fixes the branch of $\log(-)$ to choose when computing the values of $(\varphi_{\cX,\bfr}^1)^*(q_\ell y_\ell)$ and $(\varphi_{\cA,\bfr}^1)^*(p_jx_j)$ at the origin of each source fiber.
  Thus, by simple-connectedness, we are able to fix the choice of branch cut when computing their values at arbitrary points of the source fibers. 
  \footnote{What about the symplectic doubles?}
\end{remark}

For the groupoid morphism $\varphi_{\cA,\bfr}^1: \cG_{\cA,\bfr} \to \cG_{\cA,\bfr}$ in Corollary~\ref{cor:groupoid hamiltonian flows}, we give an explicit verification that the corresponding Lie algebroid morphism is the dual bundle map of the Lie algebroid comorphism induced by the base Poisson map $\varphi_{\cA,\bfr}^1:L_{\cA,\bfr}\to L_{\cA,\bfr}$. A similar story exists for the other groupoid maps in Corollary~\ref{cor:groupoid hamiltonian flows}.

To ease the notations, we drop the time parameter in the superscript, fix $\bfr$ and use Sans-serif font for the coordinates for the range, e.g. $\sfx$ for the range vs $x$ for the domain. To begin with, we apply the Lie functor, see \eqref{eq:Liefunctor} and the ensuing discussion. The source map of $\cG_\cA \rra L_\cA$ is 
\[
	\alpha: \cG_\cA \to L_\cA, \qquad (\bfp, \bfx) \mapsto \bfx,
\]
so the kernel of $\alpha_*: T\cG_\cA \to TL_\cA$ is generated by $\frac{\partial}{\partial p_j}, \> j = 1, \ldots, m$.
Given the Hamiltonian groupoid morphism
\begin{align*}
	\varphi_{\cA,\bfr}: ~& \cG_\cA \to \cG_\cA, \\
	& \sfx_j = \big(Z_k(\hat y_k^\varepsilon)\big)^{-\delta_{jk}}x_j, \\
	& \sfp_j \sfx_j = p_jx_j-\frac{B_{jk}}{d_k}\log\left(\frac{Z_k\left(\hat y_k^\varepsilon e^{-\varepsilon d_kp_kx_k}\right)}{Z_k(\hat y_k^\varepsilon)}\right),
\end{align*}
its pushfoward is
\begin{align*}
	\left(\varphi_{\cA,\bfr}\right)_*: ~& \ker(\alpha_*: T\cG_\cA \to TL_\cA) \to \ker(\alpha_*: T\cG_\cA \to TL_\cA),  \\
	& \frac{\partial}{\partial p_j} 
	= \frac{\partial}{\partial \sfp_j} + \frac{\varepsilon x_k \hat{y}_k^\varepsilon B_{jk}}{x_j} \frac{ e^{-\varepsilon d_k p_k x_k} Z'_k\left(\hat y_k^\varepsilon e^{-\varepsilon d_k p_k x_k}\right)}{Z_k\left(\hat y_k^\varepsilon e^{-\varepsilon d_k p_k x_k}\right)} \frac{\partial}{\partial p_k}, \qquad \text{if}~ j \ne k, \\
	& \frac{\partial}{\partial p_k}
	= \frac{1}{Z_k(\hat y_k^\varepsilon)}\frac{\partial}{\partial \sfp_k}.
\end{align*}
Restricting to the identity image, which is given by $p_j = 0, \> j = 1, \ldots, m$, we have
\begin{align*}
	\Lie \left(\varphi_{\cA,\bfr} \right): ~& \Lie \left(\cG_\cA \right) \to \Lie \left( \cG_\cA \right),  \\
	& \frac{\partial}{\partial p_j}
	= \frac{\partial}{\partial \sfp_j} + \frac{\varepsilon \sfx_k \hat{\sfy}_k^\varepsilon B_{jk}}{\sfx_j} \frac{Z'_k\left(\hat \sfy_k^\varepsilon \right)}{Z_k\left(\hat \sfy_k^\varepsilon \right)} \frac{\partial}{\partial \sfp_k}, \qquad \text{if}~ j \ne k, \\
	& \frac{\partial}{\partial p_k} 
	= \frac{1}{Z_k(\hat{\sfy}_k^\varepsilon)}\frac{\partial}{\partial \sfp_k}.
\end{align*}
On the other hand, taking derivatives of $\sfx_j = \big(Z_k(\hat{y}_k^\varepsilon)\big)^{-\delta_{jk}}x_j$,
we obtain the pullback map
\begin{align*}
	(\varphi_{\cA,\bfr})^*: ~& \Omega^1(L_\cA) \to \Omega^1(L_\cA), \\
	& d \sfx_j = dx_j, \qquad \text{if}~j\ne k, \\
	& d \sfx_k = \frac{1}{Z_k(\hat{y}_k^\varepsilon)} dx_k + \sum\limits_{j\ne k} \frac{\varepsilon x_k \hat{y}_k^\varepsilon B_{jk}}{x_j} \frac{Z'_k(\hat{y}_k^\varepsilon)}{\left(Z_k(\hat{y}_k^\varepsilon)\right)^2} dx_j \\
	& \quad \; \, = \frac{1}{Z_k(\hat{\sfy}_k^\varepsilon)} dx_k + \sum\limits_{j\ne k} \frac{\varepsilon \sfx_k \hat{\sfy}_k^\varepsilon B_{jk}}{\sfx_j} \frac{Z'_k(\hat{\sfy}_k^\varepsilon)}{Z_k(\hat{\sfy}_k^\varepsilon)} dx_j
\end{align*}
If we identify $\Lie \left(\cG_\cA \right)$ and $T^*_{\pi_\cA} L_\cA$ with
\[
	\frac{\partial}{\partial p_j} = dx_j, \> j =1, \ldots, m,
\]
then $(\varphi_{\cA,\bfr})^*$ is the dual bundle map of $\Lie \left(\varphi_{\cA,\bfr} \right)$. That is, $(\varphi_{\cA,\bfr})^*: T^*_{\pi_\cA} L_\cA \to T^*_{\pi_\cA} L_\cA$ is a Lie algebroid comorphism and its corresponding Lie algebroid morphism is $\Lie \left(\varphi_{\cA,\bfr} \right)$. See the discussion proceeding Definition~\ref{def:gpdcomor}. It follows that $(\varphi_{\cA,\bfr})^*$ integrates to a groupoid comorphism whose graph coincides with the graph of $\varphi_{\cA,\bfr}: \cG_\cA \to \cG_\cA$.

\begin{lemma}
  \label{le:tropical groupoid transformations}
  For $1\le k\le n$ and $\varepsilon\in\{\pm1\}$, there are symplectic groupoid morphisms 
  \begin{align*}
    \tau_{\cX,\bfr}^{k,\varepsilon}&:\cG_{\cX,\bfr}\to\cG'_{\cX,\bfr},& \tau_{\cX,\bfr}^{k,\varepsilon}&:\cB_{\cX,\bfr}\to\cB'_{\cX,\bfr},& \tau_{\cX,\bfr}^{k,\varepsilon}&:\cD_{\cX,\bfr}\to\cD'_{\cX,\bfr}\\
    \tau_{\cA,\bfr}^{k,\varepsilon}&:\cG_{\cA,\bfr}\to\cG'_{\cA,\bfr},& \tau_{\cA,\bfr}^{k,\varepsilon}&:\cB_{\cA,\bfr}\to\cB'_{\cA,\bfr},& \tau_{\cA,\bfr}^{k,\varepsilon}&:\cD_{\cA,\bfr}\to\cD'_{\cA,\bfr}
  \end{align*}
  lifting respectively the Poisson morphisms $\tau_{\cX,\bfr}^{k,\varepsilon}:L^+_{\cX,\bfr}\to L^+_{\cX',\bfr}$ and $\tau_{\cA,\bfr}^{k,\varepsilon}:L^+_{\cA,\bfr}\to L^+_{\cA',\bfr}$ of Lemma~\ref{le:tropical cluster transformations}.
  These are given on coordinates by
  \begin{align}
    \label{eq:tropical GX transformation}
    (\tau_{\cX,\bfr}^{k,\varepsilon})^*(q'_\ell)
    &=\begin{cases} 
      -q_k y_k^2 + \sum\limits_{\ell'=1}^n [\varepsilon r_k B_{k\ell'}]_+ q_{\ell'} y_{\ell'} y_k & \text{if $\ell=k$;}\\ 
      q_\ell y_k^{-[\varepsilon r_k B_{k\ell}]_+} & \text{if $\ell\ne k$;}
    \end{cases}\\
    \label{eq:tropical BX transformation}
    (\tau_{\cX,\bfr}^{k,\varepsilon})^*(v'_\ell)
    &=\begin{cases} 
      y_k\Big[(v_k y_k + 1)^{-1}\prod\limits_{\ell'=1}^n (v_{\ell'} y_{\ell'} + 1)^{[\varepsilon r_k B_{k\ell'}]_+} -1\Big] & \text{if $\ell=k$;}\\
      v_\ell y_k^{-[\varepsilon r_k B_{k\ell}]_+} & \text{if $\ell\ne k$;}
    \end{cases}\\
    \label{eq:tropical DX transformation}
    (\tau_{\cX,\bfr}^{k,\varepsilon})^*(t'_\ell)
    &=\begin{cases} 
      t_k^{-1}\prod\limits_{\ell'=1}^n t_{\ell'}^{[\varepsilon r_k B_{k\ell'}]_+} & \text{if $\ell=k$;}\\
      t_\ell & \text{if $\ell\ne k$;}
    \end{cases}\\
    \label{eq:tropical GA transformation}
    (\tau_{\cA,\bfr}^{k,\varepsilon})^*(p'_j)&=
    \begin{cases} 
      -p_k x_k^2 \prod\limits_{i=1}^m x_i^{-[-\varepsilon B_{ik} r_k]_+} & \text{if $j=k$;}\\ 
      p_j + [-\varepsilon B_{jk} r_k]_+ \frac{p_k x_k}{x_j} & \text{if $j\ne k$;}
    \end{cases}\\
    \label{eq:tropical BA transformation}
    (\tau_{\cA,\bfr}^{k,\varepsilon})^*(u'_j)
    &=\begin{cases} 
      x_k \left[ (u_k x_k +1)^{-1} -1\right] \left(\prod_{i=1}^m x_i^{-[-\varepsilon B_{ik} r_k]_+}\right) & \text{if $j=k$;}\\ 
      x_j^{-1}\big[(u_j x_j + 1) (u_k x_k + 1)^{[-\varepsilon B_{jk} r_k]_+}-1\big] & \text{if $j\ne k$.}
    \end{cases}\\
    \label{eq:tropical DA transformation}
    (\tau_{\cA,\bfr}^{k,\varepsilon})^*(s'_j)
    &=\begin{cases} 
      s_k^{-1} & \text{if $j=k$;}\\ 
      s_j s_k^{[-\varepsilon B_{jk} r_k]_+} & \text{if $j\ne k$.}
    \end{cases}
  \end{align}
\end{lemma}
\begin{proof}
We prove \eqref{eq:tropical GA transformation}. The other groupoid maps follows from \eqref{eq:LGpdCD} and/or Lemma~\ref{lemma:ensemblegpd}. To ease the notation, we fix $\bfr$ and drop all subscripts and supscripts. Taking derivatives of
\begin{align*}
	\tau:~ & L^+_{\cA}\to L^+_{\cA'}, \\
	& x'_k =x_k^{-1}\prod\limits_{i=1}^m x_i^{[-\varepsilon B_{ik}r_k]_+}, \\
	& x'_j = x_j, \qquad \text{if } j \ne k,
\end{align*}
we obtain the pullback map
	\begin{align*}
		\tau^*:~ & \Omega^1(L^+_{\cA'}) \to \Omega^1(L^+_{\cA}), \\
		& dx'_k = - x_k^{-2}\prod\limits_{i=1}^m x_i^{[- \varepsilon B_{jk} r_k]_+} dx_k + \sum\limits_{j=1}^m \frac{[- \varepsilon B_{jk} r_k]_+}{x_j x_k} \prod\limits_{i=1}^m x_i^{[- \varepsilon B_{ik} r_k]_+} dx_j, \\
		& dx'_j = dx_j \qquad \text{if}~j\ne k, \\
		&  \sum\limits_{j=1}^m p'_j dx'_j = - \frac{p'_k}{x_k^2}\prod\limits_{i=1}^m x_i^{[- \varepsilon B_{ik} r_k]_+} dx_k + \sum\limits_{j\ne k} \left(\frac{p'_k [- \varepsilon B_{jk} r_k]_+ }{x_jx_k} \prod\limits_{i=1}^m x_i^{[- \varepsilon B_{ik} r_k]_+}  + p'_j\right)dx_j
	\end{align*}
or as a bundle map
	\begin{align*}
		\tau^*:~ & \tau^! T^* L^+_{\cA'} \to T^* L^+_{\cA},  \\
		& p_k = - \frac{x'_k p'_k}{x_k}, \\
		& p_j = \frac{x'_kp'_k [- \varepsilon B_{jk} r_k]_+ }{x_j}   + p'_j \qquad \text{if}~j\ne k.
	\end{align*}
The graph of the Lie algebroid comorphism $\tau^*$ from $T^*_{\pi_{\cA'}} L_{\cA'}$ to $T^*_{\pi_{\cA}} L_{\cA}$ is defined by
	\begin{align*}
		& x'_k p'_k = - x_k p_k , \\
		& x'_j p'_j = x_kp_k [- \varepsilon B_{jk} r_k]_+  + x_jp_j \quad \text{if}~j\ne k.
	\end{align*}
By Lemma~\ref{lemma:PoisSp} and Corollary~\ref{cor:exp}, both $x_j p_j$ and $x'_j p'_j$ are invariant under the exponential map, so \eqref{eq:tropical GA transformation} follows.
\end{proof}

\begin{proposition}
  \label{prop:groupoid mutation}
  There are morphisms of Poisson groupoids $\mu_{\cX,\bfr}^{k,\varepsilon}$ and $\mu_{\cA,\bfr}^{k,\varepsilon}$:
  \begin{align*}
    \mu_{\cX,\bfr}^{k,\varepsilon}&:\cG_{\cX,\bfr}\to\cG'_{\cX,\bfr},& \mu_{\cX,\bfr}^{k,\varepsilon}&:\cB_{\cX,\bfr}\to\cB'_{\cX,\bfr},& \mu_{\cX,\bfr}^{k,\varepsilon}&:\cD_{\cX,\bfr}\to\cD'_{\cX,\bfr}\\
    \mu_{\cA,\bfr}^{k,\varepsilon}&:\cG_{\cA,\bfr}\to\cG'_{\cA,\bfr},& \mu_{\cA,\bfr}^{k,\varepsilon}&:\cB_{\cA,\bfr}\to\cB'_{\cA,\bfr},& \mu_{\cA,\bfr}^{k,\varepsilon}&:\cD_{\cA,\bfr}\to\cD'_{\cA,\bfr}
  \end{align*}
  defined as the compositions $\tau_{-,\bfr}^{k,\varepsilon}\circ\varphi_{-,\bfr}^1$ given on coordinates by
  \begin{align}
    \label{eq:GX mutation}
    (\mu_{\cX,\bfr}^{k,\varepsilon})^*(q'_\ell)
    &=\begin{cases} 
      -q_k y_k^2 + \sum\limits_{\ell'=1}^n [\varepsilon r_k B_{k\ell'}]_+ q_{\ell'} y_{\ell'} y_k + \frac{y_k}{d_k}\log\left(\frac{Z_k\left(y_k^\varepsilon e^{\varepsilon\sum_{\ell'=1}^n d_{\ell'} B_{\ell' k}q_{\ell'} y_{\ell'}}\right)}{Z_k(y_k^\varepsilon)}\right) & \text{if $\ell=k$;}\\ 
      q_\ell y_k^{-[\varepsilon r_k B_{k\ell}]_+} Z_k(y_k^\varepsilon)^{B_{k\ell}} & \text{if $\ell\ne k$;}
    \end{cases}\\
    \label{eq:BX mutation}
    (\mu_{\cX,\bfr}^{k,\varepsilon})^*(v'_\ell)
    &=\begin{cases} 
      y_k \left[ (v_k y_k + 1)^{-1} \left(\prod\limits_{\ell'=1}^n (v_{\ell'} y_{\ell'} +1)^{[\varepsilon r_k B_{k\ell'}]_+}\right)\left(\frac{Z_k\left(y_k^\varepsilon \prod_{\ell'=1}^n (v_{\ell'} y_{\ell'} + 1)^{\varepsilon d_{\ell'} B_{\ell' k}}\right)}{Z_k(y_k^\varepsilon)}\right)^{\frac{1}{d_k}} - 1\right] & \text{if $\ell=k$;}\\ 
      v_\ell y_k^{-[\varepsilon r_k B_{k\ell}]_+} Z_k(y_k^\varepsilon)^{B_{k\ell}} & \text{if $\ell\ne k$;}
    \end{cases}\\
    \label{eq:DX mutation}
    (\mu_{\cX,\bfr}^{k,\varepsilon})^*(t'_\ell)
    &=\begin{cases} 
      t_k^{-1}\prod\limits_{\ell'=1}^n t_{\ell'}^{[\varepsilon r_k B_{k\ell'}]_+}\left(\frac{Z_k\left(y_k^\varepsilon \prod_{\ell'=1}^n t_{\ell'}^{\varepsilon d_{\ell'} B_{\ell' k}}\right)}{Z_k(y_k^\varepsilon)}\right)^{1/d_k} & \text{if $\ell=k$;}\\
      t_\ell & \text{if $\ell\ne k$;}
    \end{cases}\\
    \label{eq:GA mutation}
    (\mu_{\cA,\bfr}^{k,\varepsilon})^*(p'_j)&=
    \begin{cases} 
      -p_k x_k^2 \left(\prod_{i=1}^m x_i^{-[-\varepsilon B_{ik} r_k]_+}\right) Z_k(\hat y_k^\varepsilon)^{-1} & \text{if $j=k$;}\\ 
      p_j + [-\varepsilon B_{jk} r_k]_+ \frac{p_k x_k}{x_j} - \frac{B_{jk}}{d_k x_j}\log\left(\frac{Z_k\left(\hat y_k^\varepsilon e^{-\varepsilon d_kp_kx_k}\right)}{Z_k(\hat y_k^\varepsilon)}\right) & \text{if $j\ne k$;}
    \end{cases}\\
    \label{eq:BA mutation}
    (\mu_{\cA,\bfr}^{k,\varepsilon})^*(u'_j)
    &=\begin{cases}
      x_k \left[ (u_k x_k +1)^{-1} -1\right] \left(\prod_{i=1}^m x_i^{-[-\varepsilon B_{ik} r_k]_+}\right) Z_k(\hat y_k^\varepsilon)^{-1} & \text{if $j=k$;}\\ 
      x_j^{-1} \left[ (u_j x_j + 1) (u_k x_k + 1)^{[-\varepsilon B_{jk} r_k]_+} \left(\frac{Z_k\left(\hat y_k^\varepsilon (u_k x_k +1)^{-\varepsilon d_k}\right)}{Z_k(\hat y_k^\varepsilon)}\right)^{-B_{jk}/d_k} - 1\right] & \text{if $j\ne k$;}
    \end{cases}\\
    \label{eq:DA mutation}
    (\mu_{\cA,\bfr}^{k,\varepsilon})^*(s'_j)
    &=\begin{cases} 
      s_k^{-1} & \text{if $j=k$;}\\ 
      s_j s_k^{[-\varepsilon B_{jk} r_k]_+} \left(\frac{Z_k\left(\hat y_k^\varepsilon s_k^{-\varepsilon d_k}\right)}{Z_k(\hat y_k^\varepsilon)}\right)^{-B_{jk}/d_k} & \text{if $j\ne k$.}
    \end{cases}
  \end{align}
\end{proposition}
\begin{proof}
  This is immediate from Lemma~\ref{le:tropical groupoid transformations} and Corollary~\ref{cor:groupoid hamiltonian flows}.
\end{proof}
\begin{remark}
  Observe that the mutations $\mu_{\cA,\bfr}^{k,\varepsilon}$ appear to be undefined on $p'_j$ and $u'_j$ for $j\ne k$ when $x_j=0$.
  However, these maps are continuous when appropriate values are assigned.
  Indeed, for $j\ne k$ and $x_j=0$ we set
  \begin{align*}
    (\mu_{\cA,\bfr}^{k,\varepsilon})^*(p'_j)
    &=p_j+\lim_{x_j \to 0}\frac{[-\varepsilon B_{jk} r_k]_+ p_k x_k - \frac{B_{jk}}{d_k}\log\left(\frac{Z_k(\hat y_k^\varepsilon e^{-\varepsilon d_kp_kx_k})}{Z_k(\hat y_k^\varepsilon)}\right)}{x_j}\\
    &=p_j-\frac{\varepsilon B_{jk}^2}{d_k} \lim_{x_j\to 0} \frac{ \hat y_k^\varepsilon e^{-\varepsilon d_kp_kx_k} Z'_k(\hat y_k^\varepsilon e^{-\varepsilon d_kp_kx_k}) Z_k(\hat y_k^\varepsilon) - \hat y_k^\varepsilon Z_k(\hat y_k^\varepsilon e^{-\varepsilon d_kp_kx_k}) Z'_k(\hat y_k^\varepsilon) }{ x_j Z_k(\hat y_k^\varepsilon e^{-\varepsilon d_kp_kx_k}) Z_k(\hat y_k^\varepsilon) }\\
    &=\begin{cases} 
      p_j & \text{if $|B_{jk}| \ne 1$;}\\ 
      p_j - \frac{\varepsilon}{d_k} \prod_{i\ne j} x_i^{\varepsilon B_{ik}} z_{k,1} (e^{-\varepsilon d_kp_kx_k} - 1) & \text{if $\varepsilon B_{jk} = 1$;}\\ 
      p_j + \frac{\varepsilon}{d_k} \prod_{i\ne j} x_i^{-\varepsilon B_{ik}} z_{k,r_k-1} (e^{\varepsilon d_kp_kx_k} - 1) & \text{if $\varepsilon B_{jk} = -1$.}
    \end{cases}
  \end{align*}
  Observe that the map above is not defined for $x_i=0$ when $\varepsilon B_{jk}=1$ and $\varepsilon B_{ik} < 0$ nor when $\varepsilon B_{jk} = -1$ and $\varepsilon B_{ik} > 0$.
  Following Remark~\ref{rem:extended cluster charts}, the gluing maps $\mu_{-,\bfr}^{k,\varepsilon}$ are also not defined on these loci since the conditions imply $\left(\prod\limits_{i=1}^m x_i^{[-\varepsilon B_{ik}r_k]_+}\right)Z_k(\hat y_k^\varepsilon)=0$ and thus the gluing of fibers is not attempted over these loci. 
\end{remark}

The various groupoid maps lifting the Poisson maps in \eqref{eq:PoisCD} are summarized in the following commutative diagram. The groupoid morphisms are represented by solid arrows and the groupoid comorphisms are represented by dotted arrows.
\begin{equation} 
	\label{eq:GpdCD}
    \xymatrix{
      \cG_{\cA} \ar@{.>}[d]^{\rho} \ar[r]_{\varphi_{\cA}} \ar@/^1pc/[rr]|-{\mu_{\cA}} & \cG_{\cA} \ar@{.>}[d]^{\rho} \ar[r]_{\tau_{\cA}} & \cG'_{\cA} \ar@{.>}[d]^{\rho} 
	&& \cD_{\cA} \ar@{.>}[d]^{\rho} \ar[r]_{\varphi_{\cA}} \ar@/^1pc/[rr]|-{\mu_{\cA}} & \cD_{\cA} \ar@{.>}[d]^{\rho} \ar[r]_{\tau_{\cA}} & \cD'_{\cA} \ar@{.>}[d]^{\rho} \\
      \cG_{\cX} \ar[r]^{\varphi_{\cX}} \ar@/_1pc/[rr]|-{\mu_{\cX}} & \cG_{\cX} \ar[r]^{\tau_{\cX}} \ar@{}[ddr]^(.325){}="a"^(.775){}="b" \ar@<1ex> "a";"b"^-{\kappa_\cA} \ar@<-1ex> "a";"b"_-{\kappa_\cX} & \cG'_{\cX} \ar@{}[rr]^(.3){}="e"^(.7){}="f" \ar@<5ex> "e";"f"^-{\lambda_\cA} \ar@<3ex> "e";"f"_-{\lambda_\cX}
	&& \cD_{\cX} \ar[r]^{\varphi_{\cX}} \ar@/_1pc/[rr]|-{\mu_{\cX}} & \cD_{\cX} \ar[r]^{\tau_{\cX}} & \cD'_{\cX} \\
	&&&&&&\\
	&&\cB_{\cA} \ar@{.>}[d]^{\rho} \ar[r]_{\varphi_{\cA}} \ar@/^1pc/[rr]|-{\mu_{\cA}} & \cB_{\cA} \ar@{.>}[d]^{\rho} \ar[r]_{\tau_{\cA}} & \cB'_{\cA} \ar@{.>}[d]^{\rho} \ar@{}[uur]^(.2){}="c"^(.65){}="d" \ar@<1ex> "c";"d"^-{\nu_\cA} \ar@<-1ex> "c";"d"_-{\nu_\cX}  \\
      &&\cB_{\cX} \ar[r]^{\varphi_{\cX}} \ar@/_1pc/[rr]|-{\mu_{\cX}} & \cB_{\cX} \ar[r]^{\tau_{\cX}} & \cB'_{\cX}
    }
\end{equation}

As in Section~\ref{sec:cluster}, we record iterated mutations using the $n$-regular rooted tree $\TT_n$ with root vertex $t_0$.
That is, over each cluster chart $L^+_{\cX,\bfr;t}$ and $L^+_{\cA,\bfr;t}$ we have, respectively, groupoids $\cG_{\cX,\bfr;t}$, $\cB_{\cX,\bfr;t}$, $\cD_{\cX,\bfr;t}$ and $\cG_{\cA,\bfr;t}$, $\cB_{\cA,\bfr;t}$, $\cD_{\cA,\bfr;t}$ with all of the structure as above.

That is, over each cluster chart $L^+_{\cX,\bfr;t}$ and $L^+_{\cA,\bfr;t}$ we have, respectively, groupoids $\cG_{\cX,\bfr;t}$, $\cB_{\cX,\bfr;t}$, $\cD_{\cX,\bfr;t}$ and $\cG_{\cA,\bfr;t}$, $\cB_{\cA,\bfr;t}$, $\cD_{\cA,\bfr;t}$ with all of the structure as above associated to the pairs $(\tilde B_t,\Omega_t)$ for each $t\in\TT_n$.
\begin{definition}
  Fix an initial $m\times n$ exchange matrix $\tilde B_{t_0}$ and an initial skew-symmetric matrix $\Omega_{t_0}$ which is $D$-compatible with $\tilde B_{t_0}$.
  Define groupoids $\cG_{\cX_\bfr}$, $\cB_{\cX_\bfr}$, $\cD_{\cX_\bfr}$ and $\cG_{\cA_\bfr}$, $\cB_{\cA_\bfr}$, $\cD_{\cA_\bfr}$ over the cluster varieties $\cX_\bfr$ and $\cA_\bfr$ respectively by gluing the groupoid charts $\cG_{\cX_\bfr;t}$, $\cB_{\cX_\bfr;t}$, $\cD_{\cX_\bfr;t}$ to $\cG_{\cX_\bfr;t'}$, $\cB_{\cX_\bfr;t'}$, $\cD_{\cX_\bfr;t'}$ respectively and by gluing the groupoid charts $\cG_{\cA_\bfr;t}$, $\cB_{\cA_\bfr;t}$, $\cD_{\cA_\bfr;t}$ to $\cG_{\cA_\bfr;t'}$, $\cB_{\cA_\bfr;t'}$, $\cD_{\cA_\bfr;t'}$ respectively, for $t,t'\in\TT_n$ joined by an edge labeled $k$, along the appropriate groupoid mutations $\mu_{\cX,\bfr}^{k,\varepsilon}$ and $\mu_{\cA,\bfr}^{k,\varepsilon}$, where $\varepsilon=\varepsilon_{\bfr,k;t}$ is the tropical sign from Definition~\ref{def:tropical signs}.
\end{definition}
\begin{remark}
  Recall that the symplectic groupoid charts $\cG_{\cX,\bfr;t}$ and $\cG_{\cA,\bfr;t}$ were constructed in Section~\ref{sec:local} using Poisson sprays.
  Ideally these Poisson sprays would be compatible with mutations and thus glue to give a global construction of the source-simply-connected symplectic groupoids over the varieties $\cX_\bfr$ and $\cA_\bfr$.
  Unfortunately, this is not the case and we must make due with the iterative construction presented above.
\end{remark}

Given a pair of vertices $t,t'\in\TT_n$, we follow the notation of Section~\ref{sec:cluster} and write $\mu_{\cX,\bfr}^{t,t'}$ and $\mu_{\cA,\bfr}^{t,t'}$ for each of the composed groupoid mutations over the cluster charts of $\cX_\bfr$ and $\cA_\bfr$ respectively.
As a first step in lifting the separation of additions formulas~\eqref{eq:separation of additions 1} and~\eqref{eq:separation of additions 2} to the level of groupoids we introduce analogues of the $\bfc$-vectors and $\bfg$-vectors which describe iterations of the cluster mutations.
To begin let $C^\vee_{t_0}$ be an $m\times m$ identity matrix and let $G^\vee_{t_0}$ be an $n\times n$ identity matrix.
We then assign matrices $C^\vee_t:=(C^\vee_{ij;t})$ and $G^\vee_t:=(G^\vee_{ij;t})$ to the vertices $t\in\TT_n$ by the following recursion.
For vertices $t,t'\in\TT_n$ joined by an edge labeled $k$, the matrices $C^\vee_t$ and $C^\vee_{t'}$ are related by
\begin{equation}
  \label{eq:dual c-matrix mutation}
  C^\vee_{ij;t'}=
  \begin{cases}
    -C^\vee_{ij;t} & \text{if $i=k$;}\\
    C^\vee_{ij;t}+[-\varepsilon_{\bfr,k;t} B_{ik;t} r_k]_+ C^\vee_{kj;t} & \text{if $i\ne k$;}
  \end{cases}
\end{equation}
while the matrices $G^\vee_t$ and $G^\vee_{t'}$ are related by
\begin{equation}
  \label{eq:dual g-matrix mutation}
  G^\vee_{ij;t'}=
  \begin{cases}
    -G^\vee_{kj;t}+\sum\limits_{\ell=1}^n [\varepsilon_{\bfr,k;t} r_k B_{k\ell;t}]_+ G^\vee_{\ell j;t} & \text{if $i=k$;}\\
    G^\vee_{ij;t} & \text{if $i\ne k$.}
  \end{cases}
\end{equation}
\begin{remark}
  An easy induction shows that $C^\vee_{ij;t}$ is independent of $t$ for $1\le i\le m$ and $n+1\le j\le m$.
  In particular, $C^\vee_{ij;t}=0$ for $1\le i\le m$ and $n+1\le j\le m$ with $i\ne j$ while $C^\vee_{jj;t}=1$ for $n+1\le j\le m$.
\end{remark}
\begin{lemma}
  \label{le:dual C-vectors}
  For $1\le k,\ell\le n$, we have $d_kC^\vee_{k\ell;t}=d_\ell C_{\ell k;t}$ for all $t\in\TT_n$.
\end{lemma}
\begin{proof}
  This is an easy induction using the recursions \eqref{eq:c-matrix mutation 2} and \eqref{eq:dual c-matrix mutation} together with the identities $d_k B_{k\ell;t}=-d_\ell B_{\ell k;t}$ for all $t\in\TT_n$.
\end{proof}

Then we have the following analogues of the separation of additions formulas describing the cluster coordinates.
\begin{theorem}
  For any vertex $t\in\TT_n$, we have the following formulas for the iterated mutations $\mu_{-,\bfr}^{t,t_0}$, where each $\beta$ below denotes the target map of an appropriate groupoid:
  \begin{align}
    \label{eq:groupoid separation of additions 1}
    \big(\mu_{\cX,\bfr}^{t,t_0}\big)^*(t_{k;t})&=\left(\prod_{\ell=1}^n t_{\ell;t_0}^{G^\vee_{k\ell;t}}\right) \left(\frac{F_{k,\bfr;t}\big(y_{1;t_0}\prod_{\ell=1}^n t_{\ell;t_0}^{d_\ell B_{\ell 1;t_0}},\ldots,y_{n;t_0}\prod_{\ell=1}^n t_{\ell;t_0}^{d_\ell B_{\ell n;t_0}}\big)}{F_{k,\bfr;t}(y_{1;t_0},\ldots,y_{n;t_0})}\right)^{1/d_k};\\
    \big(\mu_{\cA,\bfr}^{t,t_0}\big)^*(x_{i;t} p_{i;t})&=\left(\sum_{j=1}^m C^\vee_{ij;t} x_{j;t_0} p_{j;t_0}\right) + \sum_{\ell=1}^n \frac{B_{i\ell;t}}{d_\ell}\log\left(\frac{\beta^*\left(F_{\ell,\bfr;t}(\hat y_{1;t_0},\ldots,\hat y_{n;t_0})\right)}{F_{\ell,\bfr;t}(\hat y_{1;t_0},\ldots,\hat y_{n;t_0})}\right);\\
    \label{eq:groupoid separation of additions 2}
    \big(\mu_{\cA,\bfr}^{t,t_0}\big)^*(s_{i;t})&=\left(\prod_{j=1}^m s_{j;t_0}^{C^\vee_{ij;t}}\right) \prod_{\ell=1}^n \left(\frac{\beta^*\left(F_{\ell,\bfr;t}(\hat y_{1;t_0},\ldots,\hat y_{n;t_0})\right)}{F_{\ell,\bfr;t}(\hat y_{1;t_0},\ldots,\hat y_{n;t_0})}\right)^{B_{i\ell;t}/d_\ell};\\
    \big(\mu_{\cA,\bfr}^{t,t_0}\big)^*(x_{i;t} u_{i;t} + 1)&=\left(\prod_{j=1}^m (x_{j;t_0} u_{j;t_0} + 1)^{C^\vee_{ij;t}}\right) \prod_{\ell=1}^n \left(\frac{\beta^*\left(F_{\ell,\bfr;t}(\hat y_{1;t_0},\ldots,\hat y_{n;t_0})\right)}{F_{\ell,\bfr;t}(\hat y_{1;t_0},\ldots,\hat y_{n;t_0})}\right)^{B_{i\ell;t}/d_\ell}.
  \end{align}
\end{theorem}
\begin{proof}
  We prove only equation~\eqref{eq:groupoid separation of additions 2}, working by induction on the distance from $t_0$ to $t$ inside $\TT_n$ in this case.
  First consider when $t$ is joined to $t_0$ by an edge labeled $k$.
  Then $F_{k,\bfr;t}=Z_k(u_k)$ and $F_{\ell,\bfr;t}=1$ for $\ell\ne k$ so that \eqref{eq:groupoid separation of additions 2} just becomes the mutation formula \eqref{eq:DA mutation}.

  Now suppose $t'$ and $t$ are joined by an edge labeled $k$ with $t$ lying on the unique shortest path from $t_0$ to $t'$.
  Then $\mu_{\cA,\bfr}^{t',t_0}=\mu_{\cA,\bfr}^{t',t}\circ\mu_{\cA,\bfr}^{t,t_0}$ so that
  \begin{align*}
    \big(\mu_{\cA,\bfr}^{t',t_0}\big)^*(s_{k;t'})
    &=\big(\mu_{\cA,\bfr}^{t,t_0}\big)^*\circ\big(\mu_{\cA,\bfr}^{t',t}\big)^*(s_{k;t'})\\
    &=\big(\mu_{\cA,\bfr}^{t,t_0}\big)^*(s_{k;t}^{-1})\\
    &=\left(\prod_{j=1}^m s_{j;t_0}^{-C^\vee_{kj;t}}\right) \prod_{\ell=1}^n \left(\frac{F_{\ell,\bfr;t}(\hat y_{1;t_0} s_{1;t_0}^{-d_1},\ldots,\hat y_{n;t_0} s_{n;t_0}^{-d_n})}{F_{\ell,\bfr;t}(\hat y_{1;t_0},\ldots,\hat y_{n;t_0})}\right)^{-B_{k\ell;t}/d_\ell}\\
    &=\left(\prod_{j=1}^m s_{j;t_0}^{C^\vee_{kj;t'}}\right) \prod_{\ell=1}^n \left(\frac{F_{\ell,\bfr;t'}(\hat y_{1;t_0} s_{1;t_0}^{-d_1},\ldots,\hat y_{n;t_0} s_{n;t_0}^{-d_n})}{F_{\ell,\bfr;t'}(\hat y_{1;t_0},\ldots,\hat y_{n;t_0})}\right)^{B_{k\ell;t'}/d_\ell},
  \end{align*}
  where the last equality used that $\ell\ne k$ in the product since $B_{kk;t}=0$.
  On the other hand, writing $\varepsilon=\varepsilon_{\bfr,k;t}$ below, for $i\ne k$ we have
  \begin{align*}
    \big(\mu_{\cA,\bfr}^{t',t_0}\big)^*(s_{i;t'})
    &=\big(\mu_{\cA,\bfr}^{t,t_0}\big)^*\circ\big(\mu_{\cA,\bfr}^{t',t}\big)^*(s_{i;t'})\\
    &=\big(\mu_{\cA,\bfr}^{t,t_0}\big)^*\left(s_{i;t} s_{k;t}^{[-\varepsilon B_{ik;t} r_k]_+} \left(\frac{Z_k\left(\hat y_{k;t}^\varepsilon s_{k;t}^{-\varepsilon d_k}\right)}{Z_k(\hat y_{k;t}^\varepsilon)}\right)^{-B_{ik;t}/d_k}\right).
  \end{align*}
  We handle the ``$\bfc$-vector part'' of the above expression first.
  Applying \eqref{eq:groupoid separation of additions 2} to the first two terms above and recording only the $\bfc$-vector part gives
  \begin{align*}
    \left(\prod_{j=1}^m s_{j;t_0}^{C^\vee_{ij;t}}\right)\left(\prod_{j=1}^m s_{j;t_0}^{C^\vee_{kj;t}}\right)^{[-\varepsilon B_{ik;t} r_k]_+}
    =\prod_{j=1}^m s_{j;t_0}^{C^\vee_{ij;t} + [-\varepsilon B_{ik;t} r_k]_+ C^\vee_{kj;t}}
    =\prod_{j=1}^m s_{j;t_0}^{C^\vee_{ij;t'}},
  \end{align*}
  which is the desired $\bfc$-vector part of $\big(\mu_{\cA,\bfr}^{t',t_0}\big)^*(s_{i;t'})$.
  Meanwhile the $F$-polynomial part of this is given by
  \begin{align*}
    &\prod_{\ell=1}^n \left(\frac{F_{\ell,\bfr;t}(\hat y_{1;t_0} s_{1;t_0}^{-d_1},\ldots,\hat y_{n;t_0} s_{n;t_0}^{-d_n})}{F_{\ell,\bfr;t}(\hat y_{1;t_0},\ldots,\hat y_{n;t_0})}\right)^{B_{i\ell;t}/d_\ell}
    \prod_{\ell=1}^n \left(\frac{F_{\ell,\bfr;t}(\hat y_{1;t_0} s_{1;t_0}^{-d_1},\ldots,\hat y_{n;t_0} s_{n;t_0}^{-d_n})}{F_{\ell,\bfr;t}(\hat y_{1;t_0},\ldots,\hat y_{n;t_0})}\right)^{[-\varepsilon B_{ik;t} r_k]_+ B_{k\ell;t}/d_\ell}\\
    & = \left(\frac{F_{\ell,\bfr;t}(\hat y_{1;t_0} s_{1;t_0}^{-d_1},\ldots,\hat y_{n;t_0} s_{n;t_0}^{-d_n})}{F_{\ell,\bfr;t}(\hat y_{1;t_0},\ldots,\hat y_{n;t_0})}\right)^{B_{ik;t}/d_k}
    \prod_{\ell\ne k} \left(\frac{F_{\ell,\bfr;t}(\hat y_{1;t_0} s_{1;t_0}^{-d_1},\ldots,\hat y_{n;t_0} s_{n;t_0}^{-d_n})}{F_{\ell,\bfr;t}(\hat y_{1;t_0},\ldots,\hat y_{n;t_0})}\right)^{B_{i\ell;t'}/d_\ell-B_{ik;t} [\varepsilon r_k B_{k\ell;t}]_+/d_\ell},
  \end{align*}
  where the final exponent above may be rewritten as $B_{i\ell;t'}/d_\ell-B_{ik;t} [-\varepsilon r_k B_{\ell k;t}]_+/d_k$.
  On the other hand, considering only $\big(\mu_{\cA,\bfr}^{t,t_0}\big)^*\left(\hat y_{k;t}^\varepsilon s_{k;t}^{-\varepsilon d_k}\right)$ gives
  \begin{align*}
    \nonumber &\left(\prod_{\ell=1}^n \hat y_{\ell;t_0}^{\varepsilon C_{\ell k;t}} F_{\ell,\bfr;t}(\hat y_{1;t_0},\ldots,\hat y_{n;t_0})^{\varepsilon B_{\ell k;t}}\right) \left(\prod_{j=1}^m s_{j;t_0}^{-\varepsilon d_k C^\vee_{kj;t}}\right) \prod_{\ell=1}^n \left(\frac{F_{\ell,\bfr;t}(\hat y_{1;t_0} s_{1;t_0}^{-d_1},\ldots,\hat y_{n;t_0} s_{n;t_0}^{-d_n})}{F_{\ell,\bfr;t}(\hat y_{1;t_0},\ldots,\hat y_{n;t_0})}\right)^{-\varepsilon d_k B_{k\ell;t}/d_\ell}\\
    \nonumber &=\left(\prod_{\ell=1}^n \hat y_{\ell;t_0}^{\varepsilon C_{\ell k;t}} F_{\ell,\bfr;t}(\hat y_{1;t_0},\ldots,\hat y_{n;t_0})^{\varepsilon B_{\ell k;t}}\right) \left(\prod_{\ell=1}^n s_{\ell;t_0}^{-\varepsilon d_k C^\vee_{k\ell;t}}\right) \prod_{\ell=1}^n \left(\frac{F_{\ell,\bfr;t}(\hat y_{1;t_0} s_{1;t_0}^{-d_1},\ldots,\hat y_{n;t_0} s_{n;t_0}^{-d_n})}{F_{\ell,\bfr;t}(\hat y_{1;t_0},\ldots,\hat y_{n;t_0})}\right)^{\varepsilon B_{\ell k;t}}\\
    %\label{eq:Z argument}
    &=\left(\prod_{\ell=1}^n (\hat y_{\ell;t_0} s_{\ell;t_0}^{-d_\ell})^{\varepsilon C_{\ell k;t}}\right) \prod_{\ell=1}^n \left(F_{\ell,\bfr;t}(\hat y_{1;t_0} s_{1;t_0}^{-d_1},\ldots,\hat y_{n;t_0} s_{n;t_0}^{-d_n})\right)^{\varepsilon B_{\ell k;t}},
  \end{align*}
  where the last equality used Lemma~\ref{le:dual C-vectors}.
  Thus combining the $F$-polynomial part above with the expression $\big(\mu_{\cA,\bfr}^{t,t_0}\big)^*\left(\frac{Z_k\left(\hat y_{k;t}^\varepsilon s_{k;t}^{-\varepsilon d_k}\right)}{Z_k(\hat y_{k;t}^\varepsilon)}\right)^{-B_{ik;t}/d_k}$ and applying the $F$-polynomial recursion \eqref{eq:F-polynomial mutation} gives
  \begin{align*}
    \prod_{\ell\ne k} \left(\frac{F_{\ell,\bfr;t}(\hat y_{1;t_0} s_{1;t_0}^{-d_1},\ldots,\hat y_{n;t_0} s_{n;t_0}^{-d_n})}{F_{\ell,\bfr;t}(\hat y_{1;t_0},\ldots,\hat y_{n;t_0})}\right)^{B_{i\ell;t'}/d_\ell}
    \left(\frac{F_{\ell,\bfr;t'}(\hat y_{1;t_0} s_{1;t_0}^{-d_1},\ldots,\hat y_{n;t_0} s_{n;t_0}^{-d_n})}{F_{\ell,\bfr;t'}(\hat y_{1;t_0},\ldots,\hat y_{n;t_0})}\right)^{-B_{ik;t}/d_k}.
  \end{align*}
  But $B_{ik;t'}=-B_{ik;t}$ so that this final expression gives the desired $F$-polynomial part of $\big(\mu_{\cA,\bfr}^{t',t_0}\big)^*(s_{i;t'})$.
\end{proof}

Follow \cite{gekhtman-nakanishi-rupel} Proposition 5.5 and Corollary 5.6 for periodicity.



\newpage

\begin{equation} 
	\label{eq:GpdCD}
    \xymatrix{
      \cG_{\cA} \ar@{.>}[d]^{\rho} \ar[r]_{\varphi_{\cA}} \ar@/^1pc/[rr]|-{\mu_{\cA}} & \cG_{\cA} \ar@{.>}[d]^{\rho} \ar[r]_{\tau_{\cA}} & \cG'_{\cA} \ar@{.>}[d]^{\rho} 
	&& \cD_{\cA} \ar@{.>}[d]^{\rho} \ar[r]_{\varphi_{\cA}} \ar@/^1pc/[rr]|-{\mu_{\cA}} & \cD_{\cA} \ar@{.>}[d]^{\rho} \ar[r]_{\tau_{\cA}} & \cD'_{\cA} \ar@{.>}[d]^{\rho} \\
      \cG_{\cX} \ar[r]^{\varphi_{\cX}} \ar@/_1pc/[rr]|-{\mu_{\cX}} & \cG_{\cX} \ar[r]^{\tau_{\cX}} \ar@{}[ddr]^(.325){}="a"^(.775){}="b" \ar@<1ex> "a";"b"^-{\kappa_\cA} \ar@<-1ex> "a";"b"_-{\kappa_\cX} & \cG'_{\cX} \ar@{}[rr]^(.3){}="e"^(.7){}="f" \ar@<5ex> "e";"f"^-{\lambda_\cA} \ar@<3ex> "e";"f"_-{\lambda_\cX}
	&& \cD_{\cX} \ar[r]^{\varphi_{\cX}} \ar@/_1pc/[rr]|-{\mu_{\cX}} & \cD_{\cX} \ar[r]^{\tau_{\cX}} & \cD'_{\cX} \\
	&&&&&&\\
	&&\cB_{\cA} \ar@{.>}[d]^{\rho} \ar[r]_{\varphi_{\cA}} \ar@/^1pc/[rr]|-{\mu_{\cA}} & \cB_{\cA} \ar@{.>}[d]^{\rho} \ar[r]_{\tau_{\cA}} & \cB'_{\cA} \ar@{.>}[d]^{\rho} \ar@{}[uur]^(.2){}="c"^(.65){}="d" \ar@<1ex> "c";"d"^-{\nu_\cA} \ar@<-1ex> "c";"d"_-{\nu_\cX}  \\
      &&\cB_{\cX} \ar[r]^{\varphi_{\cX}} \ar@/_1pc/[rr]|-{\mu_{\cX}} & \cB_{\cX} \ar[r]^{\tau_{\cX}} & \cB'_{\cX}
    }
\end{equation}

\vspace{2in}

\begin{equation} 
	\xymatrix{
		& \cD_\cA \ar[dd]|-(.65){\bar{\rho}} \ar[rr]|-{\bar{\varphi}_\cA} \ar@/^1.2pc/[rrrr]|-{\bar{\mu}_\cA} && \cD_\cA \ar[dd]|-(.65){\bar{\rho}} \ar[rr]|-{\bar{\tau}_\cA} && \cD'_\cA \ar[dd]|-{\bar{\rho}} \\
	\cG_\cA \ar[dd]|-{\tilde{\rho}} \ar[rr]|-(.65){\tilde{\varphi}_\cA} \ar[ur]|-{\kappa_\cA} \ar@/^1.2pc/[rrrr]|-{\tilde{\mu}_\cA} && \cG_\cA \ar[dd]|-(.3){\tilde{\rho}} \ar[rr]|-(.65){\tilde{\tau}_\cA} \ar[ur]|-{\kappa_\cA} && \cG'_\cA \ar[dd]|-(.3){\tilde{\rho}} \ar[ur]|-{\kappa_\cA} \\
		& \cD_\cX \ar[rr]|-(.35){\bar{\varphi}_\cX} \ar@/_1.2pc/[rrrr]|-{\bar{\mu}_\cX} && \cD_\cX \ar[rr]|-(.35){\bar{\tau}_\cX} && \cD'_\cX \\
	\cG_\cX \ar[rr]|-{\tilde{\varphi}_\cX} \ar[ur]|-{\kappa_\cX} \ar@/_1.2pc/[rrrr]|-{\tilde{\mu}_\cX} && \cG_\cX \ar[rr]|-{\tilde{\tau}_\cX} \ar[ur]|-{\kappa_\cX} && \cG'_\cX \ar[ur]|-{\kappa_\cX}
	}
\end{equation}



\newpage 

The mutation of exchange matrices is accompanied by two notions of mutation on rational functions.
Let $\cF$ and $\cP$ be extension fields of $\QQ$ with transcendence degrees $m$ and $n$ respectively.   
A \emph{compatible seed} is a quadruple $\Sigma=(\bfx,\bfy,\tilde B,\Omega)$, where
\begin{itemize}
  \item $\bfx=(x_1,\ldots,x_m)$ is a transcendence basis of $\cF$ over $\QQ$ with entries called \emph{cluster variables};
  \item $\bfy=(y_1,\ldots,y_n)$ is a transcendence basis of $\cP$ over $\QQ$ with entries called \emph{coefficient variables};
  \item $\tilde B$ is an $m\times n$ exchange matrix;
  \item $\Omega$ is an $m\times m$ matrix compatible with $\tilde B$.
\end{itemize}
For $1\le k\le n$ and a sign $\varepsilon\in\{\pm1\}$, define the \emph{mutation of $\Sigma$ in direction $k$} by $\mu_{k,\varepsilon}\Sigma=(\mu_{k,\varepsilon}\bfx,\mu_{k,\varepsilon}\bfy,\mu_k\tilde B,\mu_k\Omega)$, where 
\begin{itemize}
  \item $\mu_{k,\varepsilon}\bfx=(x'_1,\ldots,x'_m)$ is given by the exchange relation
    \begin{equation}
      \label{eq:x exchange relation}
      x'_i=\begin{cases} x_i & \text{if $i\ne k$;}\\ x_k^{-1}\prod\limits_{i=1}^m x_i^{[-\varepsilon B_{ik}]_+}\left(1+\prod\limits_{i=1}^m x_i^{\varepsilon B_{ik}}\right) & \text{if $i=k$;}\end{cases}
    \end{equation}
  \item $\mu_{k,\varepsilon}\bfy=(y'_1,\ldots,y'_n)$ is given by the exchange relation 
    \begin{equation}
      \label{eq:y exchange relation}
      y'_j=\begin{cases} y_j^{-1} & \text{if $j=k$;}\\ y_jy_k^{[\varepsilon B_{kj}]_+}(1+y_k^\varepsilon)^{-B_{kj}} & \text{if $j\ne k$.}\end{cases}
    \end{equation}
\end{itemize}
Observe that seed mutation is again involutive and that there is a map $\pi:\cP\to\cF$ given by 
\begin{equation}
  \label{eq:A to X}
  \pi(y_k)=\hat y_k:=\prod\limits_{i=1}^m x_i^{B_{ik}}
\end{equation}
which is compatible with mutations.

Given an initial seed $\Sigma_{t_0}=(\bfx_{t_0},\bfy_{t_0},\tilde B_{t_0},\Omega_{t_0})$, we label seeds $\Sigma_t=(\bfx_t,\bfy_t,\tilde B_t,\Omega_t)$ which are mutation equivalent to $\Sigma_{t_0}$ by vertices of $\TT_n$ as above, here we write $\bfx_t=(x_{1;t},\ldots,x_{m;t})$ and $\bfy_t=(y_{1;t},\ldots,y_{m;t})$.
The resulting collection $\{\Sigma_t\}_{t\in\TT_n}$ is known as the \emph{exchange pattern} generated by $\Sigma_{t_0}$.
\begin{definition}
  Let $\Sigma$ be a seed in $\cF$.
  The \emph{cluster algebra} $\cA(\Sigma)$ is the $\ZZ$-subalgebra of $\cF$ generated by all cluster variables $x_{i;t}$ from seeds $\Sigma_t$ mutation equivalent to $\Sigma_{t_0}$.
\end{definition}
By iterating the exchange relations we appear to get elements of $\QQ(x_1,\ldots,x_m)\subset\cF$, that is rational functions in $x_1,\ldots,x_m$.  
The following result of Fomin and Zelevinsky known as ``the Laurent phenomenon'' shows that the cluster variables always take on a much simpler form.
\begin{theorem}
  \cite{FZ02}
  Let $\Sigma$ be a seed in $\cF$ and $\Sigma_t$ any seed in the exchange pattern generated by $\Sigma$.
  Each cluster variable $x_{i;t}$ of $\Sigma_t$ is an element of the subring $\ZZ[x_1^{\pm1},\ldots,x_m^{\pm1}]\subset\cF$.
\end{theorem}

In fact, the situtation is even better:\footnote{do we need this?} the initial cluster Laurent expansions of all cluster variables have positive integer coefficients.
\begin{theorem}
  \cite{lee-schiffler,GHKK14}
  Let $\Sigma$ be a seed in $\cF$ and $\Sigma'\sim\Sigma$.  Each cluster variable $x'_i$ of $\Sigma'$ is an element of the subsemiring $\ZZ_{\ge0}[x_1^{\pm1},\ldots,x_m^{\pm1}]\subset\cF$. 
\end{theorem}
For $x'_i$ a cluster variable from a seed $\Sigma'\sim\Sigma$, we write $x'_i(\bfx)$ when we wish to emphasize that $x'_i$ should be thought of as a function of the cluster variables in $\bfx=(x_1,\ldots,x_m)$.

\subsection{The Cluster Manifold and Compatible Poisson Structures}
Fix the field $\FF=\RR$ or $\FF=\CC$.
For an $m\times n$ exchange matrix $\tilde B$, define the \emph{cluster chart} $\Spec(\FF[x_1^{\pm1},\ldots,x_m^{\pm1}])$.
Observe that $\Sigma=(\bfx,\tilde B)$ is a seed in the field of rational functions on this cluster chart and thus we denote it by $L_\Sigma$.
Then the exchange relation \eqref{eq:exchange relations} provides a birational transformation between the cluster charts $\varphi_{\Sigma,\mu_k\Sigma}:L_\Sigma\to L_{\mu_k\Sigma}$ for $1\le k\le n$.
By composing these \emph{elementary transition maps} for neighboring seeds we get a birational transformation between $\varphi_{\Sigma,\Sigma'}:L_\Sigma\to L_{\Sigma'}$ for any seeds $\Sigma\sim\Sigma'$.

Given any seed $\Sigma$, the transition maps above define the \emph{cluster manifold} $M=M(\Sigma)=\bigcup\limits_{\Sigma'\sim\Sigma}L_{\Sigma'}$.
By construction we have $\cA(\Sigma)\subset C^\infty(M)$ and any Poisson structure on $\cA(\Sigma)$ naturally extends to give a Poisson structure on $C^\infty(M)$.

\begin{definition}
  A Poisson structure $\{\cdot,\cdot\}:\cA(\Sigma)\times\cA(\Sigma)\to\cA(\Sigma)$ is \emph{compatible} with the cluster algebra structure if, for each seed $\Sigma'\sim\Sigma$, the cluster variables in $\bfx'$ are \emph{log-canonical} with respect to $\{\cdot,\cdot\}$.
  That is, there exists a skew-symmetric integer \emph{coefficient matrix} $\Omega'=(\Omega'_{ij})$ so that 
  \begin{equation}
    \label{eq:log-canonical bracket}
    \{x'_i,x'_j\}=\Omega'_{ij}x'_ix'_j
  \end{equation}
  for $1\le i,j\le m$.
\end{definition}
\begin{remark}
  Suppose the cluster variables of a seed $\Sigma=(\bfx,\tilde B)$ are log-canonical with respect to a Poisson bracket $\{\cdot,\cdot\}:\cA(\Sigma)\times\cA(\Sigma)\to\cA(\Sigma)$ with coefficient matrix $\Omega$.
  Then the compatibility of $\{\cdot,\cdot\}$, together with the exchange relations, imposes the compatibility condition $\tilde B^T\Omega=[D\ 0]$ (see \cite{berenstein-zelevinsky,gekhtman-shapiro-vainshtein} for details).
\end{remark}

\begin{theorem}
  \cite{gekhtman-shapiro-vainshtein}
  Suppose the $m\times n$ exchange matrix $\tilde B$ of a seed $\Sigma$ has full rank.  Then there exists a Poisson structure $\Omega$ compatible with the cluster structure on $\cA(\Sigma)$.
\end{theorem}





%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Cluster Symplectic Groupoids}
Let $\Sigma=(\bfx,\tilde B,\Theta)$ be a graded seed and assume there exists a compatible Poisson structure on $L_\Sigma$ with coefficient matrix $\Omega=(\Omega_{ij})$.  
%Write $\pi$ for the corresponding Poisson bivector on the cluster manifold $M$, i.e.\ in local coordinates on $L_\Sigma$ we have $\pi=\sum\limits_{i>j}\Omega_{ij}x_ix_j\frac{\partial}{\partial x_i}\wedge\frac{\partial}{\partial x_j}$.
In this section, we give an integration to a symplectic groupoid $G(\Sigma)$ of the Poisson structure on a cluster manifold $M(\Sigma)$.  

We build the cluster symplectic groupoid $G(\Sigma)\rightrightarrows M(\Sigma)$ by gluing together local groupoid charts $G_{\Sigma'}\rightrightarrows L_{\Sigma'}$, $\Sigma'\sim\Sigma$, along transition maps which lift the cluster mutations used to glue cluster charts of $M(\Sigma)$.
This process is carried out in three steps:
\begin{itemize}
  \item first, we show that the action groupoids $(\FF^*)^m\times L_{\Sigma'}\rightrightarrows L_{\Sigma'}$ over each cluster chart admit a gluing which lifts the cluster mutation;
  \item second, we define maps $T^*L_{\Sigma'}\to(\FF^*)^m\times L_{\Sigma'}$ along which we pullback the groupoid structure to obtain symplectic groupoids integrating a compatible Poisson structure on $L_{\Sigma'}$;
  \item finally, we define transition maps between the symplectic groupoids $G_{\Sigma'}=T^*L_{\Sigma'}$ which lift the cluster mutations.
\end{itemize}

There is a natural action groupoid structure $(\FF^*)^m\times L_\Sigma\rightrightarrows L_\Sigma$ with source map $\alpha$ being the natural projection and target map given by the Hadamard product
\[\beta(\bfs,\bfx)=\bfs\circ\bfx,\quad \bf\circ\bfx=(s_1x_1,\ldots,s_mx_m),\]
i.e.\ given by the natural action of $(\FF^*)^m$ on $L_\Sigma$.

\erase{
Given any seed $\Sigma'\sim\Sigma$, define a map $\mu_{\Sigma',\Sigma}:(\FF^*)^r\times L_\Sigma\to(\FF^*)^r\times L_\Sigma'$ by $\mu_{\Sigma',\Sigma}(\bfs,\bfx)=(\bfs',\bfx')$, where $\bfx'(\bfx)=\big(x'_1(\bfx),\ldots,x'_m(\bfx)\big)$ and $\bfs'(\bfs,\bfx)=(s'_1(\bfs,\bfx),\ldots,s'_m(\bfs,\bfx))$ is given by $s'_i(\bfs,\bfx)=\frac{x'_i(\bfs\circ\bfx)}{x'_i(\bfx)}$.
\begin{theorem}
  For any three seeds $\Sigma\sim\Sigma'\sim\Sigma''$, we have $\mu_{\Sigma'',\Sigma'}\mu_{\Sigma',\Sigma}=\mu_{\Sigma'',\Sigma}$ and hence the local groupoid charts glue to give a groupoid over the cluster manifold $M(\Sigma)$.
\end{theorem}
\begin{proof}
  By induction, it suffices to prove the claim when $\Sigma''=\mu_k\Sigma'$ for some $k$.
  In this case, we have $x''_i(\bfx)=x'_i(\bfx)$ and thus $s''_i(\bfs,\bfx)=s'_i(\bfs,\bfx)$ for $i\ne k$.
  Observe that the definition of $\mu_{\Sigma',\Sigma}$ gives $\bfs'(\bfs,\bfx)\circ\bfx'(\bfx)=\bfx'(\bfs\circ\bfx)$ and the definition of $\mu_k$ gives $\bfx''(\bfx'(\bfx))=\bfx''(\bfx)$.
  It then immediately follows from the definition of $\mu_{\Sigma'',\Sigma'}\mu_{\Sigma',\Sigma}$ that we have
  \[s''_k(\bfs'(\bfs,\bfx),\bfx'(\bfx))=\frac{x''_k(\bfs'(\bfs,\bfx)\circ\bfx'(\bfx))}{x''_k(\bfx'(\bfx))}=\frac{x''_k(\bfx'(\bfs\circ\bfx))}{x''_k(\bfx'(\bfx))}=\frac{x''_k(\bfs\circ\bfx)}{x''_k(\bfx)}=s''_k(\bfs,\bfx).\]
\end{proof}}%end erase

Let $G_\Sigma=T^*L_\Sigma$ denote the cotangent bundle of $L_\Sigma$.
Write $\bfp=(p_1,\ldots,p_m)$ for the cotangent coordinates of $G_\Sigma$.
Define a map $\rho_\Sigma:G_\Sigma\to(\FF^*)^m\times L_\Sigma$ by $\rho_\Sigma(\bfx,\bfp)=(\bfs(\bfx,\bfp),\bfx)$, with $s_i(\bfx,\bfp)=e^{\sum_j\Omega_{ij}x_jp_j}$.

%Define the map $\beta:G_\Sigma\to L_\Sigma$ by 
%\begin{equation}
%  \label{eq:cluster groupoid target map}
%  \beta(\bfx,\bfp)=(s_1x_1,\ldots,s_nx_n),\quad\text{where}\quad s_i:=e^{\sum_j\Omega_{ij}x_jp_j}.
%\end{equation}
\begin{theorem}
  \label{th:cluster groupoid}
  The groupoid structure on $(\FF^*)^m\times L_\Sigma$ pulls back to a groupoid structure on the manifold $G_\Sigma$ with source map the natural projection, target map $\beta\circ\rho_\Sigma$, multiplication given by
  \[(\bfx,\bfp)\cdot\big((\beta\circ\rho_\Sigma)(\bfx,\bfp),\bfp'\big)=(\bfx,\bfp''),\quad p''_i=s_i(\bfx,\bfp)p'_i+p_i,\]
  inversion given by
  \[(\bfx,\bfp)^{-1}=\big(\beta(\bfx,\bfp),\bfp'),\quad p'_i=-s_i(\bfx,\bfp)^{-1}p_i,\]
  and identity map given by $1_\bfx=(\bfx,\boldsymbol{0})$.
  %Moreover, the 2-form $\omega=\alpha^*(\pi^{-1})-\beta^*(\pi^{-1})$ defines a symplectic structure on $G_\Sigma$.
\end{theorem}
%\begin{proof}
%  It is clear that $1_\bfx$ gives the identity map for this multiplication and that the inversion map satisfies 
%  \[(\bfx,\bfp)\cdot(\bfx,\bfp)^{-1}=1_\bfx=(\bfx,\bfp)^{-1}\cdot(\bfx,\bfp)\]
%  for all $(\bfx,\bfp)\in G_\Sigma$.
%
%  It remains to check associativity of the multiplication.
%  Fix an element $(\bfx,\bfp)\in G_\Sigma$.
%  Consider $(\bfx',\bfp'),(\bfx'',\bfp'')\in G_\Sigma$ with $\bfx'=\beta(\bfx,\bfp)$ and $\bfx''=\beta(\bfx',\bfp')$.
%  Then we have
%  \[\big((\bfx,\bfp)\cdot(\bfx',\bfp')\big)\cdot(\bfx'',\bfp'')=(\bfx,\bfp'''),\quad p'''_i=e^{\sum_j\Omega_{ij}x_j(s_jp'_j+p_j)}p''_i+e^{\sum_j\Omega_{ij}x_jp_j}p'_i+p_i.\]
%  On the other hand we have
%  \[(\bfx,\bfp)\cdot\big((\bfx',\bfp')\cdot(\bfx'',\bfp'')\big)=(\bfx,\bfp'''),\quad p'''_i=e^{\sum_j\Omega_{ij}x_jp_j}(e^{\sum_j\Omega_{ij}x'_jp'_j}p''_i+p'_i)+p_i\]
%  and thus associativity holds.
%\end{proof}

Write $\mu_k\Sigma=(\bfx',\tilde B')$.  
%Let $\bfp'=(p'_1,\ldots,p'_n)$ denote the cotangent coordinates of $G_{\mu_k\Sigma}$.
Define a map from $G_\Sigma$ to $G_{\mu_k\Sigma}$, which we also denote $\mu_{\Sigma,\mu_k\Sigma}$, as follows:
\begin{equation}
  \label{eq:groupoid gluing map}
  \mu_{\Sigma,\mu_k\Sigma}(\bfx,\bfp)=(\bfx'(\bfx),\bfp'(\bfx,\bfp)),\quad \bfp'(\bfx,\bfp)=(p'_1(\bfx,\bfp),\ldots,p'_m(\bfx,\bfp)),\quad p'_\ell(\bfx,\bfp)=\frac{x_\ell p_\ell +[\varepsilon_k b_{\ell k}]_+ x_k p_k +\frac{b_{\ell k}}{d_k}\ln\left(\frac{Q_k(\bfs\circ\bfx)}{Q_k(\bfx)}\right)}{x'_\ell(\bfx)},
\end{equation}
where $\varepsilon_k$ denotes the tropical sign for the seed $\Sigma$.

\begin{lemma}
  Let $\bfx',\bfp',\Omega'$ be obtained from $\bfx,\bfp,\Omega$ by mutation in direction $k$.
  For any index $1\le i\le m$ with $i\ne k$, we have $\sum\limits_{j=1}^m \Omega'_{ij} x'_j p'_j = \sum\limits_{j=1}^m \Omega_{ij} x_j p_j$ and $\sum\limits_{j=1}^m \Omega'_{kj} x'_j p'_j=\ln\left(\frac{x'_k(\bfs\circ\bfx)}{x'_k(\bfx)}\right)$.
\end{lemma}
\begin{proof}
  The mutation operation for groupoid charts is more naturally written in vector form as
  \[\bfx'\circ\bfp'=E_{k,\varepsilon_k}(\bfx\circ\bfp)+\frac{1}{d_k}\ln\left(\frac{Q_k(\bfs\circ\bfx)}{Q_k(\bfx)}\right)\bfb_k.\]
  This gives rise to the identity
  \begin{align}
    \Omega'(\bfx'\circ\bfp')
    \nonumber &=\Omega' E_{k,\varepsilon_k}(\bfx\circ\bfp)+\frac{1}{d_k}\ln\left(\frac{Q_k(\bfs\circ\bfx)}{Q_k(\bfx)}\right)\Omega'\bfb_k\\
    \label{eq:groupoid transition} &=E_{k,\varepsilon_k}^T\Omega (\bfx\circ\bfp)+\ln\left(\frac{Q_k(\bfs\circ\bfx)}{Q_k(\bfx)}\right)\bfe_k.
  \end{align}
  By the structure of $E_{k,\varepsilon_k}$, the euqality $\sum\limits_{j=1}^m \Omega'_{ij} x'_j p'_j = \sum\limits_{j=1}^m \Omega_{ij} x_j p_j$ for $i\ne k$ immediately follows.

  Equation~\ref{eq:groupoid transition} also gives the identity
  \begin{align*}
    \sum\limits_{j=1}^m \Omega'_{kj} x'_j p'_j
    &=-\sum\limits_{j=1}^m \Omega_{kj} x_j p_j+\ln\left(\bfs^{\bfb_k^+}\right)+\ln\left(\frac{Q_k(\bfs\circ\bfx)}{Q_k(\bfx)}\right)\\
    &=-\sum\limits_{j=1}^m \Omega_{kj} x_j p_j+\ln\left(\frac{x'_k(\bfs\circ\bfx)x_k(\bfs\circ\bfx)}{x'_k(\bfx)x_k(\bfx)}\right)\\
    \ln\left(\frac{x'_k(\bfs\circ\bfx)}{x'_k(\bfx)}\right).
  \end{align*}
\end{proof}

\begin{lemma}
  The mutation of cluster groupoid charts is involutive.
\end{lemma}
\begin{proof}
  
\end{proof}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Totally Positive Cluster Manifolds}
In this section we show that the totally non-negative part $M_{\ge0}(\Sigma)$ of a cluster manifold is a manifold with corners in the sense of \cite{MR3077259}.  
Moreover, we show that the non-negative cluster manifold is a union of symplectic leaves for any compatible Poisson structure on $\cA(\Sigma)$.  
The symplectic leaves of $M_{\ge0}(\Sigma)$ are naturally labelled by compatible subsets of cluster variables, where the number of cluster variables in the labeling set determines the corank of the symplectic leaf.
Here there is a unique dense symplectic leaf and the boundary of $M_{\ge0}(\Sigma)$ is again a union of symplectic leaves of lower dimension where the Poisson structure degenerates.

\begin{theorem}
  Let $\Sigma$ be a seed.  
  The 1-skeleton of $M_{\ge0}(\Sigma)$ given by 0-dimensional and 1-dimensional symplectic leaves identifies with the exchange graph of $\cA(\Sigma)$.  
  Moreover, if $\Sigma$ is a seed of finite-type, then $M_{\ge0}(\Sigma)$ provides a realization of the generalized associahedron with the same Cartan type as $\Sigma$.
\end{theorem}
\begin{proof}
  The 0-dimensional symplectic leaves correspond to the vanishing of all cluster variables from a seed mutation equivalent to $\Sigma$.  
  Then a 1-dimensional symplectic leaf whose boundaries correspond to seeds $\Sigma'$ and $\Sigma''$ exactly corresponds to the non-vanishing of exchangable cluster variables $x'_k$ and $x''_k$.
  But this is exactly the exchange graph of $\cA(\Sigma)$.

  When $\Sigma$ is of finite-type, the realization of $M_{\ge0}(\Sigma)$ as a simplicial complex, given by taking symplectic leaves as cells, is naturally dual to the cluster complex of $\cA(\Sigma)$, i.e.\ $M_{\ge0}(\Sigma)$ identifies with the associated generalized associahedron.
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Symplectic Topology of the Nonnegative Cluster Groupoid}


%%%%%%%%%%%%%%


\bibliographystyle{hyperamsplain}
\bibliography{cluster_symplectic}


\end{document}
